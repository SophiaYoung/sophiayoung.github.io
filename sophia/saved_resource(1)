/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-logger",function(d){var b=[],a=null;
var c=d.Base.create("logger",d.Base,[],{initializer:function(e){d.one(window).on("beforeunload",this.flush,this)
},enqueue:function(e){b.push(e);
this.wait()
},flush:function(f){try{clearTimeout(a)
}catch(e){}a=null;
if(b.length>0){d.Data.post({url:"/api/events/Trace",data:{data:JSON.stringify(b)},failure:function(){}})
}b=[]
},wait:function(){if(a===null){a=setTimeout(d.bind(this.flush,this),this.get("timerLength"))
}},log:function(e,f){if(d.Lang.isValue(e)){this.enqueue({sessionKey:this.get("sessionKey"),pageUrl:document.location.href,type:e,data:JSON.stringify(d.Lang.isValue(f)?f:{})})
}},debug:function(g){var f=d.one("#logger-debug")||d.one("body").appendChild(d.Node.create('<div id="logger-debug"></div>'));
f.setStyles({position:"fixed",right:50,top:50,background:"rgba(150,100,100,0.9)",border:"solid 1px white",color:"white",borderRadius:"3px",padding:20,zIndex:10000000});
function e(h){return d.Array.map(h,function(i){if(i.items&&i.items.length){return e(i.items)
}else{return i.title
}})
}f.setContent('<xmp style="margin:0">'+JSON.stringify(g,null,2)+"</xmp>")
}},{ATTRS:{timerLength:{value:30*1000},sessionKey:{value:d.Cookie.get("JSESSIONID")}}});
d.namespace("Squarespace").Logger=new c()
},"1.0",{requires:["node","io-base","cookie","event","base"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-commerce-utils",function(a){a.Squarespace.Commerce={currencyCode:function(){return(a.Object.getValue(Static,["SQUARESPACE_CONTEXT","websiteSettings","storeSettings","currenciesSupported"])||["USD"])[0]
},currencySymbol:function(){return a.Squarespace.CurrencySymbol[this.currencyCode()]
},showCurrencyCode:function(){return this.currencyCode()!=="USD"&&this.currencySymbol()==="$"
},isExpressCheckout:function(){return Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.expressCheckout
},goToCheckoutPage:function(){window.location="https://secure."+Static.SQUARESPACE_CONTEXT.appDomain+"/checkout?cartId="+a.Cookie.get("CART")
},moneyFormat:function(b){return Number((b/100).toFixed(2)).formatMoney(2)
},variantFormat:function(d){var c=[];
for(var b in d){if(a.Squarespace.Variants.SystemAttributes.indexOf(b)==-1&&(typeof d[b]!="object")){c.push(d[b])
}}return c.join(" / ")
},variantFormatAttributes:function(d){var c=[];
for(var b in d){if(a.Squarespace.Variants.SystemAttributes.indexOf(b)==-1&&(typeof d[b]!="object")){c.push(b)
}}return c.join(" / ")
},moneyString:function(b){return'<span class="sqs-money-native">'+a.Squarespace.Commerce.moneyFormat(b)+"</span>"
},priceString:function(c){var b=this.normalPrice(c);
switch(c.productType){case a.Squarespace.ProductTypes.PHYSICAL:if(this.onSale(c)){if(this.variedPrices(c)){return"from "+this.moneyString(this.fromPrice(c))
}else{return this.moneyString(this.salePrice(c))+' <span class="strikeout">'+this.moneyString(b)+"</span>"
}}else{if(this.variedPrices(c)){return"from "+this.moneyString(this.fromPrice(c))
}}return this.moneyString(b);
case a.Squarespace.ProductTypes.DIGITAL:if(c.payWhatYouWant){return this.moneyString(c.minimumPriceCents)+" or more"
}else{if(this.onSale(c)){return this.moneyString(this.salePrice(c))+' <span class="strikeout">'+this.moneyString(b)+"</span>"
}}return this.moneyString(b)
}},variantsSelectString:function(t){var r=t.variants;
var v=t.variantOptionOrdering;
if(a.Lang.isUndefined(r)||r.length<=1){return""
}var c=[];
for(var q=0;
q<v.length;
q++){var l=v[q];
c.push({name:l,values:[]})
}for(var q=0;
q<r.length;
q++){var d=r[q];
for(var w in d){if(!a.Squarespace.Utils.isSystemVariantOption(w)){var m=d[w];
var f;
for(var o=0;
o<c.length;
o++){var h=c[o];
if(h.name==w){f=h
}}var s=f.values;
var e=false;
for(var n=0;
n<s.length;
n++){var g=s[n];
if(g==m){e=true
}}if(!e){s.push(m)
}}}}var u="";
for(var q=0;
q<c.length;
q++){var w=c[q].name;
var b=c[q].values;
var p='<div class="variant-option"><div class="variant-option-title">'+w+': </div><select data-variant-option-name="'+w+'"><option value="none" >Select '+w+"</option>";
for(var o=0;
o<b.length;
o++){var m=b[o];
p+='<option value="'+a.Squarespace.Escaping.escapeForHtmlTag(m)+'">'+m+"</option>"
}p+="</select></div>";
u+=p
}return'<div class="product-variants" data-item-id="'+t.id+'" data-variants="'+a.Squarespace.Escaping.escapeForHtmlTag(JSON.stringify(r))+'">'+u+"</div>"
},quantityInputString:function(c){if(c.productType!==a.Squarespace.ProductTypes.PHYSICAL){return""
}if(a.Squarespace.Commerce.getTotalStockRemaining(c)===1){return""
}var b='<div class="quantity-label">Quantity:</div>';
return'<div class="product-quantity-input" data-item-id="'+c.id+'" >'+b+'<input size="4" maxlength="4" value="1"></input></div>'
},getTotalStockRemaining:function(e){if(e.productType===a.Squarespace.ProductTypes.DIGITAL){return Infinity
}else{if(e.productType===a.Squarespace.ProductTypes.PHYSICAL){var d=0;
for(var c=0;
c<e.variants.length;
c++){var b=e.variants[c];
if(b.unlimited){return Infinity
}else{d+=b.qtyInStock
}}return d
}else{throw"Product type not supported: "+e.productType
}}},payWhatYouWantInputString:function(d){if(!d.payWhatYouWant){return""
}var b=this.currencySymbol();
var c=a.Squarespace.Commerce.moneyFormat(d.minimumPriceCents);
return"<span>"+b+'</span><input data-item-id="'+d.id+'data-name="payWhatYouWantPrice" value="'+c+'"/><div class="minimum-price">('+b+c+" or more)</div>"
},addToCartBtnString:function(b){return'<div class="sqs-add-to-cart-button-wrapper"><div class="sqs-add-to-cart-button sqs-suppress-edit-mode" data-item-id="'+b.id+'">Add to Cart</div></div>'
},hasVariants:function(b){return(b.productType==a.Squarespace.ProductTypes.DIGITAL)?false:(b.variants.length>1)
},variedPrices:function(f){switch(f.productType){case a.Squarespace.ProductTypes.PHYSICAL:var b=f.variants;
if(b.length<=1){return false
}var e=b[0];
for(var d=1;
d<b.length;
d++){var c=b[d];
if((c.onSale!=e.onSale)||(e.onSale&&(c.salePrice!=e.salePrice))||(c.price!=e.price)){return true
}}return false;
case a.Squarespace.ProductTypes.DIGITAL:return false
}},onSale:function(f){switch(f.productType){case a.Squarespace.ProductTypes.PHYSICAL:var b=f.variants;
var e=false;
for(var d=0;
d<b.length;
d++){var c=b[d];
if(c.onSale){e=true;
break
}}return e;
case a.Squarespace.ProductTypes.DIGITAL:return f.payWhatYouWant?false:f.onSale
}},soldOut:function(f){switch(f.productType){case a.Squarespace.ProductTypes.PHYSICAL:var b=f.variants;
var c=true;
for(var e=0;
e<b.length;
e++){var d=b[e];
if(d.unlimited||d.qtyInStock>0){c=false;
break
}}return c;
case a.Squarespace.ProductTypes.DIGITAL:return false
}},normalPrice:function(f){switch(f.productType){case a.Squarespace.ProductTypes.PHYSICAL:var d=f.variants;
if(d.length===0){return 0
}var b=d[0].price;
for(var e=1;
e<d.length;
e++){var c=d[e].price;
if(c>b){b=c
}}return b;
case a.Squarespace.ProductTypes.DIGITAL:return a.Lang.isUndefined(f.priceCents)?0:f.priceCents
}},salePrice:function(g){switch(g.productType){case a.Squarespace.ProductTypes.PHYSICAL:var b=g.variants;
if(b.length===0){return 0
}var d=null;
for(var f=0;
f<b.length;
f++){var e=b[f];
var c=e.salePrice;
if(e.onSale&&(d===null||(e.salePrice<d))){d=c
}}return d;
case a.Squarespace.ProductTypes.DIGITAL:return a.Lang.isUndefined(g.salePriceCents)?0:g.salePriceCents
}},fromPrice:function(g){switch(g.productType){case a.Squarespace.ProductTypes.PHYSICAL:var c=g.variants;
if(c.length===0){return 0
}var f=c[0];
var h=f.onSale?f.salePrice:f.price;
for(var e=1;
e<c.length;
e++){var d=c[e];
var b=d.onSale?d.salePrice:d.price;
if(b<h){h=b
}}return h;
case a.Squarespace.ProductTypes.DIGITAL:return a.Lang.isUndefined(g.priceCents)?0:g.priceCents
}},couponDescriptor:function(d){var f;
var c;
var e=this._clone(d,{});
e=this.normalizeAndCleanCouponData(e);
var b={minPrice:this.moneyString(e.minPrice),productTitle:e.productTitle||"?",discountAmt:e.discountAmt||"?"};
switch(e.type){case a.Squarespace.CommerceCouponTypes.ALL_ORDERS:f=function(g){return"Save "+g.discountAmt+" on any order."
};
c=function(){return"Free shipping on any order."
};
break;
case a.Squarespace.CommerceCouponTypes.ORDERS_OVER:f=function(g){return"Save "+g.discountAmt+" on any order over "+g.minPrice+"."
};
c=function(g){return"Free shipping on any order over "+g.minPrice+"."
};
break;
case a.Squarespace.CommerceCouponTypes.CATEGORIES:f=function(g){return"Save "+g.discountAmt+" on select products."
};
break;
case a.Squarespace.CommerceCouponTypes.SINGLE_PRODUCT:f=function(g){return"Save "+g.discountAmt+" on  "+g.productTitle+" ."
};
break;
default:throw"Unsupported coupon type"
}switch(e.discountType){case a.Squarespace.CommerceDiscountTypes.FLAT:b.discountAmt=this.moneyString(e.discountAmt);
break;
case a.Squarespace.CommerceDiscountTypes.PERCENTAGE:b.discountAmt=b.discountAmt+"%";
break;
case a.Squarespace.CommerceDiscountTypes.FREE_SHIPPING:return c(b)
}return f(b)
},normalizeAndCleanCouponData:function(b){if(b.discountType===a.Squarespace.CommerceDiscountTypes.FLAT){b.flatDiscount=b.discountAmt
}else{if(b.discountType===a.Squarespace.CommerceDiscountTypes.PERCENTAGE){b.percentDiscount=b.discountAmt
}}return b
},generateSKU:function(){var e="",d="0123456789",c={};
var b=function(){var h="";
for(var g=0;
g<7;
++g){var f=Math.floor(Math.random()*d.length);
h+=d.charAt(f)
}return"SQ"+h
};
e=b();
return e
},_clone:function(c,d){var b,e;
for(b in c){if(c.hasOwnProperty(b)){e=c[b];
if(e&&typeof e==="object"&&!e.node){switch(Object.prototype.toString.call(e)){case"[object Object]":d[b]=this._clone(e,(typeof d[b]!=="undefined"&&Object.prototype.toString.call(d[b])==="[object Object]")?d[b]:{});
break;
case"[object Array]":d[b]=this._clone(e,(typeof d[b]!=="undefined"&&Object.prototype.toString.call(d[b])==="[object Array]")?d[b]:[]);
break;
default:d[b]=e;
break
}}else{d[b]=e
}}}return d
}}
},"1.0",{requires:["node","cookie","squarespace-enum"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-base-get-property",function(b){var a=function(){};
a.prototype={getProperty:function(c){var d=this.constructor,e=this.constructor[c];
while(b.Lang.isUndefined(e)){if(d.superclass){d=d.superclass.constructor
}else{break
}if(b.Lang.isUndefined(d)){break
}e=d[c]
}return e
}};
a.NAME="baseGetProperty";
b.namespace("Squarespace").BaseGetProperty=a
},"1.0");/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-anims",function(b){function a(c){a.superclass.constructor.apply(this,arguments)
}b.namespace("Squarespace").Anims=b.extend(a,b.Base,{initializer:function(){this._items=[]
},destructor:function(){var c=[];
this.each(function(d){c.push(d)
});
b.Array.each(c,function(d){if(d.get("running")){d.stop(false)
}d.destroy()
});
b.detach(this.get("id")+"|*")
},add:function(c){if(!c.get("node")){throw this.name+": Animation doesn't specify a node"
}if(!c.get("node").ancestor("body")){console.warn(this.name+": Animation with a YUI node not in the DOM added")
}else{if(!c.get("node")._node){console.warn(this.name+": Animation with a _node = null added")
}}c.on(this.get("id")+"|end",function(d){this.remove(c)
},this);
this._items.push(c)
},remove:function(d){if(b.Lang.isNumber(d)){return this._items.splice(d,1)
}else{var c=this._items.indexOf(d);
if(c!==-1){return this._items.splice(this._items.indexOf(d),1)
}}}},{NAME:"anims"});
b.augment(a,b.ArrayList)
},"1.0",{requires:["base","base-build","arraylist"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-zen",function(e){var d=/(?:\s*([-+ ,<>]))?\s*(\.|!|#)?([-\w$]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,b=/[\-+,> ]/,c=e.config.doc;
function a(g,h){g.appendChild(c.createTextNode(h))
}function f(k){var l;
var h;
if(typeof("ieCreateElement")=="undefined"){try{l=1;
f("i",{name:"a"})
}catch(s){l=0
}}var t,g,q,o,n,r,u=arguments;
if(k._node){k=k._node
}function j(){if(r&&n&&r!==n){var i=n;
if(n===k){t=t||(b.test(h)&&c.createDocumentFragment());
if(t){i=t
}}i.insertBefore(r,o||null)
}}for(var p=0;
p<u.length;
p++){h=u[p];
if(typeof h=="object"){if(h._node){r=h._node
}if(h.nodeType){r=h;
j();
n=h._node||h;
o=0
}else{for(var v in h){r[v]=h[v]
}}}else{if(q===p-1){a(r,h)
}else{if(p<1){k=null
}q=p;
var m=h.replace(d,function(D,i,y,B,A,x){if(i){j();
if(i=="-"||i=="+"){n=(o=(r||n)).parentNode;
if(n==null){n=t=t||c.createDocumentFragment();
t.appendChild(r);
o=r
}r=null;
if(i=="+"){o=o.nextSibling
}}else{if(i=="<"){n=(r||n).parentNode;
if(n==null){n=t=t||c.createDocumentFragment();
t.appendChild(r);
r=t
}else{r=n
}}else{if(i==","){n=k
}else{if(r){n=r
}}r=null
}o=0
}if(r){n=r
}}var E=!y&&B;
if(E||(!r&&(y||A))){if(E=="$"){a(n,u[++p])
}else{E=E||f.defaultTag;
var C=l&&u[p+1]&&u[p+1].name;
if(C){E="<"+E+' name="'+C+'">'
}r=c.createElement(E)
}}if(y){if(B=="$"){B=u[++p]
}if(y=="#"){r.id=B
}else{var w=r.className;
var z=w&&(" "+w+" ").replace(" "+B+" "," ");
if(y=="."){r.className=w?(z+B).substring(1):B
}else{if(h=="!"){e.one(r).destroy(true).remove()
}else{z=z.substring(1,z.length-1);
if(z!=w){r.className=z
}}}}}if(A){if(x=="$"){x=u[++p]
}if(A=="style"){r.style.cssText=x
}else{r[A.charAt(0)=="!"?(A=A.substring(1))&&"removeAttribute":"setAttribute"](A,x===""?A:x)
}}return""
});
if(m){throw new SyntaxError("Unexpected char "+m+" in "+h)
}j();
n=g=r||n
}}}if(k&&t){k.appendChild(t)
}return e.one(g)
}f.defaultTag="div";
f.setDocument=function(g,h){c=g;
b=h||b
};
e.zen=f;
if(e.Node){e.Node.addMethod("zen",function(){return f.apply(null,arguments)
});
e.NodeList.importMethod(e.Node.prototype,"zen")
}},"1.0",{requires:["node"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-template-helpers",function(L){var B={get:function(b,a){if(typeof(b.get)==="function"){return b.get(a)
}else{return b[a]
}}};
var N={html:L.Squarespace.Escaping.escapeForHtml,htmltag:L.Squarespace.Escaping.escapeForHtmlTag,htmlattr:L.Squarespace.Escaping.escapeForHtmlTag,str:function(b){if(b===null||typeof(b)==="undefined"){return""
}try{return b.toString()
}catch(a){return"[JSONT: Can't format variable as string (typeof: "+typeof(b)+").]"
}},raw:function(a){return a
},safe:function(a){if(!a){return""
}return a.replace(/<.*?>/g,"")
},json:function(a){return L.JSON.stringify(a).replace(/<\/script>/g,'</scr"+"ipt>')
},"json-pretty":function(a){return L.JSON.stringify(a,null,2).replace(/<\/script>/g,'</scr"+"ipt>')
},smartypants:function(a){a=a.replace(/(^|[-\u2014\s(\["])'/g,"$1\u2018");
a=a.replace(/'/g,"\u2019");
a=a.replace(/(^|[-\u2014/\[(\u2018\s])"/g,"$1\u201c");
a=a.replace(/"/g,"\u201d");
a=a.replace(/--/g,"\u2014");
return a
},slugify:function(a){return(!a?"":a.replace(/[^\-a-zA-Z0-9\s]+/ig,"").replace(/\s/g,"-").toLowerCase())
},"url-encode":function(a){return encodeURIComponent(a)
},"activate-twitter-links":function(a){var c=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
var d=/(^| )@([a-zA-Z0-9_]+)/ig;
var b=/(^| )#([a-zA-Z0-9_]+)/ig;
return a.replace(c,'<a target="new" href="$1">$1</a>').replace(d,'$1<a target="new" href="http://www.twitter.com/$2/">@$2</a>').replace(b,function(e){return'<a target="new" href="http://www.twitter.com/search/'+encodeURIComponent(e)+'">'+e+"</a>"
})
},count:function F(b){var a=b.length;
if(a==null&&typeof b==="object"){a=0;
for(C in b){if(Object.prototype.hasOwnProperty.call(b,C)){a++
}}}return a||0
},"audio-player":function(a){return'<script>Y.use(\'squarespace-audio-player-frontend\');<\/script><div class="squarespace-audio-player" data-audio-asset-url="'+a.audioAssetUrl+'" data-item-id="'+a.id+'" id="audio-player-'+a.id+'"></div>'
},"social-button":function(e,a){var b=a._LookUpStack("website");
var d=(e.systemDataId||e.mainImageId||"");
var c=(e.assetUrl||(e.mainImage?e.mainImage.assetUrl:"")||"");
if(b&&b.shareButtonOptions&&Object.keys(b.shareButtonOptions).length!==0){return'<script>Y.use(\'squarespace-social-buttons\');<\/script><div class="squarespace-social-buttons button-style" data-system-data-id="'+d+'" data-asset-url="'+c+'" data-record-type="'+e.recordType+'" data-full-url="'+e.fullUrl+'" data-title="'+L.Squarespace.Escaping.escapeForHtmlTag(e.title)+'"></div>'
}},"social-button-inline":function(e,a){var b=a._LookUpStack("website");
var d=(e.systemDataId||e.mainImageId||"");
var c=(e.assetUrl||(e.mainImage?e.mainImage.assetUrl:"")||"");
if(b&&b.shareButtonOptions&&Object.keys(b.shareButtonOptions).length!==0){return'<script>Y.use(\'squarespace-social-buttons\');<\/script><span class="squarespace-social-buttons inline-style" data-system-data-id="'+d+'" data-asset-url="'+c+'" data-record-type="'+e.recordType+'" data-full-url="'+e.fullUrl+'" data-title="'+L.Squarespace.Escaping.escapeForHtmlTag(e.title)+'"></span>'
}},"twitter-follow-button":function(b){var a=b.userName||b.profileUrl.split("/").pop();
return"<script>Y.use('squarespace-follow-buttons', function(Y) { Y.on('domready', function() { Y.Squarespace.FollowButtonUtils.renderAll(); }); });<\/script><div class=\"squarespace-follow-button\" data-username=\""+a+'"></div>'
},comments:function(a){return'<div class="squarespace-comments" id="comments-'+a.id+'"></div>'
},"comment-link":function(a,c){var b=c._LookUpStack("websiteSettings");
if(b&&b.disqusShortname){return'<script>Y.use("squarespace-comment-links");<\/script><a href="'+a.fullUrl+'" class="sqs-comment-link" data-id="'+a.id+'"></a>'
}return'<a href="'+a.fullUrl+"#comments-"+a.id+'" class="sqs-comment-link" data-id="'+a.id+'">'+(a.publicCommentCount===0?"No":a.publicCommentCount)+" Comment"+(a.publicCommentCount===1?"":"s")+"</a>"
},"like-button":function(a,c){var b=c._LookUpStack("websiteSettings");
if(b&&b.simpleLikingEnabled){return'<span class="sqs-simple-like" data-item-id="'+a.id+'" data-like-count="'+a.likeCount+'"><span class="like-icon"></span><span class="like-count"></span></span>'
}},"comment-count":function(a){return(a.publicCommentCount===0?"No":a.publicCommentCount)+" Comment"+(a.publicCommentCount===1?"":"s")
},"image-meta":function(c){if(!c){return
}var b="0.5,0.5";
if(c.mediaFocalPoint){b=c.mediaFocalPoint.x+","+c.mediaFocalPoint.y
}var a;
if(c.title&&c.title.length>0){a=c.title
}if(!a&&c.body&&c.body.length>0){a=c.body.replace(/<(?:.|\n)*?>/gm,"")
}if(!a&&c.filename&&c.filename.length>0){a=c.filename
}if(a){a=L.Squarespace.Escaping.escapeForHtmlTag(a)
}return'data-image="'+c.assetUrl+'" data-src="'+c.assetUrl+'" data-image-dimensions="'+(c.originalSize||"")+'" data-image-focal-point="'+b+'" alt="'+a+'" '
},height:function(b){var a=b.split("x");
if(a.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var d=parseInt(a[0],10);
var c=parseInt(a[1],10);
return c
},width:function(b){var a=b.split("x");
if(a.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var d=parseInt(a[0],10);
var c=parseInt(a[1],10);
return d
},moneyFormat:function(a){return L.Squarespace.Commerce.moneyFormat(a)
},"money-format":function(a){return L.Squarespace.Commerce.moneyFormat(a)
},"google-calendar-url":function(c){var f="%Y%m%dT%H%M%SZ";
var d=new Date(c.startDate);
d.setHours(d.getHours()+d.getTimezoneOffset()/60);
var a=L.DataType.Date.format(d,{format:f});
var e=new Date(c.endDate);
e.setHours(e.getHours()+e.getTimezoneOffset()/60);
var b=L.DataType.Date.format(e,{format:f});
return"http://www.google.com/calendar/event?action=TEMPLATE&text="+c.title+"&dates="+a+"/"+b+""
},AbsUrl:function(a,b){return B.get("base-url")+"/"+a
},"item-classes":function(b,j){if(j.hash){j=this
}var h=["hentry"];
var c=B.get(j,"promotedBlockType");
if(!!c){h.push("promoted");
h.push(N.slugify("promoted-block-"+c))
}var d=B.get(j,"categories");
if(!!d){for(var e=0;
e<d.length;
e++){h.push(N.slugify("category-"+d[e]))
}}var a=B.get(j,"tags");
if(!!a){for(var f=0;
f<a.length;
f++){h.push(N.slugify("tag-"+a[f]))
}}var g=B.get(j,"author");
if(!!g&&!!g.displayName){h.push(N.slugify("author-"+g.displayName))
}h.push("post-type-"+B.get(j,"recordTypeLabel"));
h.push("article-index-"+B.get(j,"@index"));
if(B.get(j,"starred")){h.push("featured")
}if(b.recordType===L.Squarespace.ContentConstants.STORE_ITEM){if(L.Squarespace.Commerce.onSale(b)){h.push("on-sale")
}if(b.payWhatYouWant){h.push("pay-what-you-want")
}}return h.join(" ")
},round:function(a,b,c){return Math.round(parseFloat(a))
},iter:function(a){return B.get(a,"@index")
},"product-status":function(a){if(L.Squarespace.Commerce.soldOut(a)){return'<div class="product-mark sold-out">sold out</div>'
}else{if(L.Squarespace.Commerce.onSale(a)){return'<div class="product-mark sale">sale</div>'
}}},"money-string":function(a){return L.Squarespace.Commerce.moneyString(a)
},"product-price":function(a){return'<div class="product-price">'+L.Squarespace.Commerce.priceString(a)+"</div>"
},"product-checkout":function(a){return L.Squarespace.Commerce.variantsSelectString(a)+L.Squarespace.Commerce.quantityInputString(a)+L.Squarespace.Commerce.payWhatYouWantInputString(a)+L.Squarespace.Commerce.addToCartBtnString(a)
},"from-price":function(a){return L.Squarespace.Commerce.fromPrice(a)
},"normal-price":function(a){return L.Squarespace.Commerce.normalPrice(a)
},"sale-price":function(a){return L.Squarespace.Commerce.salePrice(a)
},"coupon-descriptor":function(a){return L.Squarespace.Commerce.couponDescriptor(a)
},"variant-descriptor":function(a){return L.Squarespace.Commerce.variantFormat(a)
},"variants-attributes":function(a){if(a.variants===undefined||a.variants.length<=1){return""
}return L.Squarespace.Commerce.variantFormatAttributes(a.variants[0])
},"variants-select":function(a){return L.Squarespace.Commerce.variantsSelectString(a)
},"quantity-input":function(a){return L.Squarespace.Commerce.quantityInputString(a)
},"pay-what-you-want-input":function(a){return L.Squarespace.Commerce.payWhatYouWantInputString(a)
},"add-to-cart-btn":function(a){return L.Squarespace.Commerce.addToCartBtnString(a)
},"color-weight":function(a){if(a&&a.length>0&&a.length<=7){a=a.replace("#","");
return((parseInt(a,16)>16777215/2)?"light":"dark")
}else{return""
}}};
var A=[{name:"collectionTypeNameEquals?",func:function(a,b,c){return b.get("typeName")==c[0]
}}];
var I={"has-multiple?":function(a){return(a.length>1)
},"main-image?":function(a){return !!a.mainImageId||!!a.systemDataId
},"child-images?":function(b){if(!!b.items&&b.items.length>0){var a=b.items[0];
if(!!a.mainImageId||!!a.systemDataId){return true
}}return false
},"location?":function(a){return(a.location&&a.location.mapLat&&a.location.mapLng&&a.location.mapZoom)
},"excerpt?":function(c){var b=/<[^>]+>/g;
var a=/^[\u200b\s]*$/;
var d=(c.excerpt&&(c.excerpt.html||c.excerpt))||"";
return !a.test(d.replace(b,""))
},"comments?":function(c,b){var a=b._LookUpStack("websiteSettings");
var d=c.commentState===1;
if(!d&&c.publicCommentCount>0){d=true
}if(a&&!a.commentsEnabled){d=false
}return d
},"collection?":function(a){return a.collection
},"collection-page?":function(a){return(a.collection&&a.collection.type==L.Squarespace.CollectionTypes.PAGE)
},"passthrough?":function(a){return a.passthrough&&a.sourceUrl&&a.sourceUrl!==""
},"event?":function(a){return a.recordType==L.Squarespace.ContentConstants.EVENT
},"same-day?":function(c,a){try{var e=new TimezoneJS.Date(c.startDate,a.get("website.timeZone"));
var d=new TimezoneJS.Date(c.endDate,a.get("website.timeZone"));
return(e.getYear()==d.getYear())&&(e.getMonth()==d.getMonth())&&(e.getDate()==d.getDate())
}catch(b){return false
}},"external-link?":function(a){return !!a.externalLink
},"folder?":function(a){return a.collection&&a.collection.folder
},"index?":function(a){return a.collection&&a.collection.folder&&a.collection.folderBehavior==L.Squarespace.FolderBehavior.INDEX
},"singular?":function(a){return a===1
},"plural?":function(a){return a!==1
},"disqus?":function(c,b){var a=b._LookUpStack("websiteSettings");
return a&&a.disqusShortname
},"serviceNameEmail?":function(b,a){return b.serviceName==="email"
},"debug?":function(c,b){try{return b.get("debug")
}catch(a){if(a.name=="UndefinedVariable"){return false
}else{throw a
}}},"calendar-view?":function(c,a){var b=a._LookUpStack("calendarView");
return(b===true)
},"has-variants?":function(a){return L.Squarespace.Commerce.hasVariants(a)
},"varied-prices?":function(a){return L.Squarespace.Commerce.variedPrices(a)
},"on-sale?":function(a){return L.Squarespace.Commerce.onSale(a)
},"sold-out?":function(a){return L.Squarespace.Commerce.soldOut(a)
}};
var H=[{name:"output",func:function(a,b,c){return c.join(" ")
}},{name:"video",func:function(l,k,b){var a=l.oembed||{};
var h=l.assetUrl;
var g=l.mediaFocalPoint;
var m=false;
var c=false;
var f=l.colorData;
if(b){for(var e=0;
e<b.length;
e++){var j=b[e];
if(j==="load-false"){m=true
}else{if(j==="color-data"){c=true
}}}}var n='<div class="sqs-video-wrapper" '+(m?'data-load="false" ':"")+'data-html="'+L.Squarespace.Escaping.escapeForHtmlTag(a.html)+'" data-provider-name="'+a.providerName+'">';
if(l.overlay){var d='<div class="sqs-video-overlay';
if(!!l.mainImageId||!!l.systemDataId){d+='" style="opacity: 0;">';
d+='<img data-load="false" data-image="'+h+'" data-src="'+h+'" data-image-dimensions="'+(l.originalSize||"")+'" data-image-focal-point="'+(g?g.x+","+g.y:"0.5,0.5")+'" ';
if(c&&f){d+='data-color-topleft="#'+f.topLeftAverage+'" data-color-topright="#'+f.topRightAverage+'" data-color-bottomleft="#'+f.bottomLeftAverage+'" data-color-bottomright="#'+f.bottomRightAverage+'" data-color-center="#'+f.centerAverage+'" '
}d+="/>"
}else{d+=' no-thumb" style="opacity: 0;">'
}d+='<div class="sqs-video-opaque"> </div><div class="sqs-video-icon"></div>';
d+="</div>";
n+=d
}n+="</div>";
return n
}},{name:"image-color",func:function(b,d,e){var c="";
if(b.colorData){if(e.length>0){var a=b.colorData[e[0]+"Average"];
if(a){if(e.length==2){c=e[1]+": #"+a
}else{c="#"+a
}}else{c=e[0]+" not found: valid position-- topLeft, topRight, bottomLeft, bottomRight, center"
}}else{c='data-color-topleft="#'+b.colorData.topLeftAverage+'" data-color-topright="#'+b.colorData.topRightAverage+'" data-color-bottomleft="#'+b.colorData.bottomLeftAverage+'" data-color-bottomright="#'+b.colorData.bottomRightAverage+'" data-color-center="#'+b.colorData.centerAverage+'" '
}}return c
}},{name:"child-image-meta",func:function(d,f,b){var a=d.items[(b&&b[0]?b[0]:0)];
var c="0.5,0.5";
if(a.mediaFocalPoint){c=a.mediaFocalPoint.x+","+a.mediaFocalPoint.y
}var e;
if(a.title&&a.title.length>0){e=a.title
}if(!e&&a.body&&a.body.length>0){e=a.body.replace(/<(?:.|\n)*?>/gm,"")
}if(!e&&a.filename&&a.filename.length>0){e=a.filename
}if(e){e=L.Squarespace.Escaping.escapeForHtmlTag(e)
}return'data-image="'+a.assetUrl+'" data-src="'+a.assetUrl+'" data-image-dimensions="'+(a.originalSize||"")+'" data-image-focal-point="'+c+'" alt="'+e+'" '
}}];
function v(a,b){if(!!b){return function(c){return(c.recordType==a)||(c.promotedBlockType==b)
}
}else{return function(c){return(c.recordType==a)
}
}}for(var K in L.Squarespace.ContentStringConstants){I[K+"?"]=v(L.Squarespace.ContentStringConstants[K])
}I["external-video?"]=v(L.Squarespace.ContentConstants.VIDEO,"video");
I["video?"]=v(L.Squarespace.ContentConstants.VIDEO,"video");
I["image?"]=v(L.Squarespace.ContentConstants.IMAGE,"image");
I["quote?"]=v(L.Squarespace.ContentConstants.QUOTE,"quote");
I["link?"]=v(L.Squarespace.ContentConstants.LINK,"link");
I["quote?"]=v(L.Squarespace.ContentConstants.QUOTE,"quote");
I["gallery?"]=v(L.Squarespace.ContentConstants.GALLERY,"gallery");
function G(a){return function(b){return(b.promotedBlockType==a)
}
}var z=["map","embed","image","code","quote","twitter","link","video","foursquare","instagram","form"];
for(var C=0;
C<z.length;
C++){var y=z[C];
var w=y.charAt(0).toUpperCase()+y.slice(1);
I["promoted"+w+"?"]=G(y)
}I["redirect?"]=function(a){return a.folderBehavior==L.Squarespace.FolderBehavior.REDIRECT
};
I["clickable?"]=function(d,a,c){var b=a._LookUpStack("folderBehavior");
if(typeof(b)==="undefined"){return true
}return b==L.Squarespace.FolderBehavior.INDEX||b==L.Squarespace.FolderBehavior.REDIRECT
};
function J(b,a){return function(d,e,c){return e._LookUpStack("options")[b]==a
}
}for(var M in L.Squarespace.GalleryOptions){var x=L.Squarespace.GalleryOptions[M];
switch(x.type){case"select":for(var i in x.options){var E=x.options[i];
I["gallery-"+M+"-"+i+"?"]=J(M,i)
}break;
case"boolean":I["gallery-"+M+"?"]=J(M,true);
break;
case"slider":break;
default:console.log("Unknown type: "+K+", (opt: "+M+")");
break
}}I["gallery-meta?"]=function(c,a,b){return a._LookUpStack("options")["controls"]||a._LookUpStack("options")["indicators"]
};
var D={debug:function(){return function(a){var b="DEBUG:\n========================\n";
b+=JSON.stringify(this||a,null,2);
b+="END DEBUG:\n========================\n";
return b
}
},moneyFormat:function(a){return L.Squarespace.Commerce.moneyFormat(a)
}};
L.namespace("Squarespace");
L.Squarespace.HANDLEBARS_HELPERS=D;
L.Squarespace.TEMPLATE_PREDICATES=I;
L.Squarespace.TEMPLATE_PARAMETRIC_PREDICATES=A;
L.Squarespace.TEMPLATE_FORMATTERS=N;
L.Squarespace.TEMPLATE_PREFIX_FORMATTERS=H
},"1.0",{requires:["squarespace-common","squarespace-util","squarespace-commerce-utils","substitute","json"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-ui-templates",function(e){var d=e.Base.create("UITemplates",e.Base,[],{render:function(f,g){var h=this.getCompiledTemplate(f);
if(!h){throw Error(this.name+": Could not find UITemplate by the name of: "+f+". Recompile templates?")
}return h(g||{})
},renderAsNodeOrDocFrag:function(f,g){return e.Node.create(this.render(f,g))
},getCompiledTemplate:function(f){var g=this.get("compiledTemplates")[f];
if(!g){throw this.name+": A template by the name "+f+" does not exist."
}return g
}},{ATTRS:{compiledTemplates:{readOnly:true,getter:function(){var f=e.Handlebars.templates;
if(!e.Lang.isObject(f)){throw this.name+": No templates are available. Have you loaded your template module?"
}return f
}}}});
e.namespace("Squarespace").UITemplates=new d();
e.Squarespace.TEMPLATE_FORMATTERS.date=function(f,g,h){if(!e.Lang.isNumber(g)){return"Invalid date."
}return e.DataType.Date.format(new Date(g),{format:h})
};
for(var b in e.Squarespace.TEMPLATE_FORMATTERS){(function(f){e.Handlebars.registerHelper(f,function(g){return e.Squarespace.TEMPLATE_FORMATTERS[f].apply(this,[this].concat(Array.prototype.slice.call(arguments)))
})
})(b)
}for(var a in e.Squarespace.TEMPLATE_PREDICATES){(function(f){e.Handlebars.registerHelper("if-"+f.replace("?",""),function(g){return e.Handlebars.helpers["if"].call(this,function(){return e.Squarespace.TEMPLATE_PREDICATES[f](this)
},g)
})
})(a)
}for(var c in e.Squarespace.HANDLEBARS_HELPERS){(function(f){e.Handlebars.registerHelper(f,e.Squarespace.HANDLEBARS_HELPERS[f])
})(c)
}},"1.0",{requires:["base-build","handlebars-base","squarespace-template-helpers"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-ss-widget",function(c){c.namespace("Squarespace.Widgets");
var d=c.Squarespace.Widgets.SSWidget=c.Squarespace.SSWidget=c.Base.create("ssWidget",c.Widget,[c.Squarespace.BaseGetProperty],{delegatedEvents:{},initializer:function(e){this._anims=new c.Squarespace.Anims();
this.on(this.get("id")+"|classNameChange",function(g){var f=this.get("boundingBox");
if(f){f.removeClass(g.prevVal).addClass(g.newVal)
}},this);
this._events=[]
},destructor:function(){this._anims.destroy();
c.detach(this.get("id")+"|*");
this.detach(this.get("id")+"|*");
while(this._events.length!==0){this._events.shift().detach()
}},_registerEvent:function(f){this._events.push(f)
},renderUI:function(){var e=this.get("className"),f=this.get("boundingBox");
f.addClass(e);
this.get("contentBox").prepend(this.renderTemplate())
},bindUI:function(){var f=this.get("id");
this.after(f+"|stringsChange",function(g){if(!g.noSyncUI){this.syncUI()
}},this);
var e=this.get("boundingBox");
c.Object.each(this.delegatedEvents,function(g,h){c.Object.each(g,function(j,i){e.delegate(f+"|"+i,this[j],h,this)
},this)
},this)
},syncUI:function(){},_getTemplateInfo:function(){var h=d.TEMPLATE_TYPES;
var e=false;
var g=false;
var f=this.constructor;
var j,l,i;
var m=function(){l=f.HANDLEBARS_TEMPLATE;
if(c.Lang.isUndefined(l)){j=f.PUT_TEMPLATE||f.TEMPLATE
}e=!!f.PUT_TEMPLATE;
g=!!f.HANDLEBARS_TEMPLATE;
if(g){i=h.HANDLEBARS
}else{if(e){i=h.PUT
}else{i=h.HTML
}}};
m();
while(c.Lang.isUndefined(l)&&c.Lang.isUndefined(j)){f=f.superclass.constructor;
if(c.Lang.isUndefined(f)){throw this.name+": Reached topmost class in heirarchy w/o finding a template."
}m()
}var k;
if(g){k=c.Squarespace.UITemplates.getCompiledTemplate(l)
}else{if(e){k=function(){return c.zen(j)
}
}else{k=function(){return c.Node.create(j)
}
}}return{type:i,template:k}
},renderTemplate:function(){var g=d.TEMPLATE_TYPES;
var e=this._getTemplateInfo();
if(e.type===g.HANDLEBARS){var f=this._getHBTemplateContext();
return e.template(f)
}else{return e.template()
}},_getHBTemplateContext:function(){return this.getAttrs()
}},{CSS_PREFIX:"sqs-widget",HANDLEBARS_TEMPLATE:"",PUT_TEMPLATE:"",TEMPLATE:"",TEMPLATE_TYPES:{HANDLEBARS:"handlebars",PUT:"put",HTML:"html"},ATTRS:{className:{value:null}}});
var a="data-state-";
var b=c.Squarespace.Widgets.DataWidget=c.Base.create("dataWidget",c.Squarespace.SSWidget,[],{initializer:function(e){if(!e.dataState){if(this.getProperty("ASYNC_DATA")){this.set("dataState",this.getProperty("DATA_STATES").INITIALIZED)
}else{this.set("dataState",this.getProperty("DATA_STATES").LOADED)
}}},renderUI:function(){b.superclass.renderUI.call(this);
this._updateDataStateClassName()
},bindUI:function(){b.superclass.bindUI.call(this);
var e=this.get("id");
this.after(e+"|dataChange",function(f){if(!f.noSyncUI){this.syncUI()
}},this);
this.after(e+"|dataStateChange",this._updateDataStateClassName,this)
},_updateDataStateClassName:function(){var e=this.get("boundingBox"),f=this.get("dataState");
c.Object.each(this.getProperty("DATA_STATES"),function(g){e.removeClass(a+g)
},this);
e.addClass(a+f)
},setLoadingState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOADING)
},setLoadedState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOADED)
},setLoadFailedState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED)
},loadedSuccessfully:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADED
},isLoading:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADING
},loadFailed:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOAD_FAILED
}},{CSS_PREFIX:"sqs-data-widget",ASYNC_DATA:false,DATA_STATES:{INITIALIZED:"initialized",LOADING:"loading",LOADED:"loaded",LOAD_FAILED:"load-failed"},ATTRS:{data:{value:null,validator:function(e){if(c.Lang.isUndefined(e)){console.warn(this.name+": Will not set data to undefined.");
return false
}else{return true
}}},dataState:{valueFn:function(){return this.getProperty("DATA_STATES").INITIALIZED
}}}})
},"1.0",{requires:["base","widget","squarespace-base-get-property","squarespace-anims","squarespace-zen","squarespace-ui-templates"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-SearchContainerFullScreen-template",function(c){var b=c.Handlebars;
(function(){var e=b.template,d=b.templates=b.templates||{};
d["SearchContainerFullScreen.html"]=e(function(k,x,v,q,C){this.compilerInfo=[2,">= 1.0.0-rc.3"];
v=v||k.helpers;
C=C||{};
var w="",n,g="function",f=this.escapeExpression,u=this;
function t(F,E){return'\n      <div class="loading"><div class="spinner-wrapper"></div><div class="desc"> Searching your content... </div></div>\n    '
}function s(H,G){var E="",F;
E+="\n      ";
F=v["if"].call(H,H.notice,{hash:{},inverse:u.noop,fn:u.program(4,r,G),data:G});
if(F||F===0){E+=F
}E+="\n      ";
F=v["if"].call(H,H.error,{hash:{},inverse:u.noop,fn:u.program(6,p,G),data:G});
if(F||F===0){E+=F
}E+="\n    	";
F=v["if"].call(H,H.items,{hash:{},inverse:u.noop,fn:u.program(8,m,G),data:G});
if(F||F===0){E+=F
}E+="\n    ";
return E
}function r(H,G){var E="",F;
E+='\n        <div class="search-result-notice">';
if(F=v.notice){F=F.call(H,{hash:{},data:G})
}else{F=H.notice;
F=typeof F===g?F.apply(H):F
}E+=f(F)+"</div>\n      ";
return E
}function p(H,G){var E="",F;
E+='\n        <div class="search-result-notice error">';
if(F=v.error){F=F.call(H,{hash:{},data:G})
}else{F=H.error;
F=typeof F===g?F.apply(H):F
}E+=f(F)+"</div>\n      ";
return E
}function m(H,G){var E="",F;
E+='\n    	<div class="sqs-search-ui-list">\n        <div class="search-results">\n          ';
F=v.each.call(H,H.items,{hash:{},inverse:u.noop,fn:u.program(9,j,G),data:G});
if(F||F===0){E+=F
}E+="\n        </div>\n        ";
F=v["if"].call(H,H.facets,{hash:{},inverse:u.noop,fn:u.program(20,o,G),data:G});
if(F||F===0){E+=F
}E+="\n      </div>\n      ";
return E
}function j(H,G){var E="",F;
E+='\n          <div class="search-result" itemid="';
if(F=v.id){F=F.call(H,{hash:{},data:G})
}else{F=H.id;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'">\n            <div class="sqs-search-ui-item sqs-post ';
F=v["if"].call(H,H.recordTypeName,{hash:{},inverse:u.noop,fn:u.program(10,D,G),data:G});
if(F||F===0){E+=F
}E+=" ";
if(F=v.documentType){F=F.call(H,{hash:{},data:G})
}else{F=H.documentType;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'">\n              ';
F=v["if"].call(H,H.imageUrl,{hash:{},inverse:u.noop,fn:u.program(12,B,G),data:G});
if(F||F===0){E+=F
}E+='\n              <div class="sqs-title">';
if(F=v.title){F=F.call(H,{hash:{},data:G})
}else{F=H.title;
F=typeof F===g?F.apply(H):F
}if(F||F===0){E+=F
}E+=" \n                ";
F=v["if"].call(H,H.recordTypeName,{hash:{},inverse:u.noop,fn:u.program(14,A,G),data:G});
if(F||F===0){E+=F
}E+="\n                ";
F=v["if"].call(H,H.editable,{hash:{},inverse:u.noop,fn:u.program(16,z,G),data:G});
if(F||F===0){E+=F
}E+='\n              </div>\n              <div class="sqs-content">\n                ';
F=v.each.call(H,H.highlight,{hash:{},inverse:u.noop,fn:u.program(18,y,G),data:G});
if(F||F===0){E+=F
}E+="\n              </div>\n            </div>\n          </div>  \n          ";
return E
}function D(H,G){var E="",F;
E+="sqs-post-type-";
if(F=v.recordTypeName){F=F.call(H,{hash:{},data:G})
}else{F=H.recordTypeName;
F=typeof F===g?F.apply(H):F
}E+=f(F);
return E
}function B(H,G){var E="",F;
E+='\n              <div class="sqs-main-image">\n                <img src="';
if(F=v.imageUrl){F=F.call(H,{hash:{},data:G})
}else{F=H.imageUrl;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'?format=150w"> \n              </div>\n              ';
return E
}function A(H,G){var E="",F;
E+='\n                <span class="record-type">';
if(F=v.recordTypeName){F=F.call(H,{hash:{},data:G})
}else{F=H.recordTypeName;
F=typeof F===g?F.apply(H):F
}E+=f(F)+"</span>\n                ";
return E
}function z(F,E){return'\n                <span class="edit">Edit</span>\n                '
}function y(H,G){var E="",F;
E+="\n                <span>&hellip;</span>\n                <span>";
F=(typeof H===g?H.apply(H):H);
if(F||F===0){E+=F
}E+="</span>\n                ";
return E
}function o(H,G){var E="",F;
E+='\n        <div class="sqs-search-ui-filters">\n          <ul>\n            ';
F=v.each.call(H,H.facets,{hash:{},inverse:u.noop,fn:u.program(21,l,G),data:G});
if(F||F===0){E+=F
}E+="\n          </ul>\n        </div>\n        ";
return E
}function l(H,G){var E="",F;
E+='\n            <li class="sqs-search-ui-filters-group" name="';
if(F=v.name){F=F.call(H,{hash:{},data:G})
}else{F=H.name;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'">\n              <strong>';
if(F=v.displayName){F=F.call(H,{hash:{},data:G})
}else{F=H.displayName;
F=typeof F===g?F.apply(H):F
}E+=f(F)+"</strong>\n              <ul>\n                ";
F=v.each.call(H,H.values,{hash:{},inverse:u.noop,fn:u.program(22,i,G),data:G});
if(F||F===0){E+=F
}E+="\n              </ul>\n            </li>\n            ";
return E
}function i(H,G){var E="",F;
E+='\n                <li displayname="';
if(F=v.displayName){F=F.call(H,{hash:{},data:G})
}else{F=H.displayName;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'" class="';
F=v["if"].call(H,H.active,{hash:{},inverse:u.noop,fn:u.program(23,h,G),data:G});
if(F||F===0){E+=F
}E+='" filter="';
if(F=v.value){F=F.call(H,{hash:{},data:G})
}else{F=H.value;
F=typeof F===g?F.apply(H):F
}E+=f(F)+'">\n                  <a>';
if(F=v.displayName){F=F.call(H,{hash:{},data:G})
}else{F=H.displayName;
F=typeof F===g?F.apply(H):F
}E+=f(F)+' <span class="count">';
if(F=v.hits){F=F.call(H,{hash:{},data:G})
}else{F=H.hits;
F=typeof F===g?F.apply(H):F
}E+=f(F)+"</span></a>\n                </li>\n                ";
return E
}function h(F,E){return"active"
}w+='<div class"sqs-search-ui">\n  <div class="sqs-search-ui-close test"></div>\n  <div id="searchInputBox"></div>\n  <div class="sqs-search-ui-result">\n    ';
n=v["if"].call(x,x.loading,{hash:{},inverse:u.program(3,s,C),fn:u.program(1,t,C),data:C});
if(n||n===0){w+=n
}w+="\n  </div>\n</div>";
return w
})
})();
var a="SearchContainerFullScreen.html";
c.Handlebars.registerPartial(a.replace("/","."),b.templates[a])
},"1.0",{requires:["handlebars-base"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-search",function(d){d.namespace("Squarespace");
var b=d.Base.create("searchContainer",d.Squarespace.SSWidget,[],{initializer:function(e){},renderUI:function(){b.superclass.renderUI.call(this)
},bindUI:function(){var e=this.get("searchInputBox");
e.after(this.get("id")+"|queryStringChange",this._onSearchInputBoxChange,this);
this.after(this.get("id")+"|searchFilterChange",this._onSearchFilterChange,this);
this.after(this.get("id")+"|searchQueryChange",this._onSearchQueryChange,this);
this.after(this.get("id")+"|resultItemsChange",this._onSearchResultChange,this);
this.after(this.get("id")+"|loadingChange",this.syncUI,this);
this.get("contentBox").on(this.get("id")+"|keyup",this._onKeyup,this);
this.scrollTimer=d.later(250,this,this._infiniteScroll,{},true)
},removeFilter:function(e){var f=this.get("searchFilter");
f=d.Array.filter(f,function(g){if(g.name===e){return false
}return true
});
this.set("searchFilter",f)
},addFilter:function(f){var e=this.get("searchFilter");
e.push(f);
this.set("searchFilter",e)
},destructor:function(){if(this.scrollTimer){this.scrollTimer.cancel()
}},_onSearchQueryChange:function(f){this._clearResult();
this.set("loading",true);
this._search()
},_onSearchFilterChange:function(f){this._clearResult();
this.set("loading",true);
this._search()
},_onSearchResultChange:function(f){this.syncUI()
},_clearResult:function(){this.set("resultItems",null);
this.set("page",0)
},_onSearchInputBoxChange:function(g){var f=g.newVal;
this.set("searchQuery",g.newVal)
},_onKeyup:function(f){if(f.keyCode===38&&!this.get("searchInputBox").isAutocompleteEnabled()){this._moveSelectedResultItem(-1)
}else{if(f.keyCode===40&&!this.get("searchInputBox").isAutocompleteEnabled()){this._moveSelectedResultItem(1)
}else{if(f.keyCode===13){this._onEnter()
}}}},_moveSelectedResultItem:function(j){var h=this.get("contentBox").one(".active");
if(h){h.removeClass("active");
var f=this.get("contentBox").all(".sqs-search-ui-item");
var g=f.indexOf(h);
var e=f.item(g+j);
if(e){e.addClass("active");
e.scrollIntoView()
}}else{if(j>0){var i=this.get("contentBox").one(".sqs-search-ui-item");
if(i){i.addClass("active");
i.scrollIntoView()
}}}},_onEnter:function(){var e=this.get("contentBox").one(".active");
if(e&&!this.get("searchInputBox").isAutocompleteEnabled()){e.simulate("click")
}},_search:function(){var g=this.get("searchQuery");
var f=this.get("page");
if(g.length===0){return
}var e={q:g,p:f};
d.Array.each(this.get("searchFilter"),function(h){e["f_"+h.name]=h.value
});
d.Data.get({url:"/api/search/GeneralSearch",data:e,success:this._searchResultCallback,error:this._searchResultCallbackError},this)
},_searchResultCallback:function(f){this.set("loading",false);
this.set("facets",f.facets);
this.set("totalCount",f.totalCount);
var g=this.get("resultItems"),e=this.get("page");
if(e>0&&g){g=g.concat(f.items);
this.set("resultItems",g)
}else{this.set("resultItems",f.items)
}},_searchResultCallbackError:function(){this.set("loading",false);
console.error("error data",data)
},_getSearchResultObject:function(f){var e=this.get("resultItems");
return d.Array.find(e,function(g){if(g.id===f){return true
}return false
})
},_nextPage:function(){var e=this.get("page")+1;
this.set("page",e);
this._search()
},_infiniteScroll:function(){var h=this.get("contentBox").one(".sqs-search-ui-list");
if(h){var g=h.get("scrollHeight"),k=h.get("scrollTop"),j=h.get("offsetHeight"),i=g-j-k,e=this.get("resultItems"),f=this.get("totalCount");
if(!e){return
}if(i<100&&f>e.length){this._nextPage()
}}}},{ATTRS:{searchInputBox:{value:null},searchFilter:{value:[]},page:{value:0},searchQuery:{value:null},resultItems:{validator:d.Lang.isArray},totalCount:{value:0,validator:d.Lang.isNumber},facets:{value:[],validator:d.Lang.isArray},errorNotice:{validator:d.Lang.isString},notice:{validator:d.Lang.isString},loading:{value:false,validator:d.Lang.isBoolean}}});
var c=d.Base.create("searchContainerFullScreen",b,[],{initializer:function(e){},renderUI:function(){c.superclass.renderUI.call(this);
this._open=true;
var e=this.get("contentBox");
e.addClass("sqs-search-ui");
var h=this.get("searchQuery");
var f=d.Node.create(d.Squarespace.UITemplates.render(c.TEMPLATE_NAME,this._getSearchDataModel()));
e.append(f);
e.plug(d.Squarespace.Animations.Fadeable,{duration:0.2,opacity:0.99});
var g=new a({queryString:h,srcNode:f.one("#searchInputBox"),inputType:"text",withSearchSuggest:true});
this.set("searchInputBox",g);
g.render();
g.focus();
d.one("body").addClass("no-scroll");
d.one("body").addClass("sqs-search-ui-fullscreen");
e.hide(true);
e.show();
d.Squarespace.EscManager.addTarget(this)
},bindUI:function(){c.superclass.bindUI.call(this);
var e=this.get("contentBox");
e.one(".sqs-search-ui-close").on(this.get("id")+"|click",this._closeClick,this);
e.delegate(this.get("id")+"|click",this._toggleFilter,".sqs-search-ui-filters-group li",this);
e.delegate(this.get("id")+"|click",this._clickResult,".sqs-search-ui-list .search-result",this);
this.get("boundingBox").on(this.get("id")+"|click",this._onClick,this)
},syncUI:function(){var e=this.get("contentBox"),i=this.get("page");
var f=d.Node.create(d.Squarespace.UITemplates.render(c.TEMPLATE_NAME,this._getSearchDataModel()));
if(i===0){e.one(".sqs-search-ui-result").replace(f.one(".sqs-search-ui-result"))
}else{var h=e.one(".sqs-search-ui-list .search-results");
var j=h.get("children").size();
var g=f.one(".sqs-search-ui-list .search-results").get("children");
g=g.splice(j);
h.append(g)
}if(this.get("loading")){this._spinner=new d.Squarespace.Spinner({color:"dark",size:"large",render:e.one(".spinner-wrapper")})
}},_getSearchDataModel:function(h){var e=this.get("resultItems");
var g=this.get("facets");
var f={loading:this.get("loading"),error:this.get("errorNotice"),items:e,facets:g};
if(e){if(e.length===0){f.notice="Your search did not match any documents."
}}else{f.notice="Begin typing your search above and press return to search.  Press Esc to cancel."
}return f
},_closeClick:function(f){f.stopPropagation();
this._close()
},isOpen:function(){return this._open
},close:function(){this._close()
},_close:function(f){this._open=false;
d.one("body").removeClass("no-scroll");
d.one("body").removeClass("sqs-search-ui-fullscreen");
if(f){this.destroy()
}else{var e=this.get("contentBox");
e.once("hidden",function(){this.destroy()
},this);
e.hide()
}},destructor:function(){this.get("boundingBox").remove();
this.get("searchInputBox").destroy();
d.Squarespace.EscManager.removeTarget(this)
},_toggleFilter:function(k){k.preventDefault();
var j=k.target.ancestor("li",true);
if(!j){return
}var h=j.getAttribute("filter");
var f=j.getAttribute("displayname");
var g=j.ancestor(".sqs-search-ui-filters-group").getAttribute("name");
var i=j.hasClass("active");
if(i){this.removeFilter(g)
}else{this.addFilter({displayName:f,value:h,name:g})
}},_onClick:function(f){f.stopPropagation();
this.get("searchInputBox").focus()
},_clickResult:function(i){i.halt();
var h=i.target.ancestor(".search-result",true);
if(!h){return
}var j=h.getAttribute("itemid");
if(!j){return
}var g=this._getSearchResultObject(j);
this._close(true);
if(i.target.ancestor(".edit",true)){if(g.recordType){var f=new d.Squarespace.Models.ContentItem({id:g.id});
f.load(function(){var e=new (d.Squarespace.ContentItemEditorFactory.getEditor(f))({model:f});
e.show()
})
}else{if(d.Squarespace.ACTIVE_MANAGER){d.Squarespace.ACTIVE_MANAGER.getHistory().replace({module:"content",collectionId:g.collectionId})
}else{if(d.Squarespace.Management){d.Squarespace.Management.manageSite({module:"content",collectionId:g.collectionId})
}}}}else{document.location.href=g.itemUrl
}}},{TEMPLATE_NAME:"SearchContainerFullScreen.html",ATTRS:{}});
var a=d.Base.create("searchInputBox",d.Widget,[],{initializer:function(e){},renderUI:function(){var e=this._createSearchNode();
this.get("contentBox").append(e)
},bindUI:function(){this._enableAutoComplete();
this.get("boundingBox").one("form").on(this.get("id")+"|submit",this._onSubmit,this);
this.get("boundingBox").one("form").on(this.get("id")+"|keydown",this._onKeyDown,this);
this.after(this.get("id")+"|queryStringChange",this._resetAutoComplete,this)
},_onKeyDown:function(f){if(f.keyCode!==27){f.stopPropagation()
}},_autocompleteSelected:function(f){d.later(1,this,function(g){this.set("queryString",g.result.text)
},f)
},_onSubmit:function(g){g.preventDefault();
var f=this.get("contentBox").one("input").get("value");
this.set("queryString",f)
},_enableAutoComplete:function(){var f=this.get("contentBox").one("input");
if(this.get("withSearchSuggest")&&!f.ac){f.plug(d.Plugin.AutoComplete,{source:"/api/search/SearchSuggest?q={query}",resultTextLocator:"suggestion"});
var e=this.get("boundingBox").one("input").ac;
e.on("select",this._autocompleteSelected,this)
}},isAutocompleteEnabled:function(){var e=this.get("contentBox").all(".yui3-aclist-item");
if(e.size()>0){return true
}return false
},_resetAutoComplete:function(){var e=this.get("boundingBox").one("input");
if(e.ac){e.unplug("ac")
}this._enableAutoComplete()
},focus:function(){var e=this.get("contentBox").one("input");
e.focus();
e.set("value",this.get("queryString"));
if(this.get("queryString")!==""){e.select()
}},blur:function(){var e=this.get("contentBox").one("input");
e.blur()
},_createSearchNode:function(){var e=d.Node.create("<form/>");
e.append(d.DB.INPUT("field-input",{placeholder:"Type to search...",type:this.get("inputType"),spellcheck:false,value:this.get("queryString")}));
if(this.get("queryString")){this._lastQuery=this.get("queryString")
}return e
}},{ATTRS:{queryString:{value:""},inputType:{value:"search"},withSearchSuggest:{value:false}}});
d.Squarespace.Search=new (d.Base.create("searchSingleton",d.Base,[],{initializer:function(){this.attached=false
},onButtonClick:function(f){f.halt();
d.use("widget","autocomplete","squarespace-search-ui-css","squarespace-ui-templates","squarespace-animations",d.bind(function(e){this.show()
},this))
},show:function(){if(this.containerWidget&&this.containerWidget.isOpen()){return
}var e={searchQuery:""};
this.containerWidget=new c(e);
this.containerWidget.render()
},attach:function(){if(this.attached){return
}d.delegate("click",this.onButtonClick,"body",".sqs-search-ui-button",this);
d.one(document.body).on("keydown",function(f){if(f.ctrlKey&&f.keyCode==83){d.use("widget","autocomplete","squarespace-search-ui-css","squarespace-ui-templates","squarespace-animations",function(e){e.Squarespace.Search.show()
})
}},this);
this.attached=true
}},{ATTRS:{}}))()
},"1.0",{requires:["base","squarespace-ss-widget","squarespace-SearchContainerFullScreen-template"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-image-loader",function(a){if(!window.ImageLoader){console.warn("Image Loader is not available. Automatically including ImageLoader.js.");
a.use("get",function(){a.Get.js("/universal/scripts-v6/ImageLoader.js")
})
}a.namespace("Squarespace").Loader=a.Base.create("Loader",a.Base,[],{initializer:function(){if(this.get("frames")){this._processFrames()
}if(this.get("img")){this._processImages()
}},_processFrames:function(){this._getNodeList("frames").each(function(b){if(b.getAttribute("data-embed")){b.resizeToParent({scale:"contain",sizeOnly:true})
}})
},_processImages:function(){this._getNodeList("img").each(function(b){var c=false;
if(b.loader){c=true
}b.plug(a.Squarespace.Loader2,this.get("loaderOptions")||{});
if(c){b.fire("refresh")
}},this)
},_getNodeList:function(b){var c=this.get(b);
if(a.Lang.isString(c)){return a.all(c)
}else{if(!c.size){return new a.NodeList(c)
}else{return c
}}}},{ATTRS:{frames:{},img:{},loaderOptions:{}}});
a.namespace("Squarespace").Loader2=a.Base.create("Loader2",a.Plugin.Base,[],{initializer:function(){var d=this.get("host");
var b=100;
var c=0;
function e(){if(!d.inDoc()&&(++c<b)){a.later(10,this,e)
}else{this.load()
}}e.call(this);
this.on("refresh",this.load,this);
d.on("refresh",this.load,this)
},load:function(){var b=this.get("host");
if(!!b.getAttribute("src")&&b.get("complete")){b.fire("loaded")
}b.on("load",function(){if(b.getDOMNode()===null||!b.inDoc()){console.warn("Invalid host. Bailing.");
return
}b.removeClass("loading").addClass("loaded");
b.fire("loaded")
},this);
if(b.getDOMNode()===null||!b.inDoc()){console.warn("Invalid host. Bailing.");
return
}ImageLoader.load(b.getDOMNode(),a.merge(this.getAttrs(),{load:this.get("load")}))
},getDimensionForValue:function(c,b){return ImageLoader.getDimensionForValue(c,b,ImageLoader._getDataFromNode(this.get("host").getDOMNode()))
},getBareElement:function(){var b=this.get("host");
var c=a.Node.create("<img />");
c.setAttribute("data-src",b.getAttribute("data-src"));
c.setAttribute("data-image-dimensions",b.getAttribute("data-image-dimensions"));
c.setAttribute("data-image-focal-point",b.getAttribute("data-image-focal-point"));
return c
},destructor:function(){}},{NS:"loader",ATTRS:{stretch:{value:true},load:{value:true},source:{},fitAlignment:{},fit:{value:false,setter:function(b){if(b){this.set("mode","fit")
}}},fill:{value:false,setter:function(b){if(b){this.set("mode","fill")
}}},focalPoint:{setter:function(b){ImageLoader.load(this.get("host").getDOMNode(),{focalPoint:b.x+","+b.y});
return b
}},mode:{validator:function(b){return["fit","fill","none",null].indexOf(b)!==-1
}},refreshOnResize:{value:false}}});
a.namespace("Squarespace").ImageLoadManager=new (a.Base.create("ImageLoadManager",a.Base,[],{refreshAll:function(){a.all("img[data-src]").each(function(b){b.fire("refresh")
})
}}))();
a.augment(a.Node,Class.create({refresh:function(){this.fire("refresh")
}}))
},"1.0",{requires:["base","plugin","node"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-video-loader",function(a){a.namespace("Squarespace");
a.Squarespace.VideoLoader=a.Base.create("VideoLoader",a.Plugin.Base,[],{initializer:function(){var b=this.get("host");
b.plug(a.Squarespace.NodeDestroyNotifier,{onDestroy:function(){this.destroy()
},context:this});
this._setVariables();
this._resizeEmitter=new a.Squarespace.ResizeEmitter({timeout:100});
this._modeClass="video-"+this.get("mode");
b.addClass(this._modeClass);
this.once("loaded",this.bindUI,this);
if(this.get("load")){this.load()
}},destructor:function(){this._resizeEmitter.destroy()
},load:function(){if(this._loaded){return
}if(this.get("type")=="invalid"){this._intrinsic=false;
if(this.get("overlay")){this.get("overlay").remove();
this._set("overlay",null)
}}var k=this.get("host");
var d=this.get("mode");
k.removeClass(this._modeClass);
this._modeClass="video-"+d;
k.addClass(this._modeClass);
var j;
var c;
if(this._intrinsic){var h=this.getWidth();
var e=this.getHeight();
var b;
if(h&&e){b=(e/h)*100
}else{b=56.3
}j=a.Node.create('<div class="intrinsic"></div>');
c=a.Node.create('<div class="intrinsic-inner" style="padding-bottom: '+b+'%;"></div>');
var i=k.get("parentNode");
var g=i.getComputedStyle("position");
if(d=="fit"){k.setStyles(k.getAdjustedDimensions({scale:"contain",width:this.getWidth(),height:this.getHeight()}));
if(g=="static"){i.setStyle("position","relative")
}}else{if(d=="fill"){if(g=="static"){i.setStyle("position","relative")
}}}if(this.get("overlay")){this.get("overlay").wrap(c);
c.wrap(j)
}else{j.appendChild(c);
k.appendChild(j)
}}if(this.get("overlay")){this.get("overlay").setStyle("opacity",1);
var f=this.get("overlay").one("img");
if(f){f.fire("refresh");
this.get("overlay").one("img").plug(a.Squarespace.Loader2,{load:true,mode:"fill"});
this.get("overlay").one("img").fire("refresh")
}}else{if(j){c.appendChild(this.get("video"))
}else{k.appendChild(this.get("video"))
}this._set("showingVideo",true)
}this.fire("loaded");
this._loaded=true
},unload:function(){var b=this.get("host");
b.setStyles({top:null});
this.showOverlay();
if(this.get("overlay")){this.get("overlay").remove()
}this.get("video").remove();
if(this._intrinsic){b.one(".intrinsic").remove(true)
}if(this.get("overlay")){this.get("overlay").setStyle("opacity",0);
b.appendChild(this.get("overlay"))
}this._setIntrinsic();
this._loaded=false
},reload:function(){this.unload();
this.load()
},bindUI:function(){if(!Static.IN_BACKEND){if(this.get("overlay")){this.get("overlay").on("click",function(b){if(!this.get("inactive")){this.showVideo()
}},this)
}}this.after("modeChange",this.reload,this);
this._resizeEmitter.on("resize",function(){if(this.get("mode")=="fit"){this._resetFitTop()
}if(this.get("overlay")){this.get("overlay").one("img").fire("refresh")
}},this);
a.Global.on("tweak:aftershow",function(){if(this.get("mode")=="fit"){this._resetFitTop()
}},this);
a.Global.after("tweak:afterclose",function(){if(this.get("mode")=="fit"){setTimeout(a.bind(function(){this._resetFitTop()
},this),1000)
}},this)
},showVideo:function(){if(this.get("showingVideo")||!this.get("overlay")){return
}this._set("showingVideo",true);
this._showOverlayOnOthers();
var c=this.get("video");
c.setStyle("opacity",0);
if(this._intrinsic){this.get("host").one(".intrinsic-inner").appendChild(c)
}else{this.get("host").appendChild(c)
}var b=this.get("overlay");
b.one(".sqs-video-opaque").anim({opacity:1},{duration:1,start:function(){b.one(".sqs-video-icon").setStyle("visibility","hidden")
},end:function(){this.get("video").setStyle("opacity",1);
if(this.get("showingVideo")){b.setStyle("visibility","hidden")
}if(b.hasClass("no-thumb")){b.one(".sqs-video-opaque").setStyle("opacity",1)
}else{b.one(".sqs-video-opaque").setStyle("opacity",0)
}b.one(".sqs-video-icon").setStyle("visibility",null)
},context:this}).run()
},showOverlay:function(){if(!this.get("showingVideo")||!this.get("overlay")){return
}this._set("showingVideo",false);
this.get("overlay").setStyle("opacity",0);
this.get("overlay").setStyle("visibility",null);
var b=this.get("video");
b.anim({opacity:0},{duration:0.3,start:function(){this.get("overlay").anim({opacity:1},{duration:0.3}).run()
},end:function(){b.remove()
},context:this}).run()
},refreshVideo:function(){if(!this.get("showingVideo")){return
}var c=this.get("video");
if(this.get("type")=="object"){c.remove();
var b=this.get("host");
if(this._intrinsic){b.one(".intrinsic-inner").appendChild(c)
}else{b.appendChild(c)
}}else{if(this.get("type")=="iframe"){c.setAttribute("src",c.getAttribute("src"))
}}},play:function(){if(!this.get("apiFriendly")){return
}var b=this.get("video").getDOMNode().contentWindow;
switch(this._providerName){case"Vimeo":b.postMessage('{"method": "play", "value": "true"}',"*");
break;
case"YouTube":b.postMessage('{"event":"command","func":"playVideo","args":""}',"*");
break
}},pause:function(){if(!this.get("apiFriendly")){return
}var b=this.get("video").getDOMNode().contentWindow;
switch(this._providerName){case"Vimeo":b.postMessage('{"method": "pause", "value": "true"}',"*");
break;
case"YouTube":b.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");
break
}},getWidth:function(){return this.get("video").getAttribute("width")
},getHeight:function(){return this.get("video").getAttribute("height")
},_setVariables:function(){var f=this.get("host");
this._setIntrinsic();
this._set("overlay",f.one(".sqs-video-overlay"));
var e=a.Node.create(f.getAttribute("data-html"));
var b=a.Node.create('<div class="sqs-video-invalid-wrapper"><div class="state-message">Invalid video embed.</div></div>');
var d;
if(!e){d=b;
this._set("type","invalid")
}else{if(e.test("iframe")){d=e;
this._set("type","iframe")
}else{if(e.test("object")){d=e;
this._set("type","object")
}else{if(e.one("iframe")){d=e.one("iframe");
this._set("type","iframe")
}else{if(e.one("object")){if(e.one("embed")){d=e.one("object");
this._set("type","object")
}else{d=b;
this._set("type","invalid")
}}else{d=b;
this._set("type","invalid")
}}}}}this._set("video",d);
var c=f.getAttribute("data-provider-name");
if((!c||c==="")&&this.get("type")!="invalid"){var g=this.get("video").getAttribute("src");
if(g.match("player.vimeo.com")){c="Vimeo"
}else{if(g.match("www.youtube.com")){c="YouTube"
}}}this._providerName=c;
if(this.get("type")==="invalid"){f.addClass("video-invalid")
}else{this._augmentVideoSrc();
f.removeClass("video-invalid")
}},_setIntrinsic:function(){this._intrinsic=(this.get("mode")=="none"||this.get("mode")=="fit")
},_resetFitTop:function(){var d=this.get("host");
var c=d.get("parentNode").get("offsetHeight");
var e=d.one(".intrinsic");
e.setStyle("top",null);
var b=e.get("offsetHeight");
d.setStyle("top",(c-b)/2+"px")
},_augmentVideoSrc:function(){var b=(this.get("type")=="iframe")?this.get("video"):this.get("video").one("embed");
var f=b.getAttribute("src");
var c=f.split("?");
var e=c[0];
var g=c[1]||"";
var d=a.QueryString.parse(g);
if(this.get("overlay")){if(this._providerName=="Wistia, Inc."){d.autoPlay="true"
}else{d.autoplay=1
}}if(this.get("type")=="object"||this._providerName=="Vimeo"){if(window.location.protocol.startsWith("https")){e=e.replace("http://","https://")
}}if(this.get("type")=="iframe"){switch(this._providerName){case"Vimeo":d.api=1;
this._set("apiFriendly",true);
break;
case"YouTube":d.enablejsapi=1;
this._set("apiFriendly",true);
break
}}f=e+"?"+a.QueryString.stringify(d);
b.setAttribute("src",f)
},_showOverlayOnOthers:function(){a.all(".sqs-video-wrapper").each(function(b){if(b==this.get("host")){return
}b.videoloader.showOverlay()
},this)
}},{NS:"videoloader",ATTRS:{apiFriendly:{value:false,readOnly:true},inactive:{value:false},load:{value:true},mode:{value:"none",validator:function(b){return["none","fit","fill",null].indexOf(b)!=-1
}},overlay:{value:null,readOnly:true},showingVideo:{value:false,readOnly:true},type:{value:null,readOnly:true},video:{value:null,readOnly:true}}})
},"1.0",{requires:["base","plugin","node","querystring","squarespace-image-loader","squarespace-video-css"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-dombuilder",function(a){a.DB={unpackData:function(c,b){if(c._node){c=c._node
}if(b){while(c){if(c.data&&c.className.indexOf(b)!=-1){return c.data
}c=c.parentNode
}}else{while(c){if(c.data){return c.data
}c=c.parentNode
}}return(null)
},DIV:function(){return(a.DB._gen("DIV",Array.prototype.slice.call(arguments)))
},PARAGRAPH:function(){return(a.DB._gen("P",Array.prototype.slice.call(arguments)))
},LI:function(){return(a.DB._gen("LI",Array.prototype.slice.call(arguments)))
},SPAN:function(){return(a.DB._gen("SPAN",Array.prototype.slice.call(arguments)))
},A:function(){return(a.DB._gen("A",Array.prototype.slice.call(arguments)))
},UL:function(){return(a.DB._gen("UL",Array.prototype.slice.call(arguments)))
},LABEL:function(){return(a.DB._gen("LABEL",Array.prototype.slice.call(arguments)))
},INPUT:function(){return(a.DB._gen("INPUT",Array.prototype.slice.call(arguments)))
},TEXTAREA:function(){return(a.DB._gen("TEXTAREA",Array.prototype.slice.call(arguments)))
},SELECT:function(){return(a.DB._gen("SELECT",Array.prototype.slice.call(arguments)))
},OPTION:function(){return(a.DB._gen("OPTION",Array.prototype.slice.call(arguments)))
},IMG:function(){return(a.DB._gen("IMG",Array.prototype.slice.call(arguments)))
},TABLE:function(){return(a.DB._gen("TABLE",Array.prototype.slice.call(arguments)))
},TBODY:function(){return(a.DB._gen("TBODY",Array.prototype.slice.call(arguments)))
},THEAD:function(){return(a.DB._gen("THEAD",Array.prototype.slice.call(arguments)))
},TH:function(){return(a.DB._gen("TH",Array.prototype.slice.call(arguments)))
},TR:function(){return(a.DB._gen("TR",Array.prototype.slice.call(arguments)))
},TD:function(){return(a.DB._gen("TD",Array.prototype.slice.call(arguments)))
},VIDEO:function(){return(a.DB._gen("VIDEO",Array.prototype.slice.call(arguments)))
},PARAM:function(){return(a.DB._gen("PARAM",Array.prototype.slice.call(arguments)))
},OBJECT:function(){return(a.DB._gen("OBJECT",Array.prototype.slice.call(arguments)))
},SOURCE:function(){return(a.DB._gen("SOURCE",Array.prototype.slice.call(arguments)))
},SUP:function(){return(a.DB._gen("SUP",Array.prototype.slice.call(arguments)))
},BUTTON:function(){return(a.DB._gen("BUTTON",Array.prototype.slice.call(arguments)))
},_gen:function(o,l){var d=document.createElement(o);
var c=0;
if(l.length>c&&typeof(l[c])=="string"){d.className=l[c];
++c
}if(l.length>c&&l[c]!=null&&typeof(l[c])=="object"&&!(l[c] instanceof Array)&&(l[c].getAttribute==null)&&(l[c]._node==null)){var m=l[c];
++c;
for(var e in m){if(e=="html"){d.innerHTML=m[e]
}else{if(e=="data"){d.data=m[e]
}else{if(e=="style"&&typeof(m[e])=="object"){for(var g in m[e]){d.style[g]=m[e][g]
}}else{d.setAttribute(e,m[e])
}}}}if(o=="A"){if(!m.href){d.href="javascript:noop();"
}}}d=a.one(d);
if(d.data&&d.data()){d._data=d.data()
}for(var h=c;
h<l.length;
++h){if(l[h] instanceof Array){for(var f=0;
f<l[h].length;
++f){var b=l[h][f];
d.append(b)
}}else{var b=l[h];
d.append(b)
}}return d
}}
},"1.0",{requires:["node"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-audio-player",function(c){var b=function(){};
var a=c.namespace("Squarespace.Widgets").AudioPlayer=c.Base.create("audioPlayer",c.Squarespace.Widgets.SSWidget,[],{initializer:function(d){var e=this.get("render");
if(c.Lang.isBoolean(e)){e=null
}else{if(c.Lang.isString(e)){e=c.one(e)
}}if(e){if(e._audioPlayer){e._audioPlayer.destroy()
}e._audioPlayer=this;
c.Object.each(e.getData(),function(g,f){if(g){this.set(f,g)
}},this)
}c.use("thirdparty-sound-manager-2",b)
},destructor:function(){if(this._sound){this.stop();
this._sound.destruct()
}},render:function(){var d=arguments;
c.use("thirdparty-sound-manager-2",c.bind(function(e){this._soundManager=soundManager;
a.superclass.render.apply(this,d)
},this))
},renderUI:function(){a.superclass.renderUI.apply(this,arguments);
var f=this.get("boundingBox");
var l=f.one(".placeholder");
var k=this.get("title"),h=this.get("author");
if(k&&h){l.setContent(c.Node.create('<div class="wrapper"><div class="audio-author">'+h+'</div><div class="audio-title">'+k+"</div></div>"))
}else{if(k){l.setContent(c.Node.create('<div class="wrapper"><div class="audio-title">'+k+"</div></div>"))
}else{l.setContent(c.Node.create('<div class="wrapper">'+this.get("strings.placeholder")+"</div>"))
}}f.one(".progress-inner").setStyle("width","0px");
this._volumeNode=f.one(".volume");
if(!this._volumeNode){throw this.name+": No div.volume in template."
}var e=this.get("volumeLevels"),j=this.get("volume"),d=Math.round(j/100*e);
for(var g=e;
g>0;
g--){this._volumeNode.prepend(c.zen("div.bar.level-"+g+'[data-volume-level="'+g+'"]'))
}f.one(".duration").setContent(this.get("strings.durationPlaceHolder"))
},bindUI:function(){var d=this.get("id");
this.get("boundingBox").on(d+"|click",this._onClick,this);
this.after(d+"|volumeChange",function(f){this._setVolume(f.newVal)
},this);
this.after(d+"|playStateChange",this._uiUpdateWrapperClass,this);
this.after(d+"|readyStateChange",this._afterReadyStateChange,this);
this.after(d+"|disabledChange",function(g){var f=g.newVal;
if(f){this.stop()
}},this);
c.on(d+"|audioPlayer:stopAll",function(g){var f=g?g.container:null;
if(f&&c.Lang.isString(f)){f=c.one(f)
}if(!g||!g.hasOwnProperty("container")||((f instanceof c.Node)&&f.contains(this.get("boundingBox")))){this.stop()
}},this)
},syncUI:function(){this._uiUpdateWrapperClass();
this._uiUpdateVolumeLevel()
},play:function(){if(!this._sound){this._initSoundManagerSound()
}if(this._sound){if(this._sound.paused){this._sound.resume()
}else{this._sound.play()
}}},pause:function(){if(this._sound){this._sound.pause()
}},stop:function(){var e=this.get("playState"),d=this.getProperty("PLAY_STATES");
if(e===d.PLAYING&&this._sound){this._sound.stop()
}},seek:function(d){if(d>100||d<0){console.warn(this.name+": seek() - Percentage between 0-100 required.");
return
}if(!this._sound){this._initSoundManagerSound()
}this.pause();
this._sound.setPosition(this._sound.duration*(d/100));
this.play()
},setVolume:function(d){this.set("volume",d)
},_checkSoundManagerStatus:function(){var d=this._soundManager,e=this.getProperty("READY_STATES");
if(d.enabled){this._set("readyState",e.INITIALIZED);
return true
}else{if(d.didFlashBlock){this._set("readyState",e.FLASH_BLOCKED)
}else{this._set("readyState",e.SECURITY_ERROR)
}return false
}},_setVolume:function(d){if(this._sound){this._sound.setVolume(d)
}this._set("volume",d);
this._uiUpdateVolumeLevel()
},_setVolumeLevel:function(d){this._setVolume(Math.round(d/this.get("volumeLevels")*100))
},_initSoundManagerSound:function(){if(this._checkSoundManagerStatus()===false){return false
}if(!this._sound){var e=this.get("boundingBox"),d=this.get("url");
e.addClass("loading");
if(!d){this._showError("No URL provided.");
return
}if(d.indexOf(Static.SQUARESPACE_CONTEXT.appDomain)>0){d=d.replace(/^(http:\/\/|https:\/\/|\/\/)/i,window.location.protocol+"//")
}this._sound=this._soundManager.createSound({id:"squarespaceTrack-"+this.get("id"),url:d,volume:this.get("volume"),autoPlay:false,onplay:c.bind(this._onPlay,this),onpause:c.bind(this._onPause,this),onresume:c.bind(this._onPlay,this),onstop:c.bind(this._onStop,this),onfinish:c.bind(this._onStop,this),whileplaying:c.bind(this._onWhilePlaying,this),onload:c.bind(this._onLoad,this),ondataerror:c.bind(this._onDataError,this)});
return !!this._sound
}return false
},_uiUpdateVolumeLevel:function(){var f=this._volumeNode.get("children"),d=this.get("volumeLevels"),e=this.get("volume"),g=Math.round(e/100*d);
f.each(function(h){var i=parseInt(h.getAttribute("data-volume-level"),10);
if(i<=g){h.addClass("active")
}else{h.removeClass("active")
}},this)
},_uiUpdateWrapperClass:function(){var i=this.getProperty("READY_STATES"),g=this.getProperty("PLAY_STATES"),f=this.get("boundingBox"),e=f.getAttribute("class").split(" ");
var d=function(k){var j=c.Array.indexOf(e,k);
if(j!==-1){e.splice(j)
}};
var h;
for(h in g){e.remove("play-state-"+g[h])
}for(h in i){e.remove("ready-state-"+i[h])
}f.addClass("ready-state-"+this.get("readyState"));
f.setAttribute("class",e.join(" ")).addClass("play-state-"+this.get("playState")).addClass("ready-state-"+this.get("readyState"))
},_onClick:function(h){h.halt();
h.stopImmediatePropagation();
if(this.get("disabled")){return
}if(h.target.hasClass("duration")){return
}if(h.target.ancestor(".volume")){this._setVolumeLevel(parseInt(h.target.getAttribute("data-volume-level"),10));
return
}if(h.target.ancestor(".placeholder",true)){this.play();
return
}if(h.target.ancestor(".controls",true)){var g=this.get("playState"),f=this.getProperty("PLAY_STATES");
switch(g){case f.PLAYING:this.pause();
return;
case f.PAUSED:case f.STOPPED:this.play();
return;
default:console.warn(this.name+": Wait, what? How did you get here? Case was ",g);
return
}}var d=this.get("boundingBox").one(".progress").get("region");
if(h.pageX>=d.left&&h.pageX<=d.right){this.seek((h.pageX-d.left)/d.width*100)
}},_afterReadyStateChange:function(i){var h=this.getProperty("READY_STATES"),g=this.get("readyState"),d=this.get("strings"),f=false;
switch(g){case h.INITIALIZED:this.enable();
break;
case h.FLASH_BLOCKED:f=d.soundManagerFlashFail;
break;
case h.SECURITY_ERROR:f=d.soundManagerSecurityFail;
break;
case h.SOUND_LOAD_FAILED:f=d.soundManagerURLFail;
break;
case h.SOUND_LOADED:break;
default:console.warn(this.name+": Invalid ready state ("+g+").");
break
}if(f){console.warn("AUDIO ERROR: "+f);
this._showError(f);
this.disable()
}this._uiUpdateWrapperClass()
},_getPlaytimeString:function(){if(!this._sound){return this.get("strings.durationPlaceHolder")
}var e="0:00";
var d="0:00";
if(this._sound.duration&&this._sound.loaded){e=this._getMinSecString(this._sound.duration)
}if(this._sound.position){d=this._getMinSecString(this._sound.position)
}return d+" / "+e
},_getMinSecString:function(d){return c.Squarespace.Utils.humanizeDuration(d)
},_showError:function(d){this.get("boundingBox").addClass("error");
this.get("boundingBox").one(".placeholder").setContent("Error: "+d)
},_onWhilePlaying:function(){if(this.get("destroyed")){return
}var d=this.get("boundingBox");
d.one(".duration").setContent(this._getPlaytimeString());
if(!(this._sound.loaded&&this._sound.duration)){return
}var f=this.getProperty("READY_STATES");
if(this.get("readyState")!==f.SOUND_LOADED){this._set("readyState",f.SOUND_LOADED)
}var e=d.one(".progress-inner");
var g=this._sound.position/this._sound.duration*100;
d.removeClass("loading");
if(e){e.setStyle("width",g+"%")
}},_onPlay:function(){if(this._loadFailTimer){this._loadFailTimer.cancel()
}var d=c.Squarespace.Widgets.AudioPlayer.PLAY_STATES;
this._set("playState",d.PLAYING)
},_onStop:function(){this._set("playState",this.getProperty("PLAY_STATES").STOPPED)
},_onPause:function(){this._set("playState",this.getProperty("PLAY_STATES").PAUSED)
},_onDataError:function(){this.stop();
this._set("playState",this.getProperty("PLAY_STATES").STOPPED)
},_onLoad:function(d){if(!d){this._loadFailTimer=c.later(1000,this,function(){this.stop();
this._set("readyState",this.getProperty("READY_STATES").SOUND_LOAD_FAILED)
})
}}},{CSS_PREFIX:"sqs-audio-player",PLAY_STATES:{PLAYING:"playing",PAUSED:"paused",STOPPED:"stopped"},READY_STATES:{INITIALIZED:"initialized",FLASH_BLOCKED:"flash-blocked",SECURITY_ERROR:"security-error",SOUND_LOAD_FAILED:"sound-load-failed",SOUND_LOADED:"sound-loaded"},PUT_TEMPLATE:"div.controls+div.placeholder+div.progress>div.progress-inner>div.scrubber<<<div.duration+div.volume<",ATTRS:{strings:{value:{placeholder:"Click to play...",durationPlaceHolder:"0:00 / 0:00",loadFail:"Unable to load sound at the URL",soundManagerFlashFail:"Sorry, could not load because flash is blocked.",soundManagerSecurityFail:"Sorry, there was a JavaScript security error.",soundManagerURLFail:"Unable to access audio stream."}},playState:{lazyAdd:false,valueFn:function(){return this.getProperty("PLAY_STATES").STOPPED
},readOnly:true},readyState:{lazyAdd:false,valueFn:function(){return this.getProperty("READY_STATES").INITIALIZED
},readOnly:true},url:{value:null},volume:{validator:function(d){if(d<0||d>100){console.warn(this.name+": Volume must be between 0 and 100, volume remains unchanged.")
}return true
},value:66},volumeLevels:{value:6,writeOnce:"initOnly"},stopOthersOnPlay:{value:true},render:{value:true}}})
},"1.0",{requires:["node","event","squarespace-dombuilder","squarespace-ss-widget","squarespace-audio-player-css"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-gismo",function(a){a.Squarespace.GismoBase=function(){this._gismoEvents={};
this._timers={};
this._anims=this._anims||new a.Squarespace.Anims()
};
a.Squarespace.GismoBase.prototype={destructor:function(){for(var b in this._gismoEvents){while(this._gismoEvents[b].length!==0){this._gismoEvents[b].shift().detach()
}}for(var c in this.timers){while(this._timer[c].length!==0){this._timer[c].shift().cancel()
}}this._anims.destroy()
},_anim:function(b,e,c){var d=b.anim(e,c||{});
d.on("end",function(){this._anims.remove(d)
},this);
this._anims.add(d);
return d
},_event:function(c,b){b=b||"generic";
this._gismoEvents[b]=this._gismoEvents[b]||[];
this._gismoEvents[b].push(c)
},_getEvents:function(b){return this._gismoEvents[b||"generic"]
},_flushEvents:function(b){b=b||"generic";
if(!!this._gismoEvents[b]){while(this._gismoEvents[b].length!==0){this._gismoEvents[b].shift().detach()
}}},_timer:function(c,b){b=b||"generic";
this._timers[b]=this._timers[b]||[];
this._timers[b].push(c)
}}
},"1.0",{requires:["squarespace-anims","squarespace-util"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-animations",function(e){e.namespace("Squarespace.Animations");
var d="display-status-",c="-plugged",b="shown",a="hidden";
e.Squarespace.Animations.Expandable=e.Base.create("expandable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.open);
this.doBefore("hide",this.close);
this._running=false
},close:function(k){var f=this.get("host"),j=this.get("easing"),h=this.get("duration"),g,i;
k=(f.inDoc()?k:true);
f.fire("close");
if(k){this._hardClose()
}else{if(!this._running){this._running=true;
f.wrap('<div class="expandable-plugin-wrapper"></div>');
i=f.ancestor(".expandable-plugin-wrapper");
i.setStyles({overflow:"hidden",height:f.get("offsetHeight")});
this._closeWrapper=i;
g=new e.Anim({node:i,to:{height:0},easing:j,duration:h});
g.on("end",function(){if(f.inDoc()){f.setStyles({height:0,overflow:"hidden",display:"none"});
f.unwrap();
f.addClass("expandable-hidden")
}this._running=false;
f.fire("closed")
},this);
this._closeAnim=g;
g.run()
}}return new e.Do.Prevent("Expandable prevented default hide.")
},_hardClose:function(){var f=this.get("host");
f.setStyles({height:0,overflow:"hidden",display:"none"});
f.addClass("expandable-hidden");
f.fire("closed")
},_hardOpen:function(){var f=this.get("host");
f.setStyles({height:null,display:null});
f.removeClass("expandable-hidden");
f.fire("opened")
},open:function(m){var h=this.get("host"),l=this.get("easing"),j=this.get("duration"),i,g,f,k;
m=(h.inDoc()?m:true);
h.fire("open");
if(m){this._hardOpen()
}else{if(!this._running){this._running=true;
if(h.getComputedStyle("display")==="none"){h.setStyle("display",null)
}f=h.cloneNode(true);
f.setStyles({height:"auto",visibility:"hidden",display:null,position:"absolute",width:h.get("offsetWidth")});
h.insert(f,"before");
g=f.get("offsetHeight")+parseInt(f.getComputedStyle("marginTop"),10)+parseInt(f.getComputedStyle("marginBottom"),10);
f.remove(true);
h.wrap('<div class="expandable-plugin-wrapper"></div>');
k=h.ancestor(".expandable-plugin-wrapper");
k.setStyles({overflow:"hidden",height:0});
h.setStyles({height:null,overflow:null});
this._openWrapper=k;
i=new e.Anim({node:k,to:{height:g},easing:l,duration:j});
i.on("end",function(){var n=this.get("host");
if(n){this._running=false;
n.unwrap();
n.removeClass("expandable-hidden");
n.fire("opened")
}},this);
this._openAnim=i;
i.run()
}}return new e.Do.Prevent("Expandable prevented default show.")
},destructor:function(){if(this._closeWrapper){this._closeWrapper.remove(true)
}if(this._openWrapper){this._openWrapper.remove(true)
}if(this._openAnim){this._openAnim.stop().destroy()
}if(this._closeAnim){this._closeAnim.stop().destroy()
}}},{NS:"expandablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong}}});
e.Squarespace.Animations.Fadeable=e.Base.create("fadeable",e.Plugin.Base,[],{initializer:function(f){this.beforeHostMethod("show",this.show);
this.beforeHostMethod("hide",this.hide);
this.get("host").addClass(this.name+c);
this._onlyUseOpacity=(f.onlyUseOpacity===undefined)?false:f.onlyUseOpacity;
this._running=false
},destructor:function(){if(this._anim){this._anim.stop().destroy()
}this.get("host").removeClass(this.name+c)
},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(g,h){var f=this.get("host");
h=(f.inDoc()?h:true);
if(g){f.removeClass(d+"hidden")
}if(h){this._hardChangeVisibility(g)
}else{if(this._anim){this._anim.stop().destroy();
this._anim=null
}if(g&&f.getComputedStyle("display")==="none"){f.setStyle("display",null)
}this._anim=new e.Anim({node:f,to:{opacity:(g?this.get("opacity"):0)},easing:this.get("easing"),duration:this.get("duration")});
this._anim.onceAfter("end",function(){this._hardChangeVisibility(g);
this._running=false;
if(!g&&!this._onlyUseOpacity&&f.getDOMNode()){f.setStyle("display","none")
}f.fire(g?"shown":"hidden");
delete this._anim
},this);
this._anim.run()
}return new e.Do.Prevent("Fadeable prevented default "+(g?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(g){var f=this.get("host");
if(!g){f.addClass(d+"hidden")
}f.setStyles({opacity:(g?this.get("opacity"):0)});
this._anim=null;
f.fire(g?b:a)
}},{NS:"fadeablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}});
e.Squarespace.Animations.Scalable=e.Base.create("scalable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.show);
this.doBefore("hide",this.hide);
this._running=false
},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(h,m){var n=this.get("host"),i=this.get("easing"),f=this.get("duration"),o=!!(this.get("host").getDOMNode().style.transitionDuration||e.DOM.CUSTOM_STYLES.transitionDuration);
this.fire(h?"show":"hide");
n.fire(h?"show":"hide");
if(h){n.removeClass("sqs-scalable-hidden")
}m=(n.inDoc()?m:true);
if(m){this._hardChangeVisibility(h);
if(!h){n.addClass("sqs-scalable-hidden")
}}else{if(!this._running){this._running=true;
var g=false;
var j=e.bind(function(){if(g){return
}g=true;
if(!n.getDOMNode()){return
}this._running=false;
if(!h){n.addClass("sqs-scalable-hidden")
}this.fire(h?b:a);
n.fire(h?b:a)
},this);
var l={start:h?0:1,stop:(h?1:0)*100,time:0,duration:f,effect:"easeOut"};
if(h){n.setStyle("visibility","visible");
l.onStop=e.bind(function(){if(!this.get("destroyed")){j()
}},this)
}else{l.onStop=e.bind(function(){if(!this.get("destroyed")){n.setStyle("visibility","hidden");
j()
}},this)
}var k={opacity:l};
if(o){k.transform={start:"scale("+(h?"0.94":"1")+")",stop:"scale("+(h?"1":"0.94")+")",time:0,duration:f,effect:"easeOut",onStop:e.bind(function(){if(!this.get("destroyed")){n.setStyle("transform",null)
}},this)}
}JSTween.tween(n.getDOMNode(),k);
JSTween.play()
}}return new e.Do.Prevent("Scalable prevented default "+(h?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(h){var g=this.get("host");
var f=!!(this.get("host").getDOMNode().style.transitionDuration||e.DOM.CUSTOM_STYLES.transitionDuration);
var i=this.get("duration");
if(f){g.setStyles({visibility:(h?"visible":"hidden"),opacity:(h?1:0),transform:"scale("+(h?"1":"0.94")+")"})
}else{g.setStyles({visibility:(h?"visible":"hidden"),opacity:(h?1:0)})
}g.fire(h?b:a)
}},{NS:"scalablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}});
e.Squarespace.Animations.Slideable=e.Base.create("slideable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.show);
this.doBefore("hide",this.hide);
this._running=false
},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(i,m){var n=this.get("host"),j=this.get("easing"),f=this.get("duration"),l=this.get("direction");
n.fire(i?"show":"hide");
m=(n.inDoc()?m:true);
if(m){this._hardChangeVisibility(i)
}else{var g;
if(i){n.setStyles({display:"block",visibility:"hidden"});
var k=(l=="left"?1:-1)*n.get("offsetWidth");
n.setStyles({visibility:null});
console.log("showing node (fromLeft: "+k+", toLeft: 0)");
n.anim({left:0},{from:{left:k},duration:f,easing:j}).run()
}else{if(n.activeAnim){n.activeAnim.stop(true)
}n.setStyles({display:"block",left:0});
var h=(l=="left"?-1:1)*n.get("offsetWidth");
console.log("hiding node (fromLeft: 0, toLeft: "+h+")");
n.anim({left:h},{from:{left:0},duration:f,easing:j,end:function(){n.setStyles({display:"none",left:0})
}}).run()
}}return new e.Do.Prevent("Slideable prevented default "+(i?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(g){var f=this.get("host");
f.setStyles({display:g?"block":"none"});
f.fire(g?b:a)
}},{NS:"slideablePlugin",ATTRS:{duration:{value:0.2,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}})
},"1.0",{requires:["base","plugin","anim","anim-easing","animations-css","transition","thirdparty-jstween"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-debugger",function(a){a.namespace("Squarespace");
a.Squarespace.Debugger=Class.create({defaultOpts:{output:true,ignore:[],name:"GenericComponent"},initialize:function(c){this.params=a.merge(this.defaultOpts,c);
if(a.Cookie.get("SQUARESPACE_DEBUG_"+this.params.name.toUpperCase())){this.params.output=true
}if(this.params.uid){this.params.name+=" #"+this.getUID()
}if(this.params.logEvents){var b=this;
this.params.logEvents.fire=function(d){b.log("Firing",d);
a.EventTarget.prototype.fire.apply(b.params.logEvents,arguments)
}
}this.logEnabled=this.params.output
},log:function(){if(!this.params.output){return
}if(this.params.ignore.indexOf(arguments[0])>=0){return
}var b=Array.prototype.slice.call(arguments);
b.unshift("["+this.params.name+"]");
if(console.log){if(a.UA.ios){console.log(b.join(" "))
}else{if(console.log.apply){console.log.apply(console,b)
}else{console.log(b)
}}}},error:function(){var b=Array.prototype.slice.call(arguments);
b.unshift(this.params.name);
if(a.UA.ios){b=[b.join(" ")]
}if(console.error){if(a.UA.ios){console.error(b.join(" "))
}else{if(console.error.apply){console.error.apply(console,b)
}else{console.error(b)
}}}if(console.trace){console.trace()
}},warn:function(){var b=Array.prototype.slice.call(arguments);
b.unshift("["+this.params.name+"]");
if(console.warn){if(a.UA.ios){console.warn(b.join(" "))
}else{if(console.warn.apply){console.warn.apply(console,b)
}else{console.warn(b)
}}}},getUID:function(){if(a.Squarespace.Debugger.lastUID[this.params.name]===undefined){a.Squarespace.Debugger.lastUID[this.params.name]=0
}return a.Squarespace.Debugger.lastUID[this.params.name]++
},time:function(b){if(!this.params.output){return
}if(console.time){console.time("["+this.params.name+"] "+b)
}},timeEnd:function(b){if(!this.params.output){return
}if(console.timeEnd){console.timeEnd("["+this.params.name+"] "+b)
}}});
a.Squarespace.Debugger.lastUID={}
},"1.0",{requires:["squarespace-common"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-touch-event-listener",function(a){a.Squarespace.TouchEventListener=Class.create({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,initialize:function(b,c){this.el=b;
this.captureSettings={swipe:false,move:false,preventDefaultTouchEvents:true};
this.captureSettings=a.merge(this.captureSettings,c);
this.swipeThreshold=50;
this.swipeTimeThreshold=250;
this.touchStartPoint={x:0,y:0};
this.touchEndPoint={x:0,y:0};
this.addEventHandlers()
},addEventHandlers:function(){this.touchStartHandler=a.bind(this.onTouchStart,this);
this.touchMoveHandler=a.bind(this.onTouchMove,this);
this.touchEndHandler=a.bind(this.onTouchEnd,this);
this.el.on("touchstart",this.touchStartHandler);
if(this.captureSettings.move){this.el.on("touchmove",this.touchMoveHandler)
}this.el.on("touchend",this.touchEndHandler)
},removeEventHandlers:function(){this.el.detachAll()
},getTouchPoint:function(b){return{x:b[0].pageX,y:b[0].pageY}
},fireTouchEvent:function(i){var h,c=0,b=0,j=0,f,d,g;
c=this.touchEndPoint.x-this.touchStartPoint.x;
b=this.touchEndPoint.y-this.touchStartPoint.y;
j=Math.sqrt((c*c)+(b*b));
if(this.captureSettings.swipe){d=new Date();
g=d-this.touchStartTime;
if(g<=this.swipeTimeThreshold){if(window.Math.abs(c)>=this.swipeThreshold){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,point:this.touchEndPoint,action:(c<0)?a.Squarespace.TouchEventListener.ActionTypes.swipeLeft:a.Squarespace.TouchEventListener.ActionTypes.swipeRight,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}if(window.Math.abs(b)>=this.swipeThreshold){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,point:this.touchEndPoint,action:(b<0)?a.Squarespace.TouchEventListener.ActionTypes.swipeUp:a.Squarespace.TouchEventListener.ActionTypes.swipeDown,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}}}if(j>1){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}else{a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.tapped,point:this.touchEndPoint,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}},onTouchStart:function(d){if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=b.touches;
this.touchStartTime=new Date();
this.touchStartPoint=this.getTouchPoint(c);
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d})
},onTouchMove:function(d){if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=b.touches;
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchMove,point:this.getTouchPoint(c),targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d})
},onTouchEnd:function(d){if(this.isGesture&&this.captureSettings.gesture){return
}if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=(b.changedTouches)?b.changedTouches:b.touches;
this.touchEndPoint=this.getTouchPoint(c);
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d});
this.fireTouchEvent(d)
}});
a.Squarespace.TouchEventListener.Types={onTouch:"onTouch"};
a.Squarespace.TouchEventListener.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",tapped:"tapped"}
});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-gallery-ng",function(){Y.Squarespace.Widgets.Gismo=Y.Base.create("Gismo",Y.Squarespace.Widgets.SSWidget,[Y.Squarespace.GismoBase]);
Y.Squarespace.Gallery2=Y.Base.create("Gallery",Y.Squarespace.Widgets.Gismo,[],{initializer:function(){this._debugger=new Y.Squarespace.Debugger({name:"Gallery2",output:false,uid:true});
this._images=this.get("container").all("img[data-src]");
this._imagesByMedia={};
this._slidesByMedia={};
Y.Squarespace.GalleryManager.registerGallery(this);
this.get("slides").each(function(d){if(!d.getAttribute("data-type")){d.setAttribute("data-type",d.one(".sqs-video-wrapper")?"video":"image")
}});
this._loadByItemId();
this.plug(this.get("design"),this.get("designOptions"));
this.bindUI();
this.get("container").plug(Y.Squarespace.NodeDestroyNotifier,{onDestroy:function(){this.destroy()
},context:this});
this.get("container").setData("gallery",this)
},destructor:function(){if(this._autoplayHandle){this._autoplayHandle.cancel()
}if(this._wrapperEl){this.get("slides").each(function(d){this.get("container").append(d)
},this);
this._wrapperEl.remove()
}if(this.get("lazyLoad")){Y.Squarespace.GalleryManager.removeImageQueue(this.getImages())
}this.get("container").clearData("gallery")
},bindUI:function(){this._flushEvents("refreshOnResize");
if(this.get("refreshOnResize")){if(!this.get("resizeEmitter")){this.set("resizeEmitter",new Y.Squarespace.ResizeEmitter({timeout:100}))
}this._event(this.get("resizeEmitter").on("resize:end",function(){this.refresh()
},this),"refreshOnResize")
}this._flushEvents("refreshOnOrientationChange");
if(this.get("refreshOnOrientationChange")){this._event(Y.one(window).on("orientationchange",function(){this.refresh()
},this),"refreshOnOrientationChange")
}if(this.get("keyboard")){var d=Y.bind(function(){if(this.get("inMotion")){return false
}var e=Y.Squarespace.GalleryManager.getGalleries();
for(var g=0;
g<e.length;
g++){var f=e[g].get("container");
if(f.inRegion(Y.one(Y.config.win).get("region"))&&f.get("offsetHeight")){return e[g]
}}return false
},this);
if(this.get("keys.previous")){this._event(Y.on("key",function(g){var f=d();
if(f){g.preventDefault();
f.previousSlide()
}},window,this.get("keys.previous"),this),"keyboard")
}if(this.get("keys.next")){this._event(Y.on("key",function(g){var f=d();
if(f){g.preventDefault();
f.nextSlide()
}},window,this.get("keys.next"),this),"keyboard")
}}this._bindUIAutoplay();
this.after("autoplayChange",this._bindUIAutoplay,this);
this.after("autoplayOptionsChange",this._bindUIAutoplay,this);
this._bindUIElements();
this.after("elementsChange",this._bindUIElements,this);
this.fire("bindUI")
},syncUI:function(){this.getSlides().filter("."+this.getProperty("ACTIVE_CLASS")).removeClass(this.getProperty("ACTIVE_CLASS")).each(function(e){this.setVideoState(e)
},this);
var d=this._currentSlide();
if(d){d.addClass(this.getProperty("ACTIVE_CLASS"))
}if(!this.get("loop")){if(this.get("elements.next")){if(this.get("currentIndex")>=(this.get("numberOfSlides")-1)){this.get("elements.next").addClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}else{this.get("elements.next").removeClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}}if(this.get("elements.previous")){if(this.get("currentIndex")<=0){this.get("elements.previous").addClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}else{this.get("elements.previous").removeClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}}}if(this.get("elements.currentIndex")){this.get("elements.currentIndex").setContent(this.get("currentIndex")+1)
}if(this.get("elements.totalSlides")){this.get("elements.totalSlides").setContent(this.get("numberOfSlides"))
}this.fire("syncUI")
},refresh:function(){this.syncUI();
if(this.get("lazyLoad")){this.getImages().each(function(d,e){if(d.loader&&d.get("complete")){d.fire("refresh")
}},this)
}else{this.getImages().each(function(d){d.fire("refresh")
},this)
}this.getSlides("video").each(function(d){d.one(".sqs-video-wrapper").videoloader.reload()
});
this.fire("refresh")
},refreshContentMode:function(d){this.getImages("image").each(function(e){e.loader.set("mode",d)
});
this.getSlides("video").each(function(e){e.one(".sqs-video-wrapper").videoloader.set("mode",d)
})
},plugLoaders:function(){var d={};
if(this.get("lazyLoad")){d.load="viewport";
Y.Squarespace.GalleryManager.addImageQueue(this.getImages())
}d=Y.merge(d,this.get("loaderOptions"));
this.getSlides("video").each(function(e){e.one(".sqs-video-wrapper").plug(Y.Squarespace.VideoLoader,{mode:this.get("loaderOptions.mode")})
},this);
this.getImages().plug(Y.Squarespace.Loader2,d)
},loadImages:function(d){this._event(d.on("load",function(){this.fire("image-loaded")
},this));
if(this.get("lazyLoad")){Y.Squarespace.GalleryManager.promoteImageQueue(d)
}else{d.each(function(e){e.loader.set("load",true);
e.fire("refresh")
})
}},previousSlide:function(f){if(f){f.preventDefault()
}var g=this._currentSlide();
this.setVideoState(g);
var d=this.get("currentIndex")-1;
if(d<0&&!this.get("loop")){this.fire("reachedBeginning");
return
}this.set("currentIndex",d%this.get("numberOfSlides"),{direction:-1})
},nextSlide:function(f){if(f){f.preventDefault()
}var g=this._currentSlide();
this.setVideoState(g);
var d=this.get("currentIndex")+1;
if(d>=this.get("numberOfSlides")&&!this.get("loop")){this.fire("reachedEnd");
return
}this.set("currentIndex",d%this.get("numberOfSlides"),{direction:1})
},renderWrapper:function(){if(this._wrapperEl){return
}var d=Y.Node.create('<div class="sqs-wrapper"></div>');
this.get("slides").each(function(e){d.append(e)
},this);
this._wrapperEl=d;
this.get("container").append(this._wrapperEl)
},addChild:function(d){var e=this.get("linkedGalleries");
var f=Y.bind(function(h){if(h.calledFromSync){return
}for(var g=0;
g<e.length;
g++){if(h.calledFromChild!=e[g]){e[g].set("currentIndex",this.get("currentIndex"),{calledFromSync:true})
}}},this);
if(!this._linkedGalleryBinding){this._linkedGalleryBinding=this.after("currentIndexChange",function(g){f(g)
},this)
}if(this.get("keyboard")){d.set("keyboard",false)
}d.after("currentIndexChange",function(g){if(!g.calledFromSync){this.set("currentIndex",g.newVal,{calledFromChild:d})
}},this);
e.push(d);
d.get("linkedGalleries").push(this);
d.syncUI()
},setVideoState:function(d){if(this._slideType(d)!="video"){return
}var e=d.one(".sqs-video-wrapper").videoloader;
if(e.get("overlay")){e.showOverlay()
}else{if(e.get("apiFriendly")){e.pause()
}else{if(["object","iframe"].indexOf(e.get("type"))!=-1){e.refreshVideo()
}}}},getSlides:function(d){if(d){return this._slidesByType(d)
}else{return this.get("slides")
}},getImages:function(d){if(d){return this._imagesByType(d)
}else{return this._images
}},_bindUIAutoplay:function(){var j=this.get("autoplay");
if(this._autoplayHandle){this._autoplayHandle.cancel();
this._flushEvents("autoplay")
}if(j){var e=false;
this._autoplayHandle=Y.later(this.get("autoplayOptions.timeout"),this,function(){if(!!e){return
}if(this.get("autoplayOptions.interval")){var i=Math.ceil(Math.random()*this.get("numberOfSlides"));
while(i==this.get("currentIndex")){this.set("currentIndex",i)
}}else{this.nextSlide()
}},null,true);
var h=[this.get("container"),this.get("elements.previous"),this.get("elements.next")];
if(this.get("autoplayOptions.pauseOnMouseover")){var d=this.get("autoplayOptions.pauseOnMouseover");
for(var f=0;
f<d.length;
f++){h.push(Y.one(d[f]))
}}for(var f=0;
f<h.length;
f++){var g=h[f];
if(Y.Lang.isString(g)){g=this.get(g)
}if(g){this._event(g.on(["mouseenter","mousemove"],function(){e=true
}),"autoplay");
this._event(g.on("mouseout",function(){e=false
}),"autoplay")
}}}},_bindUIElements:function(){var d=Y.bind(function(f){for(var e=0;
e<f.length;
e++){element=f[e];
this._flushEvents("controls-"+element);
if(this.get("elements."+element)){this._event(this.get("elements."+element).on("click",this[element+"Slide"],this),"controls-"+element)
}}},this);
d(["previous","next"]);
this._flushEvents("controls-controls");
if(this.get("elements.controls")){this.get("elements.controls").each(function(f){var e=f.get("children");
e.each(function(g,h){this._event(g.on("click",function(){this.set("currentIndex",h)
},this),"controls-controls")
},this);
this.after("currentIndexChange",function(g){e.filter("."+this.getProperty("ACTIVE_CLASS")).removeClass(this.getProperty("ACTIVE_CLASS"));
e.item(g.newVal).addClass(this.getProperty("ACTIVE_CLASS"))
});
e.item(this.get("currentIndex")).addClass(this.getProperty("ACTIVE_CLASS"))
},this);
if(this.getSlides().size()<=1){this.get("elements.controls").addClass("sqs-gallery-controls-disabled")
}}},_loadByItemId:function(){this._history=new Y.HistoryHash();
if(this.get("historyHash")){this.on("currentIndexChange",function(f){this._history.replaceValue(this.get("historyHash"),f.newVal)
},this)
}if(this.get("historyHash")||this._history.get("itemId")){var e=this._history.get("itemId")||this._history.get(this.get("historyHash"));
var d;
if(e){this.get("slides").each(function(f,g){if(f.getAttribute("data-slide-id")==e){d=g
}})
}if(!Y.Lang.isNumber(d)){d=parseInt(this._history.get(this.get("historyHash")),10)
}if(!!this._history.get("itemId")){this._history.replaceValue("itemId",null)
}if(Y.Lang.isNumber(d)){this.set("currentIndex",d)
}}},_currentSlide:function(){return this.get("slides").item(this.get("currentIndex"))
},_slidesByType:function(d){if(!this._slidesByMedia[d]){this._slidesByMedia[d]=this.get("slides").filter('[data-type="'+d+'"]')
}return this._slidesByMedia[d]
},_imagesByType:function(d){if(!this._imagesByMedia[d]){this._imagesByMedia[d]=new Y.NodeList();
this._slidesByType(d).each(function(e){var f=e.test("img")?e:e.one("img[data-src]");
if(f){this._imagesByMedia[d].push(f)
}},this)
}return this._imagesByMedia[d]
},_slideType:function(d){if(d.getAttribute("data-type")=="image"){return"image"
}else{if(d.getAttribute("data-type")=="video"){return"video"
}else{return"image"
}}},_getContainer:function(d){if(Y.Lang.isString(d)){d=Y.one(d)
}return d
},_cleanCurrentIndex:function(d){if(d<0){d=this.get("numberOfSlides")+d
}return d%this.get("numberOfSlides")
},_getDesign:function(e){var d=a[e];
if(!d){throw Error("These aren't the gallery designs you're looking for. (We couldn't find a design by the name '"+e+"')")
}return d
},_getElements:function(e){for(var d in e){if(!(e[d] instanceof Y.NodeList)){e[d]=Y.all(e[d])
}}return e
},_setElements:function(d,e){this._bindUIElements()
},_setLoaderOptions:function(d){if(d.hasOwnProperty("fit")&&d.fit){d.mode="fit"
}else{if(d.hasOwnProperty("fill")&&d.fill){d.mode="fill"
}}return d
},_getNumberOfSlides:function(){return this.get("slides").size()
},_getSlides:function(e){var d=this._wrapperEl||this.get("container");
if(!e){e=d.get("children")
}if(Y.Lang.isString(e)){e=d.all(e)
}return e
},_getWrapper:function(d){if(Y.Lang.isString(d)){d=Y.one(d)
}return d
},_validateCurrentIndex:function(d){if(this.get("inMotion")){return false
}else{for(var e=0;
e<this.get("linkedGalleries").length;
e++){var f=this.get("linkedGalleries")[e];
if(f.get("inMotion")&&d!=f.get("currentIndex")){return false
}}return true
}}},{NS:"gallery",ACTIVE_CLASS:"sqs-active-slide",DISABLED_PAGINATION_CLASS:"sqs-disabled",ATTRS:{autoplay:{value:false},autoplayOptions:{value:{randomize:true,timeout:5000,pauseOnMouseover:[]}},container:{getter:"_getContainer"},currentIndex:{value:0,getter:"_cleanCurrentIndex",setter:"_cleanCurrentIndex",validator:"_validateCurrentIndex"},design:{value:"base",getter:"_getDesign"},designOptions:{value:{}},elements:{value:{next:null,previous:null,currentIndex:null,totalSlides:null,controls:null},getter:"_getElements",setter:"_setElements",lazyAdd:false},historyHash:{},inMotion:{value:false},keyboard:{value:true},keys:{value:{previous:"down:37",next:"down:39"}},lazyLoad:{value:false},linkedGalleries:{value:[]},loaderOptions:{value:{},setter:"_setLoaderOptions"},loop:{value:false},numberOfSlides:{getter:"_getNumberOfSlides"},refreshOnResize:{value:false},refreshOnOrientationChange:{value:false},resizeEmitter:{value:null},slides:{getter:"_getSlides"}}});
var c={};
c.ByViewport=Y.Base.create("GalleryLoadingBehavior",Y.Base,[],{scrollHandler:null,scrollEl:null,scrollRegion:null,imageRegions:null,initializer:function(){if(this.get("host").get("lazyLoad")){this.scrollHandler=this._getScrollEl().on("scroll",this._viewportLoad,this)
}},destructor:function(){if(this.scrollHandler){this.scrollHandler.detach()
}},_getScrollEl:function(){if(!this.scrollEl){this.scrollEl=this.get("host").get("container").ancestor(function(d){return(d.getStyle("overflowY").match(/scroll|auto/)&&d.get("scrollHeight")>d.get("clientHeight"))
});
if(!this.scrollEl||this.scrollEl.test("html,body")){this.scrollEl=Y.one(Y.config.win)
}}return this.scrollEl
},loadItems:function(){var e=this.get("host");
var d=e.getImages();
if(e.get("lazyLoad")){this.imageRegions=[];
this.scrollRegion=this._getScrollEl().get("region");
d.each(function(f){this.imageRegions.push(f.get("region"))
},this);
this._viewportLoad()
}else{e.loadImages(d)
}},_viewportLoad:function(){var d=this._getScrollEl().get("scrollTop");
var e=d+this.scrollRegion.height;
var f=new Y.NodeList();
this.get("host").getImages().each(function(g,h){var j=this.imageRegions[h];
if((j.top>=d&&j.top<=e)||(j.bottom>=d&&j.bottom<=e)){f.push(g)
}},this);
this.get("host").loadImages(f)
}});
c.ByCurrentIndex=Y.Base.create("GalleryLoadingBehavior",Y.Base,[],{loadItems:function(){var e=this.get("host"),d=e.getImages();
if(e.get("lazyLoad")){var h=e.get("currentIndex")-this.get("preloadCount"),g=e.get("currentIndex")+this.get("preloadCount"),f=new Y.NodeList();
if(e.get("loop")){g=g%e.get("slides").size()
}else{h=Math.max(0,h);
g=Math.min(e.get("slides").size()-1,g)
}if(h>=0&&h<=g){f=d.slice(h,g+1)
}else{f=f.concat(d.slice(h));
f=f.concat(d.slice(0,g+1))
}e.loadImages(f)
}else{e.loadImages(d)
}}});
var a={};
a.base=Y.Base.create("GalleryDesignBase",Y.Plugin.Base,[Y.Squarespace.GismoBase,c.ByViewport],{initializer:function(){this.get("host").after("currentIndexChange",function(){this.get("host").syncUI()
},this);
this.get("host").plugLoaders();
this.loadItems();
this.get("host").syncUI()
},destructor:function(){},_getProperty:function(d){return this.constructor[d]
}},{NS:"gallery-design",ATTRS:{}});
a.stacked=Y.Base.create("GalleryDesignStacked",Y.Plugin.Base,[Y.Squarespace.GismoBase,c.ByCurrentIndex],{initializer:function(){var e=this.get("host");
e.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
e.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
this.plug(this.get("transition"),this.get("transitionOptions"));
e.after("currentIndexChange",this.syncUI,this);
e.after("refresh",this.syncUI,this);
e.get("slides").each(function(g,h){var f=g.test("img")?g:g.one("img");
if(f){f.onceAfter("loaded",function(){g.addClass("loaded")
},this)
}else{g.addClass("loaded")
}},this);
e.plugLoaders();
if(this.get("autoHeight")){var d=Y.bind(function(){this.containerHeight=this._calculateContainerHeight();
this.get("host").get("container").setStyles({height:this.containerHeight})
},this);
d();
this._event((new Y.Squarespace.ResizeEmitter({timeout:100})).on("resize",d))
}e.refresh();
this.bindUI();
this.syncUI()
},destructor:function(){if(this.get("autoHeight")){this.get("host").get("container").setStyles({height:null})
}this.get("host").get("slides").each(function(d){d.setStyles({opacity:null});
d.removeClass(this._getProperty("SLIDE_CLASS"))
},this)
},bindUI:function(){if(this.get("clickBehavior")){this._event(this.get("host").get("container").on("click",function(h){if(h.target.ancestor("a",true)){return
}var d=h.target.ancestor(".slide");
if(d&&!!d.getAttribute("data-click-through-url")){window.location.href=d.getAttribute("data-click-through-url");
h.preventDefault();
return
}if(this.get("host")._slideType(this.get("host")._currentSlide())!="video"){switch(this.get("clickBehavior")){case"next":this.get("host").nextSlide();
break;
case"previous":this.get("host").previousSlide();
break;
default:var g=this.get("host").get("container").get("region");
var f=(g.width/2)+g.left;
if(h.pageX>f){this.get("host").nextSlide()
}else{this.get("host").previousSlide()
}break
}}h.preventDefault()
},this))
}},syncUI:function(d){this.get("host").syncUI();
this.fire("transition",d||{newVal:this.get("host").get("currentIndex")});
this.loadItems();
this._positionMetaOverlay()
},_positionMetaOverlay:function(){if(!Y.Lang.isNumber(this.get("host").get("currentIndex"))){return
}var d=this.get("host").get("slides").item(this.get("host").get("currentIndex"));
var g=d.one(".meta");
var i=d.one("img");
var e=this.get("host").get("container");
if(!i){i=d
}var h=i.ancestor(".sqs-video-wrapper",true);
if(h){i=h;
h.videoloader.on("showingVideoChange",function(j){d[j.newVal?"addClass":"removeClass"]("video-playing")
})
}if(g){var f=e.getAncestorData("galleryOptions");
if(f){switch(f["meta-position"]||"bottom"){case"top":case"bottom":g.setStyles({left:i.get("offsetLeft"),width:i.get("offsetWidth")});
break;
case"top-left":case"bottom-left":g.setStyles({left:i.get("offsetLeft"),maxWidth:i.get("offsetWidth")/2});
break;
case"top-right":case"bottom-right":g.setStyles({right:d.get("offsetWidth")-(i.get("offsetLeft")+i.get("offsetWidth")),maxWidth:i.get("offsetWidth")/2});
break;
case"center":g.setStyles({maxWidth:i.get("offsetWidth")/2});
g.setStyles({marginLeft:g.get("offsetWidth")/-2,marginTop:g.get("offsetHeight")/-2});
break
}}if(g.get("offsetHeight")/e.get("offsetHeight")>0.9){g.setStyles({height:e.get("offsetHeight")*0.4}).addClass("overflow")
}}},_calculateContainerHeight:function(){var e=[];
var d=this.get("host").get("container").get("offsetHeight");
this.get("host").get("slides").each(function(f){switch(this.get("host")._slideType(f)){case"image":var j=f.test("img")?f:f.one("img");
if(j){var g=Y.Squarespace.Rendering.getDimensionsFromNode(j);
var i=Y.Squarespace.Rendering.getHeightForWidth(g.width,g.height,f.get("offsetWidth"));
if(!isNaN(i)){e.push(i)
}}else{this.get("host")._debugger.log("_calculateContainerHeight","Couldnt evaluate height for slide.")
}break;
case"video":var h=Y.Squarespace.Rendering.getHeightForWidth(f.one(".sqs-video-wrapper").videoloader.getWidth(),f.one(".sqs-video-wrapper").videoloader.getHeight(),f.get("offsetWidth"));
if(!isNaN(h)){e.push(h)
}break
}},this);
if(e.length>0){d=Math.min.apply(Math.min,e)
}return d
},_getProperty:function(d){return this.constructor[d]
},_getTransition:function(d){d=b[d];
if(!d){throw Error("These aren't the gallery stacked transitions you're looking for. (We couldn't find a transition by the name "+d+" )")
}return d
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-stacked",SLIDE_CLASS:"sqs-gallery-design-stacked-slide",ATTRS:{autoHeight:{value:true},clickBehavior:{value:"next"},easing:{value:Y.Easing.easeOutStrong},speed:{value:0.3},preloadCount:{value:1},transition:{value:"fade",getter:"_getTransition"},transitionOptions:{value:{}}}});
a.strip=Y.Base.create("GalleryDesignBase",Y.Plugin.Base,[Y.Squarespace.GismoBase,c.ByCurrentIndex],{initializer:function(){var e=this.get("host");
e.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
e.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
this._event(e.on("image-loaded",this._syncUIRefreshWrapperWidth,this));
e.plugLoaders();
var d=e.get("container").get("offsetHeight");
e._slidesByType("video").each(function(f){var g=f.one(".sqs-video-wrapper").videoloader.getWidth()/f.one(".sqs-video-wrapper").videoloader.getHeight();
f.one(".sqs-video-wrapper").setStyle("paddingRight",g*d);
if(f.one("img")){f.one("img").refresh()
}});
e.renderWrapper();
e.after("currentIndexChange",this.syncUI,this);
this.loadItems();
this.syncUI();
this.bindUI()
},destructor:function(){this.get("host").get("container").removeClass(this._getProperty("CONTAINER_CLASS"));
this.get("host").get("slides").removeClass(this._getProperty("SLIDE_CLASS"))
},bindUI:function(){var e=this.get("host")._currentSlide();
this.get("host").get("slides").each(function(f,h){var g=this.get("host")._slideType(f);
if(g=="video"&&f!=e){f.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}this._event(f.on("click",function(m){if(g=="video"&&!f.one(".sqs-video-wrapper").videoloader.get("inactive")){return
}var k=m.target.getAttribute("data-click-through-url");
if(!!k){window.location.href=k
}var n=this.get("host")._currentSlide();
var l=this.get("host")._slideType(n);
if(h==this.get("host").get("currentIndex")){switch(this.get("activeSlideClickBehavior")){case"next":this.get("host").nextSlide();
break;
case"previous":this.get("host").previousSlide();
break;
default:this.get("host").set("currentIndex",h);
break
}}else{this.get("host").set("currentIndex",h)
}var j=this.get("host")._currentSlide();
var i=this.get("host")._slideType(j);
if(n!=j){if(i=="video"){j.one(".sqs-video-wrapper").videoloader.set("inactive",false);
if(j==f){j.one(".sqs-video-wrapper").videoloader.showVideo()
}}if(l=="video"){n.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}}},this))
},this);
this.get("host").on("currentIndexChange",function(i){var g=this.get("host").get("slides");
if(i.newVal<0){i.newVal=g.size()-1
}var f=g.item(i.prevVal);
var h=g.item(i.newVal);
if(this.get("host")._slideType(f)=="video"){f.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}if(this.get("host")._slideType(h)=="video"){h.one(".sqs-video-wrapper").videoloader.set("inactive",false)
}},this);
var d=this.get("host").get("slides").item(this.get("currentIndex")||0);
if(d){d.addClass(this._getProperty("SLIDE_CLASS"))
}},syncUI:function(d){if(!d||!d.calledFromParent){this.get("host").syncUI()
}this._syncUIRefreshWrapperWidth();
this.loadItems()
},_syncUIRefreshWrapperWidth:function(){if(this.get("host").get("container").hasClass("sqs.gallery-thumbnails")){var i=this.get("host").get("container");
var j=i.get("offsetHeight");
i.all(".sqs-video-thumbnail").each(function(l){if(l.hasClass("no-image")){l.one(".sqs-video-thumbnail-inner").setStyles({width:Math.floor(j*(16/9))+"px"})
}var m=l.one("img");
if(m){l.removeClass("loading");
l.setAttribute("style","width: "+m.get("offsetWidth")+"px !important")
}})
}var f=this.get("host")._wrapperEl;
f.setStyles({width:null});
var e=0;
var g=0;
this.get("host").get("slides").each(function(l,m){if(this.get("host").get("currentIndex")>m){g+=l.get("offsetWidth")
}e+=l.get("offsetWidth")
},this);
var h=this.get("host").get("container").get("offsetWidth");
var k=this.get("host")._currentSlide();
switch(this.get("alignment")){case"start":break;
case"middle":g-=(h-k.get("offsetWidth"))/2;
if(g<0){g=0
}break;
case"end":g-=(h-k.get("offsetWidth"));
if(g<0){g=0
}break
}if(e<h){g=(h-e)/-2
}else{if(g>(e-h)){g=(e-h)
}}f.setStyles({width:e*2});
var d=this;
this._anim(f,{left:-1*g},{duration:this.get("speed"),easing:this.get("easing"),start:function(){d.get("host").set("inMotion",true)
},end:function(){d.get("host").set("inMotion",false)
}}).run()
},_getProperty:function(d){return this.constructor[d]
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-strip",SLIDE_CLASS:"sqs-gallery-design-strip-slide",ATTRS:{speed:{value:0.3},easing:{value:Y.Easing.easeOutStrong},activeSlideClickBehavior:{value:"next"},preloadCount:{value:1},alignment:{value:"middle",validator:function(d){return["start","middle","end"].indexOf(d)!=-1
}}}});
a.grid=Y.Base.create("GalleryDesignGrid",Y.Plugin.Base,[Y.Squarespace.GismoBase,c.ByViewport],{initializer:function(){var d=this.get("host");
d.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
d.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
d.getImages("image").each(function(e){e.setStyles({opacity:0});
this._event(e.once("load",function(){this._timer(Y.later(Math.random()*500,this,function(){var g=this._anim(e,{opacity:1},{duration:1});
if(!this.get("destroyed")&&g.get("node").inDoc()){var f=Y.DOM.viewportRegion();
if(g.get("node").inRegion(f)){g.run()
}else{e.setStyles({opacity:null})
}}}))
},this))
},this);
d.getSlides("video").each(function(e){e.all(".sqs-video-wrapper").each(function(f){f.setStyles({opacity:0});
var g=this._anim(f,{opacity:1},{duration:1});
this._timer(Y.later(Math.random()*500,this,function(){g.run()
}))
},this)
},this);
d.plugLoaders();
this.loadItems();
d.getSlides("video").each(function(g){var e=g.one(".sqs-video-wrapper");
var f=e.videoloader;
if(this.get("lightbox")){f.set("inactive",true)
}if(g.one(".content-fit")){f.set("mode","fit")
}else{f.set("mode","fill")
}},this);
this.bindUI()
},destructor:function(){this.get("host").get("container").removeClass(this._getProperty("CONTAINER_CLASS"));
this.get("host").get("slides").removeClass(this._getProperty("SLIDE_CLASS"))
},bindUI:function(){if(!this.get("lightbox")){return
}this.get("host").getSlides("video").each(function(f){var e=f.one(".sqs-video-wrapper").videoloader.get("overlay");
if(e){e.detach("click")
}});
var d=[];
this.get("host").get("slides").each(function(e,i){if(this.get("host")._slideType(e)=="video"){d.push({content:e.one(".sqs-video-wrapper")})
}else{if(!e.hasAttribute("data-title")&&!e.hasAttribute("data-description")){var f=e.one("[data-title],[data-description]");
if(f){e=f
}}var h=e.getAttribute("data-title");
var g=e.getAttribute("data-description");
d.push({content:e.one("img"),meta:(h?"<h1>"+h+"</h1>":"")+(g?g:"")})
}},this);
this.get("host").get("slides").on("click",function(f){f.halt();
var g=f.target.ancestor("."+this._getProperty("SLIDE_CLASS"));
if(!g){return
}if(this.lightbox){this.lightbox.destroy();
delete this.lightbox
}this.lightbox=new Y.Squarespace.Lightbox2({controls:{previous:true,next:true},set:d,currentSetIndex:this.get("host").get("slides").indexOf(f.target.ancestor("."+this._getProperty("SLIDE_CLASS",true)))});
this.lightbox.render()
},this)
},_getProperty:function(d){return this.constructor[d]
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-grid",SLIDE_CLASS:"sqs-gallery-design-grid-slide",ATTRS:{lightbox:{value:true},perRow:{value:4}}});
a.autocolumns=Y.Base.create("GalleryDesignAutocolumns",Y.Plugin.Base,[Y.Squarespace.GismoBase,c.ByViewport],{dimensions:null,initializer:function(){this.host=this.get("host");
this.host.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
this.host.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
this.host.after("refresh",this.syncUI,this);
this._event((new Y.Squarespace.ResizeEmitter({timeout:100})).on("resize",this.syncUI,this));
this.host.after(["columnWidthChange","columnWidthBehaviorChange","aspectRatioChange","gutterChange","mixedContentChange"],function(d){this.set(d.attrName,d.newVal);
if(d.attrName=="aspectRatio"){this._evaluateBricks()
}this.syncUI()
},this);
this.host.plugLoaders();
this._evaluateBricks();
this.syncUI()
},destructor:function(){this.get("host").get("container").removeClass(this._getProperty("CONTAINER_CLASS"));
this.get("host").get("slides").removeClass(this._getProperty("SLIDE_CLASS"));
this._flushEvents()
},syncUI:function(){var k=this.host.get("container").get("offsetWidth"),l=this.get("aspectRatio"),g=this.get("gutter");
var m=Math[this.get("columnWidthBehavior")=="min"?"floor":"ceil"](Math.max(k/this.get("columnWidth"),1));
var d=this.get("gutter")*(m-1);
var e=(k-d)/m,f=Math.floor(e);
var j=[];
for(var h=0;
h<m;
h++){j[h]=0
}this.host.get("slides").each(function(o,n){var t=n%m;
if(!l){t=j.indexOf(Math.min.apply(Math,j))
}var r=f*t;
if(t!==0){r+=g*t
}var q,p=f;
if(t===m-1&&f!==e){p=k-r
}if(l){q=f/l
}else{q=this._getBrickHeight(o,n,p)
}var s={top:j[t]+"px",left:r+"px",width:p+"px",height:q+"px"};
o.setStyles(s);
q+=g;
j[t]+=q
},this);
this.host.get("container").setStyle("height",Math.max.apply(Math,j)-g+"px");
Y.later(1,this,this.loadItems)
},_getBrickHeight:function(e,d,f){if(this._hasValidDimensions(this.dimensions[d])){return Math.floor(Y.Squarespace.Rendering.getHeightForWidth(this.dimensions[d].width,this.dimensions[d].height,f))
}else{e.setStyles({width:f+"px",height:null});
e.all("img").each(function(g){ImageLoader.load(g,{load:"viewport"})
});
return e.get("offsetHeight")
}},_hasValidDimensions:function(d){return d&&d.width&&d.height?true:false
},_evaluateBricks:function(){this.dimensions=[];
this.host.getSlides().each(function(d){var e=d.one("img[data-image-dimensions]");
e&&e.loader.set("mode",this.get("aspectRatio")?"fill":"none");
if(e&&!this.get("mixedContent")){this.dimensions.push(Y.Squarespace.Rendering.getDimensionsFromNode(e))
}else{this.dimensions.push(null)
}},this)
},_getProperty:function(d){return this.constructor[d]
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-autocolumns",SLIDE_CLASS:"sqs-gallery-design-autocolumns-slide",ATTRS:{columnWidthBehavior:{value:"min"},columnWidth:{value:250},gutter:{value:0},aspectRatio:{value:0},mixedContent:{value:false},slideCompare:{value:true}}});
var b={};
b.base=Y.Base.create("GalleryDesignStackedTransition",Y.Plugin.Base,[Y.Squarespace.GismoBase],{baseZIndex:888,initializer:function(){this.get("host").get("host").get("slides").setStyles({opacity:0,zIndex:this.baseZIndex});
if(Y.UA.ie){this.get("host").get("host").get("slides").setStyles({visibility:"hidden"})
}this.get("host").on("transition",this.transition,this)
},_getProperty:function(d){return this.constructor[d]
}},{NS:"gallery-stacked-transition"});
b.fade=Y.Base.create("GalleryDesignStackedTransition",b.base,[],{transition:function(h){this.get("host").get("host").set("inMotion",true);
var f=h.newVal||this.get("host").get("host").get("currentIndex"),g=h.prevVal;
if(Y.Lang.isNumber(f)){var i=this.get("host").get("host").getSlides().item(f);
if(i){i.setStyles({visibility:null,zIndex:(this.baseZIndex+1)});
this._anim(i,{opacity:1},{duration:this.get("host").get("speed"),easing:this.get("host").get("easing"),end:Y.bind(function(){this.get("host").get("host").set("inMotion",false)
},this)}).run()
}}if(Y.Lang.isNumber(g)){var d=this.get("host").get("host").getSlides().item(g);
if(d){this._anim(d,{opacity:0},{duration:this.get("host").get("speed"),end:Y.bind(function(){d.setStyles({visibility:"hidden",zIndex:null});
this.get("host").get("host").set("inMotion",false)
},this)}).run()
}}}},{NS:"gallery-stacked-transition"});
b.swipe=Y.Base.create("GalleryDesignStackedTransition",b.base,[],{initializer:function(){this.galleryHost=this.get("host").get("host");
this.container=this.galleryHost.get("container");
this.slides=this.galleryHost.get("slides");
this.container.addClass(this._getProperty("CONTAINER_CLASS"));
this.container.get("parentNode").addClass(this._getProperty("WRAPPER_CLASS"));
this.slides.setStyles({opacity:null,visibility:null});
this.bindUI();
this.syncUI();
this._event((new Y.Squarespace.ResizeEmitter({timeout:100})).on("resize",function(){this.syncUI()
},this))
},bindUI:function(){var f,e,g=this.container.get("parentNode").width()/2.25,d=250;
this.container.on("touchstart",function(h){e=false;
f=(new Date()).getTime()
});
this.container.on("touchmove",function(h){e=true
});
this.container.on("touchend",function(l){var m=this.container.get("parentNode").get("scrollLeft"),j=this.galleryHost.get("currentIndex"),k=this._getSlidePosition(j),h=Math.abs(k-m),i=((new Date()).getTime()-f)>250?true:false;
if(i===true){if(h>g){m>k?j++:j--
}}else{if(i===false&&e===false){j++
}else{if(e===true&&h>0){m>k?j++:j--
}}}this._adjustPosition(j)
},this)
},syncUI:function(){this.containerWidth=this.container.get("parentNode").width();
this.container.setStyle("width",this.slides.size()*this.containerWidth+"px");
this.slides.setStyle("width",this.containerWidth+"px");
this._adjustPosition()
},transition:function(d){if(this.galleryHost.get("inMotion")||this.slides.size()==0){return
}this._adjustPosition()
},_getSlidePosition:function(d){return this.containerWidth*d
},_adjustPosition:function(e){e=Y.Lang.isUndefined(e)?this.galleryHost.get("currentIndex"):e;
var f=this.container.get("parentNode").get("scrollLeft"),d=this._getSlidePosition(e);
if(f==d){return
}this.galleryHost.set("inMotion",true);
new Y.Anim({node:this.container.get("parentNode"),to:{scrollLeft:d},duration:0.28,easing:Y.Easing.easeOut}).run().on("end",function(){this.galleryHost.set("inMotion",false);
this.galleryHost.set("currentIndex",e)
},this)
},destructor:function(){this.container.removeClass(this._getProperty("CONTAINER_CLASS"));
this._flushEvents()
}},{NS:"gallery-stacked-transition",CONTAINER_CLASS:"sqs-gallery-design-stacked-swipe",WRAPPER_CLASS:"sqs-gallery-design-stacked-swipe-wrapper",ATTRS:{}});
b.scroll=Y.Base.create("GalleryDesignStackedTransition",b.base,[],{initializer:function(){this.galleryHost=this.get("host").get("host");
this.container=this.galleryHost.get("container");
this.slides=this.galleryHost.get("slides");
this.containerWidth=this.container.get("parentNode").width();
this.container.addClass(this._getProperty("CONTAINER_CLASS"));
this.slides.setStyles({opacity:1,visibility:"visible"});
this.container.setStyle("width",this.slides.size()*this.containerWidth+"px");
this.slides.setStyle("width",this.containerWidth+"px");
this._adjustPosition(this._getCurrentSlidePosition());
this._event((new Y.Squarespace.ResizeEmitter({timeout:100})).on("resize",function(){this.containerWidth=this.container.get("parentNode").width();
this.container.setStyle("width",this.slides.size()*this.containerWidth+"px");
this.slides.setStyle("width",this.containerWidth+"px");
this._adjustPosition(this._getCurrentSlidePosition())
},this));
if(Modernizr&&Modernizr.touch){this.touchListener=null,this.touchStartPoint=null,this.touchListener=new Y.Squarespace.TouchEventListener(this.container,{move:true,swipe:true,preventDefaultTouchEvents:false});
Y.on("squarespace:ontouch",function(d){this._onTouch(d)
},this)
}},destructor:function(){this.container.removeClass(this._getProperty("CONTAINER_CLASS"));
if(this.touchListener){this.touchListener.removeEventHandlers()
}this._flushEvents()
},transition:function(d){if(this.galleryHost.get("inMotion")||this.slides.size()==0){return
}this._adjustPosition(this._getCurrentSlidePosition(),true);
return
},_getOffsetAttribute:function(){return this.get("direction")=="horizontal"?"offsetWidth":"offsetWidth"
},_getContainerDim:function(){return this.get("host").get("host").get("container").get(this._getOffsetAttribute())
},_getDirection:function(e,d){if(e<d){return 1
}else{return -1
}},_getCurrentSlidePosition:function(){return -1*this.containerWidth*this.galleryHost.get("currentIndex")
},_onTouch:function(f){var d=this.get("host").get("host").get("container"),e=f.targetEl;
if(e.getAttribute("href")){this._handleAnchors(e)
}else{if(f.touchEvent.touches.length>1||this.touchZoom){this.get("zooming")&&this._handlePanning(f)
}else{if(d.contains(e)&&!e.ancestor(".image-detail-wrapper, .sqs-video-wrapper")){switch(f.action){case Y.Squarespace.TouchEventListener.ActionTypes.swipeUp:Y.fire("transition:scroll:swipeup",{container:d});
break;
case Y.Squarespace.TouchEventListener.ActionTypes.swipeDown:Y.fire("transition:scroll:swipedown",{container:d});
break;
case Y.Squarespace.TouchEventListener.ActionTypes.tapped:Y.fire("transition:scroll:tapped",f);
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchStart:this.touchStartPoint=f.point;
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchMove:this._scrollByDistance(f.point);
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchEnd:this._finishScroll(f.point);
break
}}}}if(!e.ancestor(".image-detail-wrapper, .sqs-video-wrapper")){f.touchEvent.preventDefault()
}},_handleAnchors:function(d){if(d.getAttribute("target").match(/_blank/)){window.open(d.getAttribute("href"))
}else{window.location.href=d.getAttribute("href")
}},_handlePanning:function(h){if(!h.targetEl.get("tagName").match(/img/i)){return
}if(h.touchEvent.touches.length>1){this.prevScale=this.prevScale||1;
this.touchScale=this.prevScale*h.touchEvent.scale;
if(this.touchScale>=1){this.touchZoom=true;
h.targetEl.setStyles({webkitTransform:"scale3d("+this.touchScale+","+this.touchScale+",1)"});
var g=h.targetEl.getAttribute("src").split("?format=");
if(g.length>1){h.targetEl.setAttribute("src",g[0])
}}else{this.touchZoom=false;
this.touchStartPoint=null;
h.targetEl.setStyles({webkitTransform:"scale3d(1,1,1)",left:null,top:null});
ImageLoader.load(h.targetEl,{load:true})
}}else{if(h.action==Y.Squarespace.TouchEventListener.ActionTypes.tapped){Y.fire("transition:scroll:tapped",h)
}else{if(this.touchZoom&&h.action==Y.Squarespace.TouchEventListener.ActionTypes.touchStart){this.touchStartPoint=h.point;
h.targetEl.setAttribute("original-left",h.targetEl.getStyle("left"));
h.targetEl.setAttribute("original-top",h.targetEl.getStyle("top"))
}else{if(h.action==Y.Squarespace.TouchEventListener.ActionTypes.touchMove){var i=h.targetEl,e=this.touchStartPoint.x-h.point.x,d=this.touchStartPoint.y-h.point.y,j=parseInt(i.getAttribute("original-left"),10),f=parseInt(i.getAttribute("original-top"),10);
i.setStyles({left:j-e+"px",top:f-d+"px"})
}else{if(h.action==Y.Squarespace.TouchEventListener.ActionTypes.touchEnd){this.prevScale=this.touchScale||1
}}}}}},_scrollByDistance:function(f){if(!this.touchStartPoint||this.slides.size()<2){return
}var e=this.get("host").get("host"),g=e.get("slides"),d=e.get("currentIndex"),i=0,h={},j={opacity:1};
if(this.get("direction")=="vertical"){i=this.touchStartPoint.y-f.y
}else{i=this.touchStartPoint.x-f.x
}if(i>0&&d+1>=g.size()){e.fire("reachedEnd");
this.touchStartPoint=null;
return
}else{if(i<0&&d-1<0){e.fire("reachedBeginning");
this.touchStartPoint=null;
return
}}this._adjustPosition(this._getCurrentSlidePosition()-i)
},_finishScroll:function(f){if(!this.touchStartPoint||this.slides.size()<2){return
}var e=this.galleryHost,g=0,d=e.get("currentIndex");
if(this.get("direction")=="vertical"){g=this.touchStartPoint.y-f.y
}else{g=this.touchStartPoint.x-f.x
}d=g>=0?d+1:d-1;
if(d<0){e.fire("reachedBeginning");
this.touchStartPoint=null;
return
}else{if(d>=e.get("slides").size()){e.fire("reachedEnd");
this.touchStartPoint=null;
return
}}this._adjustPosition(-1*this.containerWidth*d,true,0.4);
e.set("inMotion",false);
e.set("currentIndex",d,{direction:(g>0?1:-1)})
},_adjustPosition:function(e,i,f){var d={},g=this.get("direction"),h=this.get("accelerate");
if(h){d.transform=g=="vertical"?"translate3d(0,"+e+"px,0)":"translate3d("+e+"px,0,0)"
}else{d[g=="vertical"?"top":"left"]=e+"px"
}if(i){if(h){this.container.transition({duration:f||this.get("host").get("speed"),transform:d.transform,easing:f?Y.Easing.easeInStrong:this.get("host").get("easing")})
}else{this.galleryHost.set("inMotion",true);
this._anim(this.container,d,{duration:f||this.get("host").get("speed"),easing:f?Y.Easing.easeInStrong:this.get("host").get("easing")}).run().on("end",function(){this.galleryHost.set("inMotion",false)
},this)
}}else{this.container.setStyles(d)
}}},{NS:"gallery-stacked-transition",CONTAINER_CLASS:"sqs-gallery-design-stacked-scrollHorz",ATTRS:{direction:{value:"horizontal"},zooming:{value:true},accelerate:{value:false}}});
Y.Squarespace.Lightbox2Overlay=Y.Base.create("LightboxOverlay",Y.Squarespace.Widgets.Gismo,[],{renderUI:function(){this._overlayEl=Y.Node.create('<div class="sqs-lightbox-overlay sqs-lightbox-overlay-'+this.get("overlayStyle")+'"></div>');
this.get("contentBox").appendChild(this._overlayEl);
this.get("contentBox").plug(Y.Squarespace.ScrollLock);
this.show()
},show:function(){this._overlayEl.setStyles({zIndex:"10000000"});
var d=this._anim(this._overlayEl,{opacity:this.get("opacity")},{duration:this.get("speed")});
d.on("end",function(){this.fire("shown")
},this);
d.run()
},overlayHideAndDestroy:function(){this.once("hidden",this.destroy,this);
this._hide()
},_hide:function(){this.fire("hide");
var d=this._anim(this._overlayEl,{opacity:0},{duration:this.get("speed")});
d.on("end",function(){this.fire("hidden")
},this);
if(this.get("destroyed")){this.fire("hidden")
}else{d.run()
}},_getContainer:function(){return this._overlayEl
}},{NS:"overlay",ATTRS:{opacity:{value:0.95},overlayStyle:{value:"default"},container:{getter:"_getContainer"},speed:{value:0.3}}});
Y.Squarespace.Lightbox2=Y.Base.create("Lightbox2",Y.Squarespace.Widgets.Gismo,[],{initializer:function(){window.ACTIVE_LIGHTBOX=this;
this._overlay=new Y.Squarespace.Lightbox2Overlay();
this._overlay.on("hide",this.hideAndDestroy,this);
this.bMobile=Y.Squarespace.GalleryManager.isMobile();
this.resizeEmitter=new Y.Squarespace.ResizeEmitter({timeout:100})
},destructor:function(){this._flushEvents();
this._slideshow&&this._slideshow.destroy();
this._overlay.destroy()
},renderUI:function(){Y.Squarespace.Lightbox2.superclass.renderUI.call(this);
Y.one("body").addClass("sqs-lightbox-open");
var d=this.get("contentBox");
this._overlay.render(d);
if(this.get("set").length>0){if(!this.bMobile&&this.get("controls.previous")){this._previousEl=Y.Node.create('<a class="sqs-lightbox-previous"></a>');
d.appendChild(this._previousEl)
}if(!this.bMobile&&this.get("controls.next")){this._nextEl=Y.Node.create('<a class="sqs-lightbox-next"></a>');
d.appendChild(this._nextEl)
}}else{this.set("set",[{content:this.get("content"),meta:this.get("meta")}])
}this._slideshow=this.createSlideshow(d);
this._lightboxContentEl=this._slideshow.get("container");
this._closeEl=Y.Node.create('<a class="sqs-lightbox-close"></a>').appendTo(d).hide();
if(this.bMobile){this._overlay.get("container").setStyle("height",Math.max(Y.one("body").get("docHeight"),Y.one("body").get("winHeight")));
this._metaTriggerEl=Y.Node.create('<a class="sqs-lightbox-meta-trigger">&bull;</a>').appendTo(d)
}this._lightboxContentEl.plug(Y.Squarespace.Animations.Scalable);
this._lightboxContentEl.once("shown",function(){this._lightboxContentEl.setStyles({transform:null})
},this);
this._overlay.once("shown",function(){this.ignoreBodyClicks=true;
Y.Squarespace.EscManager.addTarget(this);
this._lightboxContentEl.show();
this._closeEl&&this._closeEl.show();
var e=this._slideshow.get("slides").item(this._slideshow.get("currentIndex")).one(".sqs-video-wrapper");
if(e){e.videoloader.showVideo()
}},this);
d.plug(Y.Squarespace.ScrollLock)
},bindUI:function(){Y.Squarespace.Lightbox2.superclass.bindUI.call(this);
this._slideshow.after("refresh",this.syncUI,this);
this._slideshow.after("currentIndexChange",Y.bind(function(f){this.set("currentSetIndex",f.newVal);
this.syncUI()
},this));
if(this._closeEl){this._event(this._closeEl.on("click",function(f){f.halt();
this.hideAndDestroy(true)
},this))
}if(this._metaTriggerEl){this._event(this._metaTriggerEl.on("click",function(){this.toggleMeta()
},this),"meta-trigger")
}if(this._previousEl){this._event(this._previousEl.on("click",function(f){f.halt();
this.previous()
},this),"previous-click");
var d=Y.throttle(Y.bind(this.previous,this),200);
this._event(Y.on("key",function(f){f.halt();
d()
},window,"down:37",this),"keyboard")
}if(this._nextEl){this._event(this._nextEl.on("click",function(f){f.halt();
this.next()
},this),"next-click");
var e=Y.throttle(Y.bind(this.next,this),200);
this._event(Y.on("key",function(f){f.halt();
e()
},window,"down:39",this),"keyboard");
if(!this.bMobile){this.setupNavigationFade()
}}this._event(this.get("contentBox").on("click",this.onContentBoxClick,this));
this._event(Y.on("transition:scroll:tapped",function(f){this.onContentBoxClick(f.touchEvent)
},this))
},onContentBoxClick:function(g){if(!g.target.ancestor("a",true)){g.halt();
if(g.target.ancestor(".sqs-video-wrapper")){g.target.ancestor(".sqs-video-wrapper").videoloader.showVideo();
return
}if(!this.bMobile){var f=Y.one("body").get("winWidth"),d=Y.one("body").get("winHeight"),h=0.02;
if(g.clientX>f*h&&g.clientX<f*(1-h)&&g.clientY>d*h&&g.clientY<d*(1-h)){if(g.clientX>=f/2&&this._nextEl){this.next();
return
}else{if(g.clientX<Y.one("body").get("winWidth")/2&&this._previousEl){this.previous();
return
}}}}this.hideAndDestroy(true)
}else{g.stopImmediatePropagation()
}},syncUI:function(){this.get("contentBox").setStyle("top",Y.one((Y.UA.gecko||Y.UA.ie)?"html":"body").get("scrollTop"));
var f=this._slideshow._currentSlide();
var e=f.one(".sqs-lightbox-meta")||this.createMetaEl(f);
if(e){this._metaTriggerEl&&this._metaTriggerEl.show();
if(!this.bMobile){var d=f.one(".sqs-lightbox-padder").get("children").item(0);
e.setStyles({bottom:d.getStyle("top"),left:d.getStyle("left"),right:d.getStyle("left")})
}else{e.appendTo(f);
e.setStyles({bottom:this.bMetaEnabled?0:"-5000px",left:0,right:0});
e.addClass("overlay-description-visible")
}}else{this._metaTriggerEl&&this._metaTriggerEl.hide()
}},previous:function(){this._slideshow.previousSlide()
},next:function(){this._slideshow.nextSlide()
},close:function(){this.hideAndDestroy()
},toggleMeta:function(){this.get("contentBox").all(".sqs-lightbox-meta").each(Y.bind(function(d){this.bMetaEnabled=parseInt(d.getStyle("bottom"),10)===0?true:false;
this._anim(d,{bottom:this.bMetaEnabled?"-5000px":"0"},{duration:this.get("speed")}).run();
this.bMetaEnabled=!this.bMetaEnabled
},this))
},hideAndDestroy:function(d){if(Y.Lang.isBoolean(d)&&d){this._overlay.overlayHideAndDestroy()
}else{this.once("hidden",this.destroy);
this.hide()
}Y.one("body").removeClass("sqs-lightbox-open")
},hide:function(){var d=this._anim(this.get("contentBox"),{opacity:0},{duration:this.get("speed")});
d.once("end",function(){Y.Squarespace.EscManager.removeTarget(this);
this.fire("hidden")
},this);
if(this.get("destroyed")){d.fire("end")
}else{d.run()
}},setupNavigationFade:function(){var f,d=function(){if(f){f.cancel()
}},e=function(g){d();
if(g&&g.inViewportRegion()){g.addClass("mouseover").siblings().removeClass("mouseover");
f=Y.later(500,this,function(){if(g&&g.inViewportRegion()){g.removeClass("mouseover")
}})
}};
this._event(this._nextEl.on("mouseenter",function(){d()
}),"nav-next-onmouse");
this._event(this._previousEl.on("mouseenter",function(){d()
}),"nav-prev-onmouse");
this._event(this._lightboxContentEl.on("mousemove",Y.bind(function(g){if(g.clientX<Y.one("body").get("winWidth")/2){e(this._previousEl)
}else{e(this._nextEl)
}},this)),"container-hovering")
},createSlideshow:function(f){var g=Y.Node.create('<div class="sqs-lightbox-slideshow"></div>').appendTo(f);
var e=this.get("set");
for(var j=0;
j<e.length;
j++){var d=Y.Node.create('<div class="sqs-lightbox-slide"></div>').appendTo(g),l=Y.Node.create('<div class="sqs-lightbox-padder"></div>').appendTo(d),k=Y.one(e[j].content.cloneNode(true)).appendTo(l).setAttribute("data-image-stretch","false").setStyle("opacity",null).removeClass("video-fill")
}var h=new Y.Squarespace.Gallery2({container:g,currentIndex:this.get("currentSetIndex"),loop:!this.bMobile,autoplay:false,refreshOnResize:true,refreshOnOrientationChange:true,design:"stacked",keyboard:false,designOptions:{clickBehavior:false,easing:Y.Easing.easeInOutExpo,speed:0.3,autoHeight:false,transition:this.bMobile?"scroll":"fade",transitionOptions:{direction:"horizontal"}},loaderOptions:{mode:"fit"},lazyLoad:true});
return h
},createMetaEl:function(f){f=f.one(".sqs-lightbox-padder");
var e=this.getCurrentElMeta();
if(e){var d=Y.Node.create('<div class="sqs-lightbox-meta"></div>');
d.appendChild(e);
f.appendChild(d);
if(!this.bMobile){this._event(f.one(":first-child").on("mouseenter",function(){d.addClass("overlay-description-visible")
},this),"meta-hovering");
this._event(f.one(":first-child").on("mouseleave",function(){d.removeClass("overlay-description-visible")
},this),"meta-hovering");
this._event(d.on("mouseenter",function(){d.addClass("overlay-description-visible")
},this),"meta-hovering");
this._event(d.on("mouseleave",function(){d.removeClass("overlay-description-visible")
},this),"meta-hovering")
}return d
}},getCurrentElContent:function(){if(this.get("set").length>0){return this.get("set")[this.get("currentSetIndex")].content
}else{return this.get("content")
}},getCurrentElMeta:function(){if(this.get("set").length>0){return this.get("set")[this.get("currentSetIndex")].meta
}else{return this.get("meta")
}}},{NS:"lightbox2",ATTRS:{content:{},controls:{value:{previous:false,next:false}},currentSetIndex:{value:0},meta:{},padding:{value:100},set:{value:[]},speed:{value:0.3}}});
Y.Squarespace.Lightbox2Plug=Y.Base.create("Lightbox2Plug",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){this._event(this.get("host").on("click",function(f){f.preventDefault();
var d=this;
Y.use("squarespace-ui-base",function(){var e=new Y.Squarespace.Lightbox2(Y.merge({content:Y.Node.create(d.get("host").getAttribute("data-lightbox"))},d.get("lightboxOptions")));
e.render()
})
},this))
}},{NS:"lightbox2plugin",ATTRS:{lightboxOptions:{}}});
Y.Squarespace.GalleryManager=Singleton.create({ready:function(){this._galleries=[];
this._imageQueue=new Y.AsyncQueue();
this._queueThrottle=this.isMobile()?1:16;
this._debugger=new Y.Squarespace.Debugger({name:"Gallery Manager",output:false})
},registerGallery:function(d){this._galleries.push(d)
},getGalleries:function(){return this._galleries
},initializeBlock:function(g){var k=g.getAttribute("data-block-json");
var n;
if(k){try{n=JSON.parse(k)
}catch(o){this._debugger.error("Error decoding gallery block data.");
return
}}else{n=g.getAncestorData("block").value
}if(!n){throw"Error evaluating gallery block data."
}var f;
switch(n.design){case"stacked":f="base";
break;
case"slider":f="strip";
break;
case"slideshow":f="stacked";
break;
case"grid":f="grid";
break;
default:f="base";
break
}var d=g.one(".sqs-gallery-container");
if(!d){this._debugger.warn("Returning, no wrapper found.");
return
}if(["grid","stacked"].indexOf(f)!==-1){d.ancestor(".sqs-block").removeClass("vsize-"+n.vSize)
}var s;
if(!d.one(".sqs-gallery").getData("gallery")){var h={};
var p={};
if(["grid","stacked"].indexOf(f)!==-1){h.autoHeight=true;
p.mode=n["auto-crop"]?"fill":"fit"
}if(f=="strip"){var q;
switch(n["active-alignment"]){case"left":q="start";
break;
case"center":q="middle";
break;
case"right":q="end";
break;
default:q="middle";
break
}h.alignment=q
}if(f=="grid"){h.lightbox=Static.IN_BACKEND?false:n.lightbox;
h.perRow=parseInt(n["thumbnails-per-row"],10);
p.mode=n["square-thumbs"]?"fill":"fit"
}var l=(f==="grid")?false:true;
this._debugger.log("Initialize Block",n);
d.setData("galleryOptions",n);
s=new Y.Squarespace.Gallery2({containerWrapper:d,container:d.one(".sqs-gallery"),elements:{previous:d.one(".sqs-gallery-controls .previous"),next:d.one(".sqs-gallery-controls .next")},design:f,designOptions:h,loaderOptions:p,keyboard:l,lazyLoad:true,autoplay:n.autoplay,loop:true,refreshOnResize:true,refreshOnOrientationChange:true});
if(n["autoplay-duration"]){var j=parseInt(n["autoplay-duration"]*1000,10);
if(s.get("autoplayOptions.timeout")!=j){s.set("autoplayOptions.timeout",j)
}}}else{this._debugger.log("Refreshing gallery.");
s=d.one(".sqs-gallery").getData("gallery");
s.refresh()
}var m=g.one(".sqs-gallery-thumbnails");
if(m){if(f==="stacked"&&!!n.thumbnails){var r=n["thumbnail-strip-height"];
m.all(".sqs-video-thumbnail").each(function(e){if(e.hasClass("no-image")){e.one(".sqs-video-thumbnail-inner").setStyles({width:Math.floor(r*(16/9))+"px"})
}var t=e.one("img");
if(t){t.once("load",function(){e.removeClass("loading");
e.setAttribute("style","width: "+t.get("offsetWidth")+"px !important")
})
}});
m.setStyles({height:r,marginTop:n["thumbnail-strip-margin"]});
var i;
if(!m.getData("gallery")){i=new Y.Squarespace.Gallery2({container:m,elements:{},loop:true,design:"strip",designOptions:{activeSlideClickBehavior:false,preloadCount:Math.ceil(s.get("container").get("offsetWidth")/r)},lazyLoad:true,loaderOptions:{canvas:false},refreshOnResize:true,refreshOnOrientationChange:true});
s.addChild(i)
}else{this._debugger.log("Refresh thumbnails.");
i=m.getData("gallery");
i.refresh()
}}}},refreshAll:function(){Y.Array.each(this._galleries,function(d){d.refresh()
})
},runImageQueue:function(){if(this._queueThrottle>0){this._imageQueue.run()
}else{this._imageQueue.pause()
}},addImageQueue:function(d){d.each(function(e){this._imageQueue.add({fn:function(){if(e&&e._node){e.plug(Y.Squarespace.Loader2,{load:true});
e.fire("refresh");
if(!e.get("complete")){this._queueThrottle--;
e.once(["load","error"],function(f){this._queueThrottle++;
this.runImageQueue()
},this)
}}this.runImageQueue()
},context:this,id:e.getAttribute("data-src")})
},this)
},promoteImageQueue:function(e){for(var d=e.size()-1;
d>=0;
d--){this._imageQueue.promote(e.item(d).getAttribute("data-src"))
}this.runImageQueue()
},removeImageQueue:function(d){d.each(function(e){this._imageQueue.remove(e.getAttribute("data-src"))
},this)
},isMobile:function(){return !Y.Lang.isUndefined(window.orientation)||navigator.userAgent.toLowerCase().indexOf("mobile")!==-1
}})
},"1.0",{requires:["base","plugin","squarespace-ss-widget","squarespace-gismo","squarespace-animations","node","event-key","squarespace-image-loader","squarespace-common","history","yui-throttle","squarespace-gallery-ng-css","squarespace-debugger","event-mouseenter","squarespace-touch-event-listener","squarespace-video-loader","async-queue"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-census",function(c){var b=function(){};
var a={COLLECTION:"collection",ITEM:"item"};
var d=c.namespace("Squarespace").Census={hit:function(){if(!Static.SQUARESPACE_CONTEXT.authenticatedAccount){if(Static.SQUARESPACE_CONTEXT.itemId){d.view(a.ITEM,Static.SQUARESPACE_CONTEXT.itemId)
}else{if(Static.SQUARESPACE_CONTEXT.collectionId){d.view(a.COLLECTION,Static.SQUARESPACE_CONTEXT.collectionId)
}else{console.warn("Census: Hit not recorded, somehow not an item or collection.")
}}}},view:function(e,g){var f={url:window.location.pathname,viewportInnerHeight:c.DOM.winHeight(),viewportInnerWidth:c.DOM.winWidth(),screenHeight:window.screen.height,screenWidth:window.screen.width,userAgent:c.UA.userAgent,referrer:window.document.referrer,pixelRatio:window.devicePixelRatio};
this._addPageTypeData(f,e,g);
d.track(c.Squarespace.Events.VIEW,f)
},track:function(e,f){if(!c.Lang.isObject(f)){f={}
}if(Static.SQUARESPACE_CONTEXT.website){f.websiteId=Static.SQUARESPACE_CONTEXT.website.id
}if(Static.SQUARESPACE_CONTEXT.templateId){f.templateId=Static.SQUARESPACE_CONTEXT.templateId
}c.Data.post({url:"/api/census/RecordHit",data:{event:e,data:f},success:b,failure:b})
},_addPageTypeData:function(f,e,g){if(e===a.ITEM){f.title=Static.SQUARESPACE_CONTEXT.item.title;
f.itemId=g
}else{if(e===a.COLLECTION){f.title=Static.SQUARESPACE_CONTEXT.collection.title;
f.collectionId=g
}}return f
}}
},"1.0",{requires:["base","dom-base","io","json-stringify"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-product-utils",function(a){a.Squarespace.ProductUtils={initializeVariantDropdowns:function(){a.all(".product-variants[data-variants]").each(function(b){var e=JSON.parse(b.getAttribute("data-variants"));
var d=b.all("select");
var f=b.siblings(".product-price").item(0);
var c;
if(f){c=f.getHTML()
}a.Squarespace.ProductUtils._checkVariantStockAndPrice(b,e,d,f,c);
d.detach("change");
d.after("change",function(i){var h=b.siblings(".sqs-add-to-cart-button-wrapper").item(0);
var g=h.one(".sqs-add-to-cart-button");
g.setContent(g.getData("originalLabel"));
h.removeClass("cart-added");
a.Squarespace.ProductUtils._checkVariantStockAndPrice(b,e,d,f,c)
},this)
},this)
},_checkVariantStockAndPrice:function(d,h,n,p,k){d.removeAttribute("data-unselected-options");
d.removeAttribute("data-selected-variant");
d.removeAttribute("data-variant-in-stock");
var g=d.one(".variant-out-of-stock");
if(g){g.remove()
}var o=[];
var f=null;
var b=false;
var c={};
n.each(function(i){var r=i.get("value");
var q=i.getAttribute("data-variant-option-name");
if(r!="none"){c[q]=r
}else{o.push(q)
}},this);
if(o.length===0){for(var j=0;
j<h.length;
j++){var e=h[j];
var m=true;
for(var l in c){if(c[l]!=e[l]){m=false;
break
}}if(m){f=e;
if(e.unlimited||e.qtyInStock>0){b=true
}break
}}if(!f&&p){p.set("text","Unavailable")
}else{if(p){if(f.onSale){p.setHTML(a.Squarespace.Commerce.moneyString(f.salePrice));
p.append(a.Node.create('<span> </span><span class="original-price">'+a.Squarespace.Commerce.moneyString(f.price)+"</span>"))
}else{p.setHTML(a.Squarespace.Commerce.moneyString(f.price))
}}}if(f&&!b){d.append(a.Node.create('<div class="variant-out-of-stock">Out of stock.</div>'))
}}else{if(p&&(p.getHTML()!==k)){p.setHTML(k)
}}d.setAttribute("data-unselected-options",JSON.stringify(o));
if(f){d.setAttribute("data-selected-variant",JSON.stringify(f))
}if(b){d.setAttribute("data-variant-in-stock",b)
}}}
},"1.0",{requires:["base","node","squarespace-commerce-utils"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-spinner",function(a){a.namespace("Squarespace").Spinner=a.Base.create("Spinner",a.Widget,[],{renderUI:function(){this.get("boundingBox").addClass(this.get("color"));
if(a.UA.ie>0&&a.UA.ie<10){this.get("contentBox").append(a.Node.create('<img class="sqs-ie-spinner" src="/universal/images-v6/configuration/crappy-ie-spinner.gif"/>'));
this.get("boundingBox").addClass("degraded")
}var b=this.get("size");
if(!a.Lang.isNumber(b)){this.get("boundingBox").addClass(b)
}},spin:function(){this.show()
},stop:function(){this.hide()
}},{CSS_PREFIX:"sqs-spin",NS:"spinner",ATTRS:{size:{value:"default",setter:function(b){if(a.Lang.isNumber(b)){this.set("width",b);
this.set("height",b)
}return b
}},color:{value:"light"}}})
},"1.0",{requires:["base-build","widget"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-ui-base",function(c){c.mix(c.Node.DOM_EVENTS,{message:true});
c.namespace("Squarespace");
c.Squarespace.DIALOG_ZINDEX_BASE=30000;
c.Anim._intervalTime=10;
var a=Number;
c.Anim.DEFAULT_SETTER=function(h,i,k,l,n,g,j,m){var e=h._node,f=e._node,d=j(n,a(k),a(l)-a(k),g);
if(e._node===null){console.warn("Could not find the animating DOMNode. Might have been destroyed. Bailing out for safety.");
return
}if(f){if("style" in f&&(i in f.style||i in c.DOM.CUSTOM_STYLES)){m=m||"";
e.setStyle(i,d+m)
}else{if("attributes" in f&&i in f.attributes){e.setAttribute(i,d)
}else{if(i in f){f[i]=d
}}}}else{if(e.set){e.set(i,d)
}else{if(i in e){e[i]=d
}}}};
c.Squarespace.Debug={dumpDDs:function(){for(var e=0;
e<c.DD.DDM.targets.length;
++e){var d=c.DD.DDM.targets[e];
console.log(e,d.get("node").get("className"))
}}};
var b=function(d){c.Squarespace.DDBehavior.superclass.constructor.apply(this,arguments)
};
b.NAME="DDBehavior";
b.NS="ddb";
b.ATTRS={host:{},validHandleClass:{}};
c.extend(b,c.Plugin.Base,{initializer:function(d){var e=this.get("host");
for(var f in d.behaviors){if(f.indexOf("drop:")!=-1&&e.target){e.target.on(f,d.behaviors[f],d.context)
}else{e.on(f,d.behaviors[f],d.context)
}}}});
c.Squarespace.DDBehavior=b;
c.Squarespace.TextShrink=c.Base.create("TextShrink",c.Plugin.Base,[],{initializer:function(){var d=this.get("host");
this.padding={left:0,right:0};
if(this.get("parentEl")==null){this.set("parentEl",d.ancestor())
}d.setAttribute("data-shrink-original-spacing",parseInt(d.getStyle("letterSpacing")));
d.setAttribute("data-shrink-original-size",parseInt(d.getStyle("fontSize")));
this.padding.left=parseInt(d.getStyle("paddingLeft"));
this.padding.right=parseInt(d.getStyle("paddingRight"));
if(c.Squarespace.Management){this.tweakEvent=c.Squarespace.Management.on("tweak",function(e){this._resetDimensions();
d.setAttribute("data-shrink-original-spacing",parseInt(d.getStyle("letterSpacing")));
d.setAttribute("data-shrink-original-size",parseInt(d.getStyle("fontSize")));
d.setStyles({letterSpacing:"",fontSize:""});
this.shrink()
},this)
}this.shrink()
},shrink:function(){var d=this.get("host");
d.removeClass("data-shrink-ready");
d.setStyle("width",(d.get("offsetWidth")-this.padding.left-this.padding.right)+"px");
d.setStyle("paddingLeft","0px");
d.setStyle("paddingRight","0px");
d.setStyle("letterSpacing","0px");
if(!this.isOverflowing()){d.setStyle("letterSpacing",d.getAttribute("data-shrink-original-spacing")+"px")
}this._adjust();
this._resetDimensions();
d.addClass("data-shrink-ready")
},isOverflowing:function(d){var e=this._getWidths(d);
if(Math.abs(e.el-e.parentEl)<=3){e.el=e.parentEl=Math.min(e.el,e.parentEl)
}return e.el>e.parentEl
},_adjust:function(d){var f=this.get("host");
var e=this._getWidths();
if(this.isOverflowing(d)){var h=parseInt(f.getStyle("letterSpacing"));
if(!isNaN(h)&&h>0){f.setStyle("letterSpacing",(h-1)+"px");
this.adjust(true)
}else{var g=parseInt(f.getStyle("fontSize"));
g=(e.parentEl/e.el)*g;
this._setFontSize(g)
}}return true
},_setFontSize:function(d){var e=this.get("host");
var f=this.get("minFontSize");
if(f&&d<f){d=f
}e.setStyle("fontSize",d+"px")
},_resetDimensions:function(){var d=this.get("host");
d.setStyles({width:"",paddingLeft:"",paddingRight:""})
},_getWidths:function(d){var h=this.get("host"),g=this.get("parentEl"),e=h.get("offsetWidth"),f=g.get("offsetWidth")-parseInt(g.getStyle("paddingLeft"))-parseInt(g.getStyle("paddingRight"))-this.padding.left-this.padding.right;
if(!f){console.warn("[TextShrink] Parent has no width.",g)
}if(d){e-=h.getStyle("letterSpacing")
}return{parentEl:f,el:e}
},destructor:function(){if(this.tweakEvent){this.tweakEvent.destroy()
}}},{ATTRS:{minFontSize:{value:null},parentEl:{value:null}},NS:"textshrink"});
c.Squarespace.SimpleFlexibleGrid=c.Base.create("SimpleFlexibleGrid",c.Plugin.Base,[],{initializer:function(){this._stylesheetEl=c.Node.create("<style></style>");
this.get("host").append(this._stylesheetEl);
this._resizeEvent=c.on("resize",this.syncUI,c.config.win,this);
this.syncUI()
},syncUI:function(){var d;
if(this.get("minWidth")){d=Math.floor(this.get("container").get("offsetWidth")/this.get("minWidth"))
}else{d=Math.ceil(this.get("container").get("offsetWidth")/this.get("maxWidth"))
}this._stylesheetEl.set("innerHTML",this.get("selector")+"{width:"+(100/d)+"% !important;}");
this.get("host").fire("simpleFlexibleGridSyncUI")
},destructor:function(){this._stylesheetEl.remove();
this._resizeEvent.detach()
}},{ATTRS:{container:{},selector:{},maxWidth:{},minWidth:{}},NS:"simple-flexible-grid"});
c.Squarespace.Mouse={lastX:100,lastY:100};
c.on(c.UA.mobile?"touchmove":"mousemove",function(d){c.Squarespace.Mouse.lastX=d.pageX;
c.Squarespace.Mouse.lastY=d.pageY
},c.one(document.body));
c.Squarespace.Image={loadAndFit:function(e,f){var d=new Image();
d.src=f;
c.one(d).on("load",function(i,h,g){h.set("src",g.src);
h.resizeToParent({scale:"cover"})
},this,e,d)
},rotate:function(e,d,j){var m=e.get("parentNode").get("offsetWidth");
var o=e.get("parentNode").get("offsetHeight");
var l=e.get("offsetWidth");
var k=e.get("offsetHeight");
var i=c.Squarespace.LoaderUtils.evaluateModeDimensions({mode:"fit",containerWidth:m,containerHeight:o,data:{dimensions:{width:l,height:k}}});
var n=c.Squarespace.LoaderUtils.evaluateModeDimensions({mode:"fit",containerWidth:o,containerHeight:m,data:{dimensions:{width:l,height:k}}});
var g,h;
if(j%180===0){g=i;
h=n
}else{g=n;
h=i
}var f=new c.Anim({node:e,from:{rotate:j,width:g.width,height:g.height,left:(m-g.width)/2,top:(o-g.height)/2},to:{rotate:d,width:h.width,height:h.height,top:(o-h.height)/2,left:(m-h.width)/2},easing:c.Easing.easeBothStrong,duration:0.3});
f.run()
},straighten:function(f,k,h,e){var g=(e<0?360-e:e)%360,d=g;
if(g>=90){d=g%90-90
}if(g>=180){d=-1*g%180-180
}if(g>=270){d=g%270-90
}var j=Math.abs(d)*(Math.PI/180);
var i;
if(h>k){i=(k*Math.cos(j)+h*Math.sin(j))/k
}else{i=(h*Math.cos(j)+k*Math.sin(j))/h
}f.setStyle("transform","rotate("+e+"deg) scale("+Math.abs(i)+")")
}};
c.Squarespace.Position=Class.create({initialize:function(d){this.EDGE_MARGIN=20;
this.avoidElX=d.avoidElX;
this.avoidElY=d.avoidElY;
this.xdir=d.xdir;
this.ydir=d.ydir;
this.x=d.x;
this.y=d.y;
this.xo=(d.xo?d.xo:0);
this.yo=(d.yo?d.yo:0);
this.w=d.w;
this.h=d.h;
this.initialX=this.getX();
this.initialY=this.getY()
},setX:function(d){this.x=d
},setY:function(d){this.y=d
},getX:function(){return this.x+this.getXO()
},getY:function(){return this.y+this.getYO()
},getXAdj:function(){return this.initialX-this.getX()
},getYAdj:function(){return this.initialY-this.getY()
},getXO:function(){return((this.avoidElX&&this.xdir=="right")?this.avoidElX.get("offsetWidth"):0)+this.xo
},getYO:function(){return((this.avoidElY&&this.ydir=="top")?-this.avoidElY.get("offsetHeight"):0)+this.yo
},isRightViolation:function(){return((this.x+this.w-Math.abs(this.getXO())+this.EDGE_MARGIN)>c.one(document.body).get("winWidth"))
},isLeftViolation:function(){return((this.x-Math.abs(this.getXO())-this.EDGE_MARGIN)<0)
},isTopViolation:function(){return((this.y-Math.abs(this.getYO())-this.EDGE_MARGIN)<c.one(document.body).get("docScrollY"))
},isBottomViolation:function(){return((this.y+this.h-Math.abs(this.getYO())+this.EDGE_MARGIN)>(c.one(document.body).get("winHeight")+c.one(document.body).get("docScrollY")))
},reflectFix:function(){if(this.xdir=="right"&&this.isRightViolation()){this.xdir="left";
this.getX=function(){return this.x-this.w-this.getXO()+11
}
}else{if(this.xdir=="left"&&this.isLeftViolation()){this.xdir="right";
this.getX=function(){return this.x+this.w+this.getXO()
}
}}if(this.ydir=="bottom"&&this.isBottomViolation()){this.ydir="top";
this.getY=function(){return this.y-this.h-this.getYO()
};
console.log("bottom violation .. now "+this.getY())
}else{if(this.ydir=="top"&&this.isTopViolation()){this.ydir="bottom";
this.getY=function(){return this.y+this.h+this.getYO()
};
console.log("top violation")
}}if((this.getY()-this.EDGE_MARGIN)<0){this.getY=function(){return c.one(document.body).get("winHeight")-this.h-this.EDGE_MARGIN
};
this.ydir="bottom"
}else{if((this.getY()+this.h+this.EDGE_MARGIN)>(c.one(document.body).get("winHeight")+c.one(document.body).get("docScrollY"))){this.getY=function(){return c.one(document.body).get("winHeight")+c.one(document.body).get("docScrollY")-this.EDGE_MARGIN-this.h
};
this.ydir="top"
}}if((this.getX()-this.EDGE_MARGIN)<0){this.getX=function(){return this.EDGE_MARGIN
};
this.ydir="left"
}else{if((this.getX()+this.w+this.EDGE_MARGIN)>(c.one(document.body).get("winWidth"))){this.getX=function(){return c.one(document.body).get("winWidth")-this.w-this.EDGE_MARGIN
};
this.ydir="right"
}}if(this.getY()<c.one(document.body).get("docScrollY")){console.log("fixing y offscreen issues.");
this.yo=(c.one(document.body).get("docScrollY")+this.EDGE_MARGIN)-this.y
}},nudgeFix:function(){if(this.isRightViolation()){this.getX=function(){return c.one(document.body).get("winWidth")+c.one(document.body).get("docScrollX")-this.w-this.EDGE_MARGIN
}
}else{if(this.isLeftViolation()){this.getX=function(){return this.EDGE_MARGIN
}
}}if(this.isBottomViolation()){this.getY=function(){return c.one(document.body).get("winHeight")+c.one(document.body).get("docScrollY")-this.h-this.EDGE_MARGIN
}
}else{if(this.isTopViolation()){this.getY=function(){return this.EDGE_MARGIN
}
}}},overflowFix:function(){if(this.isRightViolation()){this.x=c.one(document.body).get("winWidth")+c.one(document.body).get("docScrollX")-this.w-this.EDGE_MARGIN
}else{if(this.isLeftViolation()){this.x=this.EDGE_MARGIN
}}if(this.isBottomViolation()){this.y=c.one(document.body).get("winHeight")+c.one(document.body).get("docScrollY")-this.h-this.EDGE_MARGIN
}else{if((this.y-Math.abs(this.getXO())-this.EDGE_MARGIN)<0){this.y=this.EDGE_MARGIN
}}}});
c.Squarespace.ToolTipManager={canShow:true,disableTooltips:function(){this.canShow=false;
if(this.currentTip){this.currentTip.hide();
this.currentTip=null
}},enableTooltips:function(){this.canShow=true
}};
c.Squarespace.ToolTip=Class.create({initialize:function(e){this.params=e;
var d=c.all(this.params.target);
if(d.size()==0){console.warn("Couldn't find ToolTip target: "+this.params.target);
return
}if(this.params.showTimeout===undefined){this.params.showTimeout=1200
}if(this.params.width===undefined){this.params.width=250
}if(this.params.style===undefined){this.params.style="info"
}this.mouseOffset=15;
this.events=[d.on("mousemove",function(f){this.lastX=f.pageX;
this.lastY=f.pageY;
this.move();
if(this.showTimer){return
}this.showTimer=c.later(this.params.showTimeout,this,this.show)
},this),d.on("mouseout",function(f){if(this.showTimer){this.showTimer.cancel();
this.showTimer=null
}this.hide()
},this),d.on("click",function(f){if(!this.params.clickToShow){this.hide()
}else{this.show();
f.halt()
}},this),c.Global.on("manager:change-mode",function(f){this.hide()
},this)]
},destroy:function(){for(var d=0;
d<this.events.length;
++d){this.events[d].detach()
}if(this.el){this.el.remove();
this.el=null
}this.events=[];
this.destroyed=true;
this.shown=false
},move:function(){if(!this.el){return
}this.position.x=this.lastX;
this.position.y=this.lastY;
if(this.a){this.el.setStyles({left:this.position.getX()+"px"})
}else{this.el.setStyles({left:this.position.getX()+"px",top:this.position.getY()+"px"})
}},show:function(){if(this.el||this.destroyed||this.shown){return
}if(!c.Squarespace.ToolTipManager.canShow&&!this.params.dialogTooltip){return
}this.el=c.DB.DIV("sqsp-tooltip "+this.params.style,c.DB.DIV("title",{html:this.params.title}),(this.params.body?c.DB.DIV("description",{html:this.params.body}):null));
c.one(document.body).append(this.el);
this.position=new c.Squarespace.Position({xdir:"right",ydir:"bottom",x:this.lastX,y:this.lastY,xo:this.mouseOffset,yo:this.mouseOffset,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.reflectFix();
this.el.setStyles({left:this.position.getX()+"px",top:(this.position.getY()-this.position.yo)+"px",width:(this.params.width)+"px",zIndex:1000000,opacity:0});
if(this.params.icon){this.el.setStyle(backgroundImage,"url("+this.params.icon+")")
}this.shown=true;
this.a=new c.Anim({node:this.el,to:{top:this.position.getY(),opacity:1},duration:0.3,easing:c.Easing.easeOutStrong});
this.a.on("end",function(){this.a=null
},this);
this.a.run();
c.Squarespace.ToolTipManager.currentTip=this
},hide:function(){if(!this.el){return
}var d=new c.Anim({node:this.el,to:{top:(this.position.getY()+15),opacity:0},duration:0.3,easing:c.Easing.easeOutStrong});
d.on("end",function(){this.get("node").remove()
});
d.run();
this.el=null;
this.a=null;
this.shown=false
}});
c.Squarespace.CURRENT_CONFIRMATION_DIALOG=null;
c.Squarespace.ConfirmationDialog=Class.create({defaultOpts:{width:230,className:"question",position:"mouse",extreme:false,escToCancel:true,style:"proceedOrCancel",confirmText:"Confirm",cancelText:"Cancel",showSaveOverlay:true,screenOverlayOpacity:0.5,showScreenOverlay:true},initialize:function(d){this.params=c.merge(this.defaultOpts,d);
this.finished=false;
this.ignoreBodyClicks=true;
if(!this.params.zIndex){c.Squarespace.DIALOG_ZINDEX_BASE+=10;
this.zIndex=c.Squarespace.DIALOG_ZINDEX_BASE
}else{this.zIndex=this.params.zIndex
}},getFields:function(){if(this.params.fields){return this.params.fields
}else{return[]
}},getButtons:function(){if(this.params.style=="confirmOrReject"){var d=[];
if(!this.params.hideCancel){d.push(c.DB.DIV("cancel",{html:this.params.cancelText}))
}d.push(c.DB.INPUT("reject",{type:"button",value:this.params.rejectText}));
d.push(c.DB.INPUT("proceed",{type:"button",value:this.params.confirmText}));
return d
}else{if(this.params.style=="proceedOrCancel"){return[c.DB.DIV("cancel",{html:this.params.cancelText}),c.DB.INPUT("proceed",{type:"button",value:this.params.confirmText})]
}else{if(this.params.style=="confirmOnly"){return[c.DB.INPUT("proceed",{type:"button",value:this.params.confirmText})]
}}}},showChoice:function(i,f,g,h,e,j,d){this.params.style="confirmOrReject";
this.params.confirmText=g;
this.params.rejectText=e;
this.params.onReject=j;
this.show(i,f,h,d)
},showScreenOverlay:function(){if(this.overlayEl){this.fire("overlay-shown")
}else{var e=c.one(document).get("winWidth");
var f=c.one(document).get("winHeight");
this.overlayEl=c.DB.DIV("dialog-screen-overlay "+(this.params.extreme?"extreme":""));
this.overlayEl.setStyles({height:f+"px",width:e+"px"});
this.overlayEl.setStyle("zIndex",(this.zIndex+10));
c.one(document.body).append(this.overlayEl);
var d=new c.Anim({node:this.overlayEl,to:{opacity:this.params.screenOverlayOpacity},duration:0.1,easing:c.Easing.easeOutStrong});
d.on("end",function(){this.fire("overlay-shown")
},this);
d.run()
}},hideScreenOverlay:function(){if(this.overlayEl){var d=new c.Anim({node:this.overlayEl,to:{opacity:0},duration:0.1,easing:c.Easing.easeOutStrong});
d.on("end",function(){this.fire("overlay-hidden");
if(this.overlayEl){this.overlayEl.remove();
delete this.overlayEl
}},this);
d.run()
}else{this.fire("overlay-hidden")
}},show:function(h,f,g,e){if(this.finished){return
}if(!g){g=this.params.onSuccess||function(){}
}if(!e){e=this.params.scope||this
}this.params.confirmText=this.params.confirmText||h;
if(c.Squarespace.CURRENT_CONFIRMATION_DIALOG){c.Squarespace.CURRENT_CONFIRMATION_DIALOG.hide()
}if(this.params.escToCancel){c.Squarespace.CURRENT_CONFIRMATION_DIALOG=this
}if(h){this.params.title=h
}if(f){this.params.message=f
}if(e){this.params.scope=e
}if(g){this.params.onSuccess=g
}if(this.params.showSaveOverlay){if(this.params.scope&&this.params.scope.on&&this.params.scope.showSaveOverlay){this.params.scope.on("close",this.answer,this,null,false);
this.params.scope.on("cancel",this.answer,this,null,false);
this.params.scope.showSaveOverlay(true)
}}var d=c.bind(function(){c.Squarespace.EscManager.addTarget(this);
this.el=c.DB.DIV("sqsp-tooltip clear "+this.params.className,{style:"width: "+this.params.width+"px"},(this.params.spinner!==undefined?c.DB.DIV("spinner"):""),c.DB.DIV("title",{html:this.params.title}),(this.params.message!==undefined?c.DB.DIV("description",{html:this.params.message}):""),(this.getFields()?c.DB.DIV("fields",this.getFields()):null),(this.getButtons()?c.DB.DIV("buttons",this.getButtons()):null));
this.el.on("click",function(n){n.stopPropagation()
},this);
var j=this.el.one(".cancel");
if(j){j.on("click",this.answer,this,false)
}if(this.getButtons()){if(this.el.one(".proceed")){this.el.one(".proceed").on("click",this.answer,this,true,"proceed")
}if(this.el.one(".reject")){this.el.one(".reject").on("click",this.answer,this,true,"reject")
}}if(this.params.clickToClose){this.el.once("click",this.hide,this,true)
}c.one(document.body).append(this.el);
var i,m;
if(this.params.position=="mouse"){i=c.Squarespace.Mouse.lastX;
m=c.Squarespace.Mouse.lastY;
this.position=new c.Squarespace.Position({xdir:"right",ydir:"bottom",x:i,y:m,xo:-150,yo:-80,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.nudgeFix();
this.el.setStyles({position:"absolute",left:(this.position.getX())+"px",top:this.position.getY()+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="anchor"&&this.params.anchorEl){var l=c.one(this.params.anchorEl);
i=l.getX();
m=l.getY();
this.position=new c.Squarespace.Position({xdir:"right",ydir:"bottom",x:i,y:m,xo:-150,yo:-80,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.nudgeFix();
this.el.setStyles({position:"absolute",left:this.position.getX()+"px",top:this.position.getY()+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="center"){var m=(c.one(document.body).get("winHeight")/2-this.el.get("offsetHeight")/2),i=(c.one(document.body).get("winWidth")/2-this.el.get("offsetWidth")/2);
this.el.setStyles({position:"fixed",left:i+"px",top:m+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position.indexOf("top")!=-1){m=20
}else{m=(c.one(document.body).get("winHeight")-this.el.get("offsetHeight"))-20
}if(this.params.position.indexOf("right")!=-1){i=(c.one(document.body).get("winWidth")-this.el.get("offsetWidth"))-20
}else{i=20;
c.all(".config-panel").each(function(o){i+=o.get("offsetWidth")
})
}if(this.params.position=="lower-left"){this.el.setStyles({position:"fixed",left:(parseInt(c.one(".config-panel.root").getComputedStyle("width"),10)+10)+"px",bottom:"20px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="top-center"){var i=(c.one(document.body).get("winWidth")/2-this.el.get("offsetWidth")/2);
this.el.setStyles({position:"fixed",left:i+"px",top:"20px",zIndex:1000000,opacity:0})
}else{if(this.params.position.indexOf("bottom")!=-1){this.el.setStyles({position:"fixed",left:i+"px",bottom:"20px",zIndex:1000000,opacity:0})
}else{this.el.setStyles({position:"fixed",left:i+"px",top:m+"px",zIndex:1000000,opacity:0})
}}}}}}var k=c.Squarespace.Transitions.getTransition({el:this.el,name:"scale",direction:"in"});
if(this.el.one(".proceed")){this.el.one(".proceed").focus()
}k.run();
if(this.params.autoHide){this.hideTimer=c.later(this.params.autoHide,this,this.hide)
}},this);
if(this.params.showScreenOverlay){this.showScreenOverlay();
this.once("overlay-shown",d)
}else{d()
}},setCenter:function(d){this.el.setStyles({left:d.left-this.el.get("offsetWidth")/2,top:d.top-this.el.get("offsetHeight")/2})
},answer:function(f,g,d){if(this.finished){return
}if(f){f.halt()
}this.hide(g);
if(g){if(d=="proceed"){if(this.params.scope){this.params.onSuccess.apply(this.params.scope)
}else{this.params.onSuccess()
}}else{if(this.params.scope){this.params.onReject.apply(this.params.scope)
}else{this.params.onReject()
}}}else{if(this.params.onCancel){this.params.onCancel.apply(this.params.scope||this)
}}},close:function(){this.hide(false)
},hide:function(e){this.finished=true;
if(this.pulseAnim){this.pulseAnim.stop()
}if(this.hideTimer){this.hideTimer.cancel();
this.hideTimer=null
}if(this.params.showSaveOverlay){if(this.params.scope&&this.params.scope.on&&this.params.scope.hideSaveOverlay){this.params.scope.hideSaveOverlay(0.3)
}}var d=c.bind(function(){if(c.Squarespace.EscManager){c.Squarespace.EscManager.removeTarget(this)
}var f=c.Squarespace.Transitions.getTransition({el:this.el,name:"scale",direction:"out"});
f.on("end",function(h,g){if(g){g.remove()
}this.fire("hidden")
},this,this.el);
f.run();
this.el=null;
this.a=null;
if(this.params.escToCancel){c.Squarespace.CURRENT_CONFIRMATION_DIALOG=null
}},this);
this.once("overlay-hidden",d);
this.hideScreenOverlay()
}});
c.augment(c.Squarespace.ConfirmationDialog,c.EventTarget);
c.Squarespace.Alert=Class.extend(c.Squarespace.ConfirmationDialog,{initialize:function(d){if(!d){d={}
}d.className="alert";
d.showScreenOverlay=false;
c.Squarespace.Alert.prototype.superclass.initialize.call(this,d)
},getButtons:function(){return[c.DB.INPUT("proceed",{type:"button",value:"Ok"})]
}});
c.Squarespace.Notice=Class.extend(c.Squarespace.ConfirmationDialog,{initialize:function(d){if(!d){d={}
}d.className="okay";
d.showScreenOverlay=false;
c.Squarespace.Alert.prototype.superclass.initialize.call(this,d)
},getButtons:function(){return[c.DB.INPUT("proceed",{type:"button",value:"Ok"})]
}});
c.Squarespace.Information=Class.extend(c.Squarespace.ConfirmationDialog,{initialize:function(d){if(!d){d={}
}d=c.merge({className:"okay",autoHide:2000,clickToClose:true,escToCancel:false,showScreenOverlay:false},d);
c.Squarespace.Alert.prototype.superclass.initialize.call(this,d)
},getButtons:function(){return null
}});
c.Squarespace.Loading=Class.extend(c.Squarespace.ConfirmationDialog,{initialize:function(d){if(!d){d={}
}d.className="loading";
d.clickToClose=false;
d.escToCancel=false;
d.spinner=true;
c.Squarespace.Loading.prototype.superclass.initialize.call(this,d)
},show:function(g,e,f,d){this._super(g,e,f,d)
},hide:function(d){if(d===undefined){d=0
}setTimeout(c.bind(this._super,this),d)
},getButtons:function(){return null
}});
c.Squarespace.OptionConfirmationDialog=Class.extend(c.Squarespace.ConfirmationDialog,{initialize:function(d){if(!d){d={}
}d.clickToClose=false;
d.escToCancel=false;
c.Squarespace.Loading.prototype.superclass.initialize.call(this,d)
},getFields:function(){this.active=true;
var d=this.params.optionConfig;
this.checkEl=c.DB.DIV("field-wrapper check-field-wrapper clear thin",(d.padding?{style:"padding-top: "+d.padding[0]+"; padding-bottom: "+d.padding[1]+";"}:null),c.DB.DIV("check-element "+(this.active?"active":""),((d.title)?c.DB.DIV("field-title",{html:d.title}):null),(d.description?c.DB.DIV("field-description-wrapper",c.DB.DIV("field-description",{html:d.description})):null)));
this.checkEl.on("click",this.onClick,this);
return[this.checkEl]
},onClick:function(d){this.setValue(!this.active)
},getValue:function(){return this.active
},setValue:function(d){this.active=d;
if(this.active){this.checkEl.one(".check-element").addClass("active")
}else{this.checkEl.one(".check-element").removeClass("active")
}}});
c.Squarespace.Lightbox=Class.create({defaultOpts:{overlayShowDuration:0.35,contentShowDuration:0.6,margin:0,opacity:1,transition:"fade",clickAnywhereToExit:true,name:null,theme:"black",overlayStyle:"orb"},name:"Lightbox",initialize:function(d){this.enabled=true;
this.params=c.merge(this.defaultOpts,d);
if(!this.params.transition){this.params.transition="fade"
}if(!this.params.zIndex){c.Squarespace.DIALOG_ZINDEX_BASE+=10;
this.params.zIndex=c.Squarespace.DIALOG_ZINDEX_BASE
}this.events=[]
},enable:function(){this.enabled=true;
this.overlayEl.setStyle("display","block")
},disable:function(){this.enabled=false;
this.overlayEl.setStyle("display","none")
},getContentEl:function(){return this.contentEl
},show:function(){var e=c.one(document).get("winWidth");
var g=c.one(document).get("winHeight");
var f="sqs-lightbox"+(this.params.name?" sqs-lightbox-"+this.params.name:"");
this.contentEl=c.DB.DIV(f,(c.Lang.isString(this.params.content)?{html:this.params.content}:this.params.content));
this.contentEl.setStyles({position:"fixed",opacity:"0",overflow:"hidden",zIndex:(this.params.zIndex)});
this.events.push(c.on("resize",this.position,c.one(window),this));
if(!this.params.disableNormalClose){c.Squarespace.EscManager.addTarget(this)
}c.one(document.body).append(this.contentEl);
if(!this.params.contentOnly){var d="sqs-lightbox-overlay"+(this.params.name?" sqs-lightbox-overlay-"+this.params.name:"")+" "+this.params.theme;
if(this.params.name){d+=" sqs-lightbox-overlay-"+this.params.name
}if(this.params.overlayStyle){d+=" sqs-lightbox-overlay-style-"+this.params.overlayStyle
}this.overlayEl=c.DB.DIV(d);
this.overlayEl.setStyles({zIndex:this.params.zIndex-1});
c.one(document.body).append(this.overlayEl);
this.fire("showing");
this.a=c.Squarespace.Transitions.getTransition({el:this.overlayEl,opacity:this.params.opacity,name:"fade",direction:"in",duration:this.params.overlayShowDuration});
this.a.on("end",function(){this.fire("overlay-visible");
this.a=null;
this._showContent()
},this);
this.a.run();
if(!this.params.disableNormalClose){this.events.push(c.on("click",this.close,this.overlayEl,this))
}}else{this._showContent()
}if(this.params.clickAnywhereToExit){this.events.push(c.on("click",this.hide,this.contentEl,this))
}},position:function(){if(!this.enabled){return
}var h=c.one(document).get("winWidth");
var e=c.one(document).get("winHeight");
var g,d;
if(h<this.naturalW+(this.params.margin*2)){g=h-(this.params.margin*2)
}else{g=this.naturalW
}if(e<this.naturalH+(this.params.margin*2)){d=e-(this.params.margin*2)
}else{d=this.naturalH
}var i=(h-g)/2;
var f=(e-d)/2;
if(this.contentAttached){this.contentEl.setStyles({left:i+"px",top:f+"px",width:g+"px"});
if(!this.params.noHeightConstrain){this.contentEl.setStyles({height:d+"px"})
}if(this.resizeTarget){this.resizeTarget.resizeToParent({scale:"contain"})
}}this.fire("position",{width:g,height:d,verticalWidth:h,verticalHeight:e,maxWidth:h-(this.params.margin*2),maxHeight:e-(this.params.margin*2)})
},_showContent:function(){this.contentAttached=true;
this.resizeTarget=this.contentEl.one(".resize-target");
this.naturalW=this.contentEl.get("offsetWidth");
this.naturalH=this.contentEl.get("offsetHeight");
this.position();
this.fire("content-ready");
var d=c.Squarespace.Transitions.getTransition({el:this.contentEl,name:this.params.transition,direction:"in",duration:this.params.contentShowDuration});
d.on("end",function(){this.fire("content-visible")
},this);
d.run()
},close:function(d){if(!this.params.clickAnywhereToExit){if(!d||this.overlayEl.compareTo(d.target)){return
}}this.hide()
},hide:function(){if(!this.enabled){return
}if(this.a){this.a.stop()
}this.a=null;
this.fire("hiding");
c.Squarespace.EscManager.removeTarget(this);
if(this.overlayEl){var d=c.Squarespace.Transitions.getTransition({el:this.overlayEl,name:"fade",direction:"out",duration:this.params.overlayShowDuration});
if(this.params.overlayShowDuration>this.params.contentShowDuration){this.a=d
}d.run()
}var d=c.Squarespace.Transitions.getTransition({el:this.contentEl,name:this.params.transition,direction:"out",duration:this.params.contentShowDuration});
if(!this.a){this.a=d
}d.run();
this.a.on("end",function(){this.destroy();
this.fire("hidden")
},this)
},destroy:function(){for(var d=0;
d<this.events.length;
++d){this.events[d].detach()
}if(this.contentEl){this.contentEl.remove()
}if(this.overlayEl){this.overlayEl.remove()
}this.contentEl=null;
this.overlayEl=null;
this.events=[]
}});
c.augment(c.Squarespace.Lightbox,c.EventTarget);
c.Squarespace.CustomAnim=Class.create({initialize:function(d){this.params=d
},cancel:function(){},stop:function(){}});
c.augment(c.Squarespace.CustomAnim,c.EventTarget);
c.augment(c.Squarespace.CustomAnim,c.Attribute);
c.Squarespace.Transitions={STANDARD_DURATION:0.3,getTransition:function(d){if(!d.el||!d.el._node){console.warn("ui-base: [Transitions] You're trying to animate a non-existent element, returning blank animation");
return new c.Anim()
}if(!d.duration){d.duration=c.Squarespace.Transitions.STANDARD_DURATION
}return c.Squarespace.Transitions.transitionsByName[d.name](d)
},transitionsByName:{fade:function(d){return new c.Anim({node:d.el,to:{opacity:(d.opacity==null?(d.direction=="in"?1:0):d.opacity)},duration:c.Squarespace.Transitions.STANDARD_DURATION,easing:c.Easing.easeOutStrong})
},scale:function(d){return new (Class.extend(c.Squarespace.CustomAnim,{run:function(){if(!d.opacity){d.opacity=1
}if(d.duration==null){d.duration=c.Squarespace.Transitions.STANDARD_DURATION
}var e=this.params.el;
if(this.params.direction=="in"){e.setStyles({transform:"scale(.95)",opacity:0});
c.later(10,e,e.setStyles,{transitionProperty:"transform, opacity",transitionDuration:d.duration+"s",transitionTimingFunction:"ease-out","backface-visibility":"hidden"});
c.later(20,e,e.setStyles,{transform:"scale(1)",opacity:d.opacity})
}else{e.setStyles({transform:"scale(1)",opacity:d.opacity});
c.later(10,e,e.setStyles,{transitionProperty:"transform, opacity",transitionDuration:d.duration+"s",transitionTimingFunction:"ease-out",backfaceVisibility:"hidden"});
c.later(20,e,e.setStyles,{transform:"scale(.95)",opacity:0})
}c.later((d.duration*1000)+100,this,function(){this.fire("end",{_event:true})
})
}}))(d)
},none:function(d){return new (Class.extend(c.Squarespace.CustomAnim,{run:function(){if(this.params.direction=="in"){this.el.setStyle("opacity",1)
}else{this.el.setStyle("opacity",0)
}this.fire("end")
}}))(d)
}}};
c.Squarespace.Effects={bounce:function(d){d.setStyles({transform:"scale(1)"});
c.later(10,d,d.setStyles,{transitionProperty:"transform, opacity",transitionDuration:".2s",transitionTimingFunction:"ease-out",backfaceVisibility:"hidden"});
c.later(20,d,d.setStyles,{transform:"scale(1.3)"});
c.later(200,d,d.setStyles,{transform:"scale(1)"})
},focus:function(e){e.setStyle("outline","4px solid rgba(99, 145, 0, 0.8)");
var d=new c.Anim({node:e,to:{},duration:1.4,easing:c.Easing.easeOutStrong});
d.on("tween",function(g){var f=(1-(this.get("elapsedTime")/(this.get("duration")*1000)));
this.get("node").setStyle("outline","4px solid rgba(99, 145, 0, "+(f)+")")
});
d.on("end",function(){this.get("node").setStyle("outline","")
});
d.run()
},blink:function(e){var d=new c.Anim({node:e,to:{opacity:0},duration:0.6,easing:c.Easing.easeOutStrong});
d.on("end",function(){var f=new c.Anim({node:this.get("node"),to:{opacity:1},duration:0.6,easing:c.Easing.easeOutStrong});
f.on("end",function(){});
f.run()
});
d.run()
}};
c.Squarespace.NodeDestroyNotifier=c.Base.create("NodeDestroyNotifier",c.Plugin.Base,[],{destructor:function(){if(this.get("onDestroy")){this.get("onDestroy").call(this.get("context")||this)
}}},{NS:"nodedestroynotifier",ATTRS:{onDestroy:{},context:{}}});
c.augment(c.Node,Class.create({intersectXY:function(f,e){var d=this.get("region");
return(d.left<f&&f<d.right&&d.top<e&&e<d.bottom)
},forceClass:function(d,e){this[e?"addClass":"removeClass"](d)
},data:function(d){var e=this._node;
if(d){while(e){if(e.data&&e.className.indexOf(d)!=-1){return e.data
}e=e.parentNode
}}else{while(e){if(e.data){return e.data
}e=e.parentNode
}}return(null)
},setNodeData:function(d){this._node.data=d
}}));
c.Squarespace.RelativeTimeDisplay=c.Base.create("RelativeTimeDisplay",c.Plugin.Base,[],{initializer:function(){this.timer=c.later(this.get("interval"),this,this.syncUI,{},true);
this.syncUI()
},syncUI:function(){var d=Math.floor((new Date().getTime()-this.get("date").getTime())/1000);
if(d<60){if(d===0){this.get("host").setContent("just now")
}else{this.get("host").setContent("about "+d+" seconds ago")
}}else{this.get("host").setContent(c.Squarespace.Utils.humanizeDate(this.get("date"),true))
}},destructor:function(){this.timer.cancel()
}},{NS:"RelativeTimeDisplay",CSS_NAMESPACE:"sqs-action-overlay",ATTRS:{date:{valueFn:function(){return new Date()
}},interval:{value:5000}}});
c.Squarespace.PositionAnimator=c.Base.create("PositionAnimator",c.Plugin.Base,[],{initializer:function(){},hold:function(){this.set("originalTop",this.get("host").get("offsetTop"));
this.set("originalLeft",this.get("host").get("offsetLeft"));
this.previousPosition=this.get("host").getStyle("position")
},release:function(d){var g=this.get("host").get("offsetTop");
var i=this.get("host").get("offsetLeft");
var j=this.get("baseSpeed")+(d?0:(Math.random()*0.2));
var f=d?0:200*Math.random();
this.get("host").setStyles({position:"relative",top:this.get("originalTop")-g,left:this.get("originalLeft")-i});
var e=this;
var h=this.get("host").anim({top:0,left:0},{duration:j,end:function(){if(!this.get("node")._node){return
}this.get("node").setStyles({position:this.previousPosition,top:null,left:null});
if(e.get("releasedFn")){e.get("releasedFn")()
}e.fire("released")
}});
c.later(f,h,h.run)
},destructor:function(){}},{NS:"positionAnimator",ATTRS:{originalTop:{},originalLeft:{},releasedFn:{value:false},baseSpeed:{value:0.2}}})
},"1.0",{requires:["node","base","plugin","event-custom","attribute","squarespace-dombuilder","anim","squarespace-ui-base-css","squarespace-currency-symbols-css","squarespace-spinner"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-responsive-confirmation-dialog",function(a){a.namespace("Squarespace.Widgets");
a.Squarespace.Widgets.ResponsiveConfirmationDialog=a.Base.create("responsiveConfirmationDialog",a.Squarespace.Widgets.SSWidget,[],{isMobile:function(){return a.one(document).get("width")<=this.get("maxWidth")
}},{ATTRS:{maxWidth:{value:700}}});
a.Squarespace.Widgets.ResponsiveAlert=a.Base.create("responsiveAlert",a.Squarespace.Widgets.ResponsiveConfirmationDialog,[],{initializer:function(b){this._normalDialog=new a.Squarespace.Alert(b)
},renderUI:function(){a.Squarespace.Widgets.ResponsiveAlert.superclass.renderUI.call(this)
},show:function(d,b,c){if(this.isMobile()){alert(d+". "+b)
}else{this._normalDialog.show(d,b,c)
}}},{CSS_PREFIX:"sqs-responsive-alert",HANDLEBARS_TEMPLATE:"responsive-alert.html"})
},"1.0",{requires:["node","base","anim","squarespace-ui-base","squarespace-ss-widget"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-cart-utils",function(b){var a;
b.namespace("Squarespace.CartUtils");
b.Squarespace.CartUtils={initializeAddToCartButtons:function(){var c=b.Squarespace.Commerce.isExpressCheckout();
b.all(".sqs-add-to-cart-button").each(function(d){if(c){d.setContent("Purchase");
d.setData("originalLabel","Purchase")
}else{d.setData("originalLabel","Add to Cart")
}},this);
if(!a){a=b.one("body").delegate("click",b.Squarespace.CartUtils._addCartEntry,".sqs-add-to-cart-button",this)
}},_addCartEntry:function(u){var l=u.target;
var f=l.get("parentNode");
if(f.hasClass("cart-added")){return
}var g=function(e){new b.Squarespace.Widgets.ResponsiveAlert().show("Unable to "+(b.Squarespace.Commerce.isExpressCheckout()?"Purchase":"Add")+" Item",e)
};
var p=l.getAttribute("data-item-id");
var k;
var n;
var c;
var y=b.one(l.get("parentNode").siblings(".product-variants").item(0));
if(y){var h=JSON.parse(y.getAttribute("data-unselected-options"));
var t=h.length;
var q=y.getAttribute("data-selected-variant");
var w=y.getAttribute("data-variant-in-stock");
var v=q?JSON.parse(q):null;
var j=w?true:false;
if(t>0){var x="Please select the ";
if(t==1){x+=h[0]+" option."
}else{if(t==2){x+=h[0]+" and "+h[1]+" options."
}else{for(var r=0;
r<t;
r++){if(r==t-1){x+="and "+h[r]+" options."
}else{x+=h[r]+", "
}}}}g(x);
return
}else{if(!v){g("Sorry, that item variant is unavailable. Please select another variant.");
return
}else{if(!j){g("Sorry, we do not have enough of that item available.");
return
}else{k=v
}}}}var d=l.get("parentNode").siblings(".product-quantity-input").item(0);
if(d){n=b.one(d).one("input").get("value");
if(!b.Lang.isNumber(Number(n))){g("Quantity must be a number.");
return
}}var s=b.one('input[data-item-id="'+p+'"][data-name="payWhatYouWantPrice"]');
if(s){var m=s.get("value").replace(/\s+/g,"").replace(/\,/g,"");
var o=m.split(".");
if(o.length>2||(o[1]&&o[1].length>2)){g("Payment price invalid.");
return
}c=parseFloat(m)
}l.setContent("Adding...");
if(b.Squarespace.Commerce.isExpressCheckout()&&b.Squarespace.SHOPPING_CART.hasEntry(p,k)){b.Squarespace.Commerce.goToCheckoutPage()
}else{b.Squarespace.SHOPPING_CART.addEntry(p,k,n,c,function(e){if(e){g(e);
l.setContent(l.getData("originalLabel"))
}else{if(b.Squarespace.Commerce.isExpressCheckout()){b.Squarespace.Commerce.goToCheckoutPage()
}else{l.setContent("Added!");
l.get("parentNode").addClass("cart-added")
}}},this)
}}}
},"1.0",{requires:["base","node","squarespace-commerce-utils","squarespace-responsive-confirmation-dialog"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-commerce-analytics",function(b){var c=new b.Base.create("commerceTrack",b.Base,[],{itemViewed:function(j){this.fire("commerce-item-viewed",j)
},itemAdded:function(j){this.fire("commerce-item-added",j)
},itemRemoved:function(j){this.fire("commerce-item-removed",j)
},itemModified:function(j){this.fire("commerce-item-modified",j)
},checkoutStarted:function(j){this.fire("commerce-checkout-started",j)
},checkoutConfirmed:function(j){this.fire("commerce-checkout-confirmed",j)
}},{ATTRS:{}});
b.namespace("Squarespace").CommerceAnalytics=new c();
var a=b.Base.create("commerceAnalytics",b.Base,[],{initializer:function(){b.Squarespace.CommerceAnalytics.on("commerce-item-viewed",this._getProtectedTracker("onItemViewed"),this);
b.Squarespace.CommerceAnalytics.on("commerce-item-added",this._getProtectedTracker("onItemAdded"),this);
b.Squarespace.CommerceAnalytics.on("commerce-item-removed",this._getProtectedTracker("onItemRemoved"),this);
b.Squarespace.CommerceAnalytics.on("commerce-item-modified",this._getProtectedTracker("onItemModified"),this);
b.Squarespace.CommerceAnalytics.on("commerce-checkout-started",this._getProtectedTracker("onCheckoutStarted"),this);
b.Squarespace.CommerceAnalytics.on("commerce-checkout-confirmed",this._getProtectedTracker("onCheckoutConfirmed"),this);
this._setCartMode()
},_setCartMode:function(){var k=true;
try{k=Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.testModeOn
}catch(j){}this.cartMode=k?"test":"live"
},_getProtectedTracker:function(j){return function(l){try{this[j].call(this,l)
}catch(k){}}
},onItemViewed:function(j){},onItemAdded:function(j){},onItemRemoved:function(j){},onItemModified:function(j){},onCheckoutStarted:function(j){},onCheckoutConfirmed:function(j){}},{ATTRS:{}});
var d=b.Base.create("commerceAnalyticsInternal",a,[],{_createCartData:function(j){return{CartOrderId:j.id,CartSubtotal:j.subtotalCents/100,CartTax:j.taxCents/100,CartCurrency:"USD",CartMode:this.cartMode}
},_createProductData:function(j){return{ProductId:j.itemId,ProductName:j.title,ProductType:(j.productType===2)?"DIGITAL":"PHYSICAL",ProductSKU:(j.chosenVariant)?j.chosenVariant.sku:"",ProductPrice:j.purchasePriceCents/100,ProductQuantity:j.quantity}
},_getItemVariantPrice:function(j){var k;
if(b.Object.hasKey(j,"onSale")&&j.onSale){k=(b.Object.hasKey(j,"salePrice")?j.salePrice:j.salePriceCents)/100
}else{k=(b.Object.hasKey(j,"price")?j.price:j.priceCents)/100
}return k
},_getItemPrice:function(k){var j=0;
if(b.Object.hasKey(k,"variants")&&k.variants.length>0){b.Array.each(k.variants,function(l){j+=this._getItemVariantPrice(l)
},this);
j=j/k.variants.length
}else{j=this._getItemVariantPrice(k)
}return j
},_createItemData:function(j){return{ProductId:j.id,ProductName:j.title,ProductType:(j.productType===2)?"DIGITAL":"PHYSICAL",ProductPrice:this._getItemPrice(j),CartMode:this.cartMode}
},_createItemAddedData:function(j){return b.merge(this._createCartData(j.shoppingCart),this._createProductData(j.newlyAdded))
},_createItemRemovedData:function(j){return b.merge(this._createCartData(j.shoppingCart),this._createProductData(j.updatedEntry))
},_createItemModifiedData:function(j){return b.merge(this._createCartData(j.shoppingCart),this._createProductData(j.updatedEntry))
},_createItemCheckoutStartedData:function(j,k){return b.merge(this._createCartData(j),this._createProductData(k))
},_createItemCheckoutCompletedData:function(j,k){return b.merge(this._createCartData(j),this._createProductData(k))
},_track:function(j,k){b.Squarespace.Analytics.trackInternal(j,k)
},onItemViewed:function(j){this._track("shopper_product_viewed",this._createItemData(j))
}},{ATTRS:{}});
var i=b.Base.create("commerceAnalyticsMixpanel",d,[],{_track:function(j,k){b.Squarespace.Analytics.track(j,k)
},onItemViewed:function(j){this._track("shopper_product_viewed",this._createItemData(j))
},onItemAdded:function(j){this._track("shopper_product_added",this._createItemAddedData(j))
},onItemRemoved:function(j){this._track("shopper_product_removed",this._createItemRemovedData(j))
},onItemModified:function(j){this._track("shopper_product_modified",this._createItemModifiedData(j))
},onCheckoutStarted:function(j){b.each(j.entries,function(k){this._track("shopper_product_checkout_started",this._createItemCheckoutStartedData(j,k))
},this)
},onCheckoutConfirmed:function(j){b.each(j.purchasedCart.entries,function(k){this._track("shopper_product_purchased",this._createItemCheckoutCompletedData(j.purchasedCart,k))
},this);
this._track("shopper_order_submitted",{CartOrderId:j.purchasedCart.id,CartCurrency:"USD",CartGrandTotal:j.purchasedCart.grandTotalCents/100,CartSubtotal:j.purchasedCart.subtotalCents/100,CartTax:j.purchasedCart.taxCents/100,CartShipping:j.purchasedCart.shippingCostCents/100,CartTotalQuantity:j.purchasedCart.totalQuantity,CartMode:this.cartMode})
}},{ATTRS:{}});
var h=b.Base.create("commerceAnalyticsGoogle",a,[],{onCheckoutConfirmed:function(j){if(_gaq){_gaq.push(["_addTrans",j.id,"",j.purchasedCart.subtotalCents/100,j.purchasedCart.taxCents/100,j.purchasedCart.shippingCostCents/100,j.customer.billingAddress.city,j.customer.billingAddress.state,j.customer.billingAddress.country]);
b.each(j.purchasedCart.entries,function(k){_gaq.push(["_addItem",j.id,(k.chosenVariant)?k.chosenVariant.sku:"digital",k.title,"",k.purchasePriceCents/100,k.quantity])
});
_gaq.push(["_trackTrans"])
}}},{ATTRS:{}});
var g=new d();
var e=new i();
var f=new h();
if(b.Lang.isObject(Static)&&b.Object.hasKey(Static,"SQUARESPACE_CONTEXT")&&b.Object.hasKey(Static.SQUARESPACE_CONTEXT,"item")){if(Static.SQUARESPACE_CONTEXT.item.recordType===b.Squarespace.ContentConstants.STORE_ITEM){b.Squarespace.CommerceAnalytics.itemViewed(Static.SQUARESPACE_CONTEXT.item)
}}},"1.0",{requires:["event-custom","node","base","squarespace-enum"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-models-shopping-cart",function(a){a.namespace("Squarespace.Models");
var b=a.Squarespace.Models.ShoppingCart=a.Base.create("shoppingCart",a.Model,[],{initializer:function(){this._readInProgress=false
},toJSON:function(){var c=b.superclass.toJSON.call(this);
var d=c.created;
if(!a.Lang.isNull(d)){c.created=d.getTime()
}return c
},sync:function(d,c,e){switch(d){case"create":break;
case"delete":break;
case"read":this._read(c,e);
break;
case"update":break
}},load:function(d,e,c){if(typeof d==="function"){e=d;
d={}
}if(this._readinProgress){this.after("load",e,c);
return
}a.Model.prototype.load.call(this,d,e?a.bind(e,c||this):null)
},hasEntry:function(d,c){return a.Array.reduce(this.get("entries"),false,function(f,e){if(a.Lang.isValue(c)){return f||(e.itemId==d&&c.sku==e.chosenVariant.sku)
}else{return f||(e.itemId==d)
}})
},addEntry:function(h,f,g,e,i,d){var c;
if(!a.Lang.isUndefined(e)&&!a.Lang.isNull(e)){if(!a.Lang.isNumber(e)){if(i){i.call(d,{error:"Payment price invalid"})
}return
}else{c=Math.round((e*100)*100/100);
if(c>999999900){if(i){i.call(d,{message:"Payment price exceeds system maximum of "+a.Squarespace.Commerce.currencySymbol()+"9,999,999."})
}return
}}}a.Data.post({url:"/api/open/AddToCart",data:{itemId:h,variantSku:a.Lang.isValue(f)?f.sku:null,quantity:g,payWhatYouWantPrice:c},success:function(j){a.Squarespace.CommerceAnalytics.itemAdded(j);
this.setAttrs(j.shoppingCart);
if(i){i.call(d||this,null,j.newlyAdded)
}},failure:function(j){if(i){i.call(d||this,j.error,null)
}}},this)
},updateEntryQuantity:function(d,f,g,c){var e=d.chosenVariant;
a.Data.post({url:"/api/open/UpdateCart",data:{itemId:d.itemId,chosenVariantSku:a.Lang.isValue(e)?e.sku:null,quantity:f},success:function(h){if(f===0){a.Squarespace.CommerceAnalytics.itemRemoved(h)
}else{a.Squarespace.CommerceAnalytics.itemModified(h)
}this.setAttrs(h.shoppingCart);
if(g){g.call(c||this,null,h.updatedEntry)
}},failure:function(h){if(g){g.call(c||this,h.error,null)
}}},this)
},updateShippingLocation:function(d,e,c){this.fire("recalculate-start");
a.Data.post({url:"/api/open/UpdateCartShippingLocation",data:d,success:function(f){this.fire("recalculate-end");
this.setAttrs(f.shoppingCart);
if(e){e.call(c||this,null)
}},failure:function(f){this.fire("recalculate-end");
if(e){e.call(c||this,f.error,null)
}}},this)
},updateShippingMethod:function(d,e,c){this.fire("recalculate-start");
a.Data.post({url:"/api/open/UpdateCartShippingMethod",data:{chosenShippingOption:d},success:function(f){this.fire("recalculate-end");
this.setAttrs(f.shoppingCart);
if(e){e.call(c||this,null)
}},failure:function(f){this.fire("recalculate-end");
if(e){e.call(c||this,f.error,null)
}}},this)
},addCoupon:function(d,e,c){a.Data.post({url:"/api/open/AddCouponToCart",data:{promoCode:d},success:function(f){this.setAttrs(f.shoppingCart);
if(e){e.call(c||this,null)
}},failure:function(f){if(e){e.call(c||this,f.error,null)
}}},this)
},removeCoupon:function(d,e,c){a.Data.post({url:"/api/open/RemoveCouponFromCart",data:{id:d},success:function(f){this.setAttrs(f.shoppingCart);
if(e){e.call(c||this,null)
}},failure:function(f){if(e){e.call(c||this,f.error,null)
}}},this)
},_read:function(c,d){this._readInProgress=true;
this.fire("loading");
a.Data.get({url:"/api/open/GetShoppingCart",success:function(e){this.fire("loaded");
this._readInProgress=false;
d(null,e.shoppingCart)
},failure:function(e){this.fire("loaded");
this._readInProgress=false;
d(e.error,null)
}},this)
}},{ATTRS:{id:{validator:a.Lang.isString},websiteId:{validator:a.Lang.isString},orderId:{validator:a.Lang.isString},created:{getter:function(c){if(!a.Lang.isValue(c)){return null
}else{return new Date(c)
}},setter:function(c){if(a.Lang.isDate(c)){return c.getTime()
}else{return c
}},validator:a.Lang.isNumber},isPurchased:{value:false,validator:a.Lang.isBoolean},entries:{value:[],validator:a.Lang.isArray},shippingOptions:{value:[],validator:a.Lang.isArray},selectedShippingOption:{validator:a.Lang.isObject},shippingLocation:{validator:a.Lang.isObject},applicableTaxRules:{value:[],validator:a.Lang.isArray},coupons:{value:[],validator:a.Lang.isArray},validCoupons:{value:[],validator:a.Lang.isArray},invalidCoupons:{value:[],validator:a.Lang.isArray},subtotalCents:{validator:a.Lang.isNumber},taxCents:{validator:a.Lang.isNumber},shippingCostCents:{validator:a.Lang.isNumber},discountCents:{validator:a.Lang.isNumber},grandTotalCents:{validator:a.Lang.isNumber},totalQuantity:{validator:a.Lang.isNumber},hasDigital:{validator:a.Lang.isBoolean},purelyDigital:{validator:a.Lang.isBoolean}}})
},"1.0",{requires:["base","model","squarespace-commerce-utils","squarespace-commerce-analytics"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-pill-shopping-cart-template",function(c){var b=c.Handlebars;
(function(){var e=b.template,d=b.templates=b.templates||{};
d["pill-shopping-cart.html"]=e(function(i,j,g,f,h){this.compilerInfo=[2,">= 1.0.0-rc.3"];
g=g||i.helpers;
h=h||{};
return'<div class="icon"></div>\n\n<div class="details">\n  Cart&nbsp;-&nbsp;\n    <span class="total-quantity"></span>\n    <span class="suffix"></span>\n</div>\n\n<span class="subtotal">\n  <span class="price"></span>\n</span>\n'
})
})();
var a="pill-shopping-cart.html";
c.Handlebars.registerPartial(a.replace("/","."),b.templates[a])
},"1.0",{requires:["handlebars-base"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-pill-shopping-cart",function(b){b.namespace("Squarespace.Widgets");
var a=b.Squarespace.Widgets.PillShoppingCart=b.Base.create("pillShoppingCart",b.Squarespace.Widgets.SSWidget,[],{renderUI:function(){a.superclass.renderUI.call(this);
this.get("boundingBox").plug(b.Squarespace.Animations.Scalable,{duration:0.25});
this._hide(true);
this.get("contentBox").addClass(this.get("useLightCart")?"light":"dark")
},bindUI:function(){a.superclass.bindUI.call(this);
this.get("model").on("change",this.syncUI,this);
this.get("contentBox").on("click",function(){window.location="/show-cart?cartId="+b.Cookie.get("CART")
})
},syncUI:function(){a.superclass.syncUI.call(this);
var e=this.get("model");
var f=e.get("totalQuantity");
var c=this.get("contentBox");
var d=function(){c.one(".total-quantity").setContent(f>100?"100+":f);
c.one(".suffix").setContent(f===1?"item":"items");
c.one(".subtotal .price").setContent(b.Squarespace.Commerce.moneyString(e.get("subtotalCents")))
};
if(f>0){d();
this._show()
}else{this._hide();
d()
}},_show:function(){var c=this.get("boundingBox");
if(c.hasClass("sqs-scalable-hidden")){c.show()
}else{var f=b.Easing.easeOutStrong;
var e=new b.Anim({node:c,to:{opacity:0.7},duration:0.2,easing:f});
var d=new b.Anim({node:c,to:{opacity:1},duration:0.5,easing:f});
e.on("end",function(){d.run()
});
e.run()
}},_hide:function(d){var c=this.get("boundingBox");
if(!c.hasClass("sqs-scalable-hidden")){c.hide(d)
}}},{CSS_PREFIX:"sqs-pill-shopping-cart",HANDLEBARS_TEMPLATE:"pill-shopping-cart.html",ATTRS:{model:{value:null,validator:function(c){return b.instanceOf(c,b.Squarespace.Models.ShoppingCart)
}},useLightCart:{value:false}}})
},"1.0",{requires:["base","node","cookie","squarespace-commerce-utils","squarespace-animations","squarespace-models-shopping-cart","squarespace-pill-shopping-cart-template","squarespace-pill-shopping-cart-css"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-lightbox",function(b){b.namespace("Squarespace.Widgets");
var a=b.Squarespace.Widgets.Lightbox=b.Base.create("lightbox",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._resizeEmitter=new b.Squarespace.ResizeEmitter({timeout:100})
},destructor:function(){this._resizeEmitter.destroy()
},renderUI:function(){a.superclass.renderUI.call(this);
this._backgroundEl=b.Node.create('<div class="lightbox-background"></div>');
this._closeEl=b.Node.create('<div class="lightbox-close">&times;</div>');
this._contentEl=b.Node.create('<div class="lightbox-content"></div>');
this._contentEl.setContent(this.get("content"));
this._innerEl=b.Node.create('<div class="lightbox-inner"></div>');
this._innerEl.append(this._closeEl).append(this._contentEl);
this._innerEl.plug(b.Squarespace.Animations.Scalable,{duration:this.get("animDuration")}).hide(true);
var c=this.get("boundingBox");
c.plug(b.Squarespace.Animations.Fadeable,{duration:this.get("animDuration")}).hide(true);
this.get("contentBox").append(this._backgroundEl).append(this._innerEl);
if(this.get("openOnRender")){this.open()
}},bindUI:function(){a.superclass.bindUI.call(this);
this.on("contentChange",function(c){this._contentEl.setContent(c.newVal);
this.syncUI()
},this);
this._resizeEmitter.on("resize",this.syncUI,this);
this._innerEl.one(".lightbox-close").on("click",function(c){this.close();
b.Squarespace.EscManager.removeTarget(this)
},this)
},syncUI:function(){a.superclass.syncUI.call(this);
this._setTop();
this._setInnerMarginTop()
},open:function(){b.one("html").addClass("sqs-lightbox-open");
this.get("boundingBox").show();
this._innerEl.show();
this.syncUI();
b.Squarespace.EscManager.addTarget(this);
this.fire("open")
},close:function(){b.one("html").removeClass("sqs-lightbox-open");
this._innerEl.hide();
this.get("boundingBox").hide();
this.fire("close")
},_setTop:function(){this.get("boundingBox").setStyle("top",b.one((b.UA.gecko||b.UA.ie)?"html":"body").get("scrollTop"))
},_setInnerMarginTop:function(){this._innerEl.setStyle("marginTop",Math.max((window.innerHeight/-2),-this._innerEl.get("offsetHeight")/2))
}},{CSS_PREFIX:"sqs-lightbox",ATTRS:{content:{value:null},animDuration:{value:0.3},openOnRender:{value:false}}})
},"1.0",{requires:["base","node","squarespace-util","squarespace-animations","squarespace-ss-widget","squarespace-lightbox-css"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-comment-data",function(a){a.namespace("Squarespace");
a.Squarespace.CommentData=Class.create({initialize:function(b){if(b===undefined){throw new Error("You must provide a configuration object.")
}else{if(b.target===undefined){throw new Error("You must provide a target id.")
}else{if(b.targetType===undefined){throw new Error("You must provide a target type.")
}}}this.settings=(b.settings||{approvalRequired:false,allowAnon:true,threaded:true});
this.formatter=(b.formatter||function(c){return c
});
this.page=1;
this.data={comments:[]};
this.topLevelComments=0;
this.visibleComments=0;
this.totalComments=(Static.SQUARESPACE_CONTEXT.item?Static.SQUARESPACE_CONTEXT.item.publicCommentCount:(Static.SQUARESPACE_CONTEXT.collection?Static.SQUARESPACE_CONTEXT.collection.publicCommentCount:0));
this.commentsPerPage=50;
this.target=b.target;
this.targetType=b.targetType;
this.idToIndex={};
this.comments=[];
this.likeMap={};
this.flagMap={};
this.formatted={};
this.currentThreadRoot="";
this.formattedThread={};
this.pageIntervals=[]
},useSecure:function(){return(window.SQUARESPACE_LOGIN&&window.SQUARESPACE_LOGIN.isLoggedIn())
},getCommentById:function(b){return this.comments[this.idToIndex[b]]
},removeCommentById:function(c){var b=this.idToIndex[c];
if(!a.Lang.isUndefined(b)){this.comments.splice(b,1);
this.calculatePagination()
}},removeCommentsByIds:function(b){b.forEach(function(d){var c=this.idToIndex[d];
if(!a.Lang.isUndefined(c)){this.comments.splice(c,1);
this.visibleComments-=1;
this.totalComments-=1
}},this);
this.calculatePagination()
},getFormattedPage:function(c){var b=this.pageIntervals[c-1];
if(b){return Array.prototype.slice.apply(this.comments,b)
}else{return null
}},fullBookkeeping:function(d){var c=0,e={},b={};
this.comments=[];
this.pageIntervals=[];
this.idToIndex={};
for(c=0;
c<d.comments.length;
c++){e=d.comments[c];
this.idToIndex[e.id]=c;
this.comments[c]=e
}this.pageIntervals.push([0,undefined]);
this.flagMap=d.flagMap;
this.likeMap=d.likeMap;
this.commentSettings=d.commentSettings;
this.visibleComments=d.visibleComments;
this.topLevelComments=(this.formatted.topLevelComments||this.topLevelComments);
this.totalComments=(d.totalComments?d.totalComments:this.totalComments);
this.reformat();
this.topLevelComments=d.topLevelComments;
this.numLikes=d.numLikes;
this.numPages=Math.ceil(this.topLevelComments/this.commentsPerPage)
},addCommentData:function(b){this.comments.splice((this.idToIndex[b.parentId]||-1)+1,0,b);
this.calculatePagination()
},calculatePagination:function(){var b=50,e=0,d,f,c;
this.idToIndex={};
this.pageIntervals=[[0,undefined]];
for(c=0;
c<this.comments.length;
c++){f=this.comments[c];
this.idToIndex[f.id]=c;
if(!f.parentId){e+=1;
if(e>b){d=this.pageIntervals[this.pageIntervals.length-1];
d[1]=e-1;
this.pageIntervals.push([d[1],undefined]);
e=0
}}}},appendBookkeeping:function(d){var c=0,b={},e={};
this.pageIntervals[this.pageIntervals.length-1][1]=this.comments.length;
for(c=0;
c<d.comments.length;
c++){e=d.comments[c];
this.idToIndex[e.id]=(this.comments.length+1);
this.comments.push(e)
}this.pageIntervals.push([this.pageIntervals[this.pageIntervals.length-1][1],undefined]);
this.likeMap=a.merge(this.likeMap,d.likeMap);
this.flagMap=a.merge(this.flagMap,d.flagMap);
this.visibleComments+=d.visibleComments;
this.reformat()
},reformat:function(){this.formatted=this.formatter(this.comments,this.likeMap,this.flagMap)
},like:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.likeCount+=1;
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/LikeComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},unlike:function(b,c){var d=function(e){var f=this.getCommentById(b.id);
if(f){f.likeCount=Math.max(f.likeCount-1,0);
this.reformat()
}(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/UnlikeComment",secure:true,data:{commentId:b.id},success:d,failure:b.failure},this)
},flag:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.flagCount+=1;
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/FlagComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},_delete:function(b,c){var d=function(e){b.comments.forEach(function(f){this.removeCommentById(f.id)
},this);
this.visibleComments-=b.comments.length;
this.totalComments-=b.comments.length;
(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/admin/DeleteComments",secure:true,data:{markAsSpam:b.spam,comments:(a.Lang.isArray(b.comments)?b.comments:[b.comments])},success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},approve:function(b,c){var d=function(e){b.comments.forEach(function(g){var f=this.getCommentById(g.id);
if(f){f.status=a.Squarespace.CommentStatuses.APPROVED
}},this);
this.totalComments+=1;
(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/admin/ApproveComments",secure:true,data:{comments:(a.Lang.isArray(b.comments)?b.comments:[b.comments])},success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},unflag:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.flagCount=Math.max(g.flagCount-1,0);
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/UnflagComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},post:function(b,c){var e={targetId:this.target,targetType:this.targetType,body:b.body,replyToId:b.replyTo,authorName:(a.Squarespace.Escaping.escapeForHtml(b.name)||""),authorEmail:(b.email||""),authorUrl:(b.authorUrl||"")},d=function(f){if(f.comment.status===a.Squarespace.CommentStatuses.APPROVED){this.addCommentData(f.comment);
this.visibleComments+=1;
this.totalComments+=1;
if(!b.replyTo){this.topLevelComments+=1
}this.reformat()
}(b.success||noop).call((c||this),f)
};
a.Data.post({url:"/api/comment/CreateComment",secure:(!!Static.SQUARESPACE_CONTEXT.authenticatedAccount),data:e,success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},getPage:function(b,d,c){if(d<=this.numPages){this.get({sortBy:b.order,page:d,success:b.success,failure:b.failure},c)
}},getSince:function(b,d,c){this.get({since:d,success:b.success,failure:b.failure},c)
},getThread:function(c,d){var e=function(g){this.currentThreadRoot=c.commentId;
var f=g.comments[0].comment.depth;
g.comments=a.Array.map(g.comments,function(h){return h.comment
});
g.comments.forEach(function(h){h.depth=(h.depth-f)
});
this.formattedThread=this.formatter(g.comments,{},{});
if(a.Lang.isFunction(c.success)){c.success.call((d||this),g)
}},b=function(f){if(a.Lang.isFunction(c.failure)){c.failure.call((d||this),f)
}};
a.Data.get({url:"/api/comment/GetThread",secure:this.useSecure(),data:{sortBy:c.order,commentId:c.commentId},success:e,failure:b},this)
},get:function(b,c){var d=function(e){this.page=b.page;
if(b.page<=1){this.fullBookkeeping(e)
}else{if(b.page>1){this.appendBookkeeping(e)
}}if(b.success){b.success.call((c||this),e)
}};
a.Data.get({url:"/api/comment/GetComments",secure:this.useSecure(),data:{targetId:this.target,targetType:this.targetType,since:(b.since||""),page:b.page,sortBy:b.order},success:d,failure:b.failure},this)
},getLikesAndFlags:function(b,c){var d=a.Array.map(this.comments,function(f){return f.id
}),e;
a.Data.post({url:"/api/comment/GetLikesFlags",secure:this.useSecure(),data:{ids:d},success:function(f){if(b.success&&a.Lang.isFunction(b.success)){b.success.call((c||this),f)
}},failure:function(f){if(b.failure&&a.Lang.isFunction(b.failure)){b.failure.call((c||this),f)
}}})
}})
},"1.0",{requires:["squarespace-util"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
(function(){var b={};
b.converter=function(){var an;
var ae;
var W;
var af=0;
this.makeHtml=function(c){an=new Array();
ae=new Array();
W=new Array();
c=c.replace(/~/g,"~T");
c=c.replace(/\$/g,"~D");
c=c.replace(/\r\n/g,"\n");
c=c.replace(/\r/g,"\n");
c="\n\n"+c+"\n\n";
c=Y(c);
c=c.replace(/^[ \t]+$/mg,"");
c=ab(c);
c=ak(c);
c=L(c);
c=U(c);
c=c.replace(/~D/g,"$$");
c=c.replace(/~T/g,"~");
return c
};
var ak=function(c){var c=c.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(d,g,h,e,f){g=g.toLowerCase();
an[g]=ag(h);
if(e){return e+f
}else{if(f){ae[g]=f.replace(/"/g,"&quot;")
}}return""
});
return c
};
var ab=function(c){c=c.replace(/\n/g,"\n\n");
var d="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del";
var e="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";
c=c.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,I);
c=c.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,I);
c=c.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/\n\n/g,"\n");
return c
};
var I=function(e,d){var c=d;
c=c.replace(/\n\n/g,"\n");
c=c.replace(/^\n/,"");
c=c.replace(/\n+$/g,"");
c="\n\n~K"+(W.push(c)-1)+"K\n\n";
return c
};
var L=function(c){c=ai(c);
var d=Z("<hr />");
c=c.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,d);
c=c.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,d);
c=c.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,d);
c=O(c);
c=am(c);
c=M(c);
c=ab(c);
c=ah(c);
return c
};
var T=function(c){c=S(c);
c=ac(c);
c=aj(c);
c=N(c);
c=a(c);
c=aa(c);
c=ag(c);
c=al(c);
c=c.replace(/  +\n/g," <br />\n");
return c
};
var ac=function(c){var d=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;
c=c.replace(d,function(e){var f=e.replace(/(.)<\/?code>(?=.)/g,"$1`");
f=J(f,"\\`*_");
return f
});
return c
};
var a=function(c){c=c.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,R);
c=c.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,R);
c=c.replace(/(\[([^\[\]]+)\])()()()()()/g,R);
return c
};
var R=function(j,d,e,f,g,h,k,l){if(l==undefined){l=""
}var m=d;
var o=e;
var n=f.toLowerCase();
var p=g;
var i=l;
if(p==""){if(n==""){n=o.toLowerCase().replace(/ ?\n/g," ")
}p="#"+n;
if(an[n]!=undefined){p=an[n];
if(ae[n]!=undefined){i=ae[n]
}}else{if(m.search(/\(\s*\)$/m)>-1){p=""
}else{return m
}}}p=J(p,"*_");
var c='<a href="'+p+'"';
if(i!=""){i=i.replace(/"/g,"&quot;");
i=J(i,"*_");
c+=' title="'+i+'"'
}c+=">"+o+"</a>";
return c
};
var N=function(c){c=c.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,P);
c=c.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,P);
return c
};
var P=function(j,d,e,f,g,h,k,l){var m=d;
var n=e;
var o=f.toLowerCase();
var p=g;
var i=l;
if(!i){i=""
}if(p==""){if(o==""){o=n.toLowerCase().replace(/ ?\n/g," ")
}p="#"+o;
if(an[o]!=undefined){p=an[o];
if(ae[o]!=undefined){i=ae[o]
}}else{return m
}}n=n.replace(/"/g,"&quot;");
p=J(p,"*_");
var c='<img src="'+p+'" alt="'+n+'"';
i=i.replace(/"/g,"&quot;");
i=J(i,"*_");
c+=' title="'+i+'"';
c+=" />";
return c
};
var ai=function(c){c=c.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(f,e){return Z('<h1 id="'+d(e)+'">'+T(e)+"</h1>")
});
c=c.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,f){return Z('<h2 id="'+d(f)+'">'+T(f)+"</h2>")
});
c=c.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(f,g,h){var e=g.length;
return Z("<h"+e+' id="'+d(h)+'">'+T(h)+"</h"+e+">")
});
function d(e){return e.replace(/[^\w]/g,"").toLowerCase()
}return c
};
var X;
var O=function(c){c+="~0";
var d=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;
if(af){c=c.replace(d,function(e,h,i){var g=h;
var j=(i.search(/[*+-]/g)>-1)?"ul":"ol";
g=g.replace(/\n{2,}/g,"\n\n\n");
var f=X(g);
f=f.replace(/\s+$/,"");
f="<"+j+">"+f+"</"+j+">\n";
return f
})
}else{d=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;
c=c.replace(d,function(l,h,j,e){var i=h;
var g=j;
var k=(e.search(/[*+-]/g)>-1)?"ul":"ol";
var g=g.replace(/\n{2,}/g,"\n\n\n");
var f=X(g);
f=i+"<"+k+">\n"+f+"</"+k+">\n";
return f
})
}c=c.replace(/~0/,"");
return c
};
X=function(c){af++;
c=c.replace(/\n{2,}$/,"\n");
c+="~0";
c=c.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(d,j,k,e,f){var h=f;
var i=j;
var g=k;
if(i||(h.search(/\n{2,}/)>-1)){h=L(Q(h))
}else{h=O(Q(h));
h=h.replace(/\n$/,"");
h=T(h)
}return"<li>"+h+"</li>\n"
});
c=c.replace(/~0/g,"");
af--;
return c
};
var am=function(c){c+="~0";
c=c.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(f,d,e){var h=d;
var g=e;
h=K(Q(h));
h=Y(h);
h=h.replace(/^\n+/g,"");
h=h.replace(/\n+$/g,"");
h="<pre><code>"+h+"\n</code></pre>";
return Z(h)+g
});
c=c.replace(/~0/,"");
return c
};
var Z=function(c){c=c.replace(/(^\n+|\n+$)/g,"");
return"\n\n~K"+(W.push(c)-1)+"K\n\n"
};
var S=function(c){c=c.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(d,h,i,e,f){var g=e;
g=g.replace(/^([ \t]*)/g,"");
g=g.replace(/[ \t]*$/g,"");
g=K(g);
return h+"<code>"+g+"</code>"
});
return c
};
var K=function(c){c=c.replace(/&/g,"&amp;");
c=c.replace(/</g,"&lt;");
c=c.replace(/>/g,"&gt;");
c=J(c,"*_{}[]\\",false);
return c
};
var al=function(c){c=c.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");
c=c.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");
return c
};
var M=function(c){c=c.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(f,e){var d=e;
d=d.replace(/^[ \t]*>[ \t]?/gm,"~0");
d=d.replace(/~0/g,"");
d=d.replace(/^[ \t]+$/gm,"");
d=L(d);
d=d.replace(/(^|\n)/g,"$1  ");
d=d.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(i,h){var g=h;
g=g.replace(/^  /mg,"~0");
g=g.replace(/~0/g,"");
return g
});
return Z("<blockquote>\n"+d+"\n</blockquote>")
});
return c
};
var ah=function(g){g=g.replace(/^\n+/g,"");
g=g.replace(/\n+$/g,"");
var h=g.split(/\n{2,}/g);
var d=new Array();
var f=h.length;
for(var e=0;
e<f;
e++){var i=h[e];
if(i.search(/~K(\d+)K/g)>=0){d.push(i)
}else{if(i.search(/\S/)>=0){i=T(i);
i=i.replace(/^([ \t]*)/g,"<p>");
i+="</p>";
d.push(i)
}}}f=d.length;
for(var e=0;
e<f;
e++){while(d[e].search(/~K(\d+)K/)>=0){var c=W[RegExp.$1];
c=c.replace(/\$/g,"$$$$");
d[e]=d[e].replace(/~K\d+K/,c)
}}return d.join("\n\n")
};
var ag=function(c){c=c.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");
c=c.replace(/<(?![a-z\/?\$!])/gi,"&lt;");
return c
};
var aj=function(c){c=c.replace(/\\(\\)/g,ad);
c=c.replace(/\\([`*_{}\[\]()>#+-.!])/g,ad);
return c
};
var aa=function(c){c=c.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');
c=c.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,d){return V(U(d))
});
return c
};
var V=function(c){function d(h){var f="0123456789ABCDEF";
var g=h.charCodeAt(0);
return(f.charAt(g>>4)+f.charAt(g&15))
}var e=[function(f){return"&#"+f.charCodeAt(0)+";"
},function(f){return"&#x"+d(f)+";"
},function(f){return f
}];
c="mailto:"+c;
c=c.replace(/./g,function(f){if(f=="@"){f=e[Math.floor(Math.random()*2)](f)
}else{if(f!=":"){var g=Math.random();
f=(g>0.9?e[2](f):g>0.45?e[1](f):e[0](f))
}}return f
});
c='<a href="'+c+'">'+c+"</a>";
c=c.replace(/">.+:/g,'">');
return c
};
var U=function(c){c=c.replace(/~E(\d+)E/g,function(f,d){var e=parseInt(d);
return String.fromCharCode(e)
});
return c
};
var Q=function(c){c=c.replace(/^(\t|[ ]{1,4})/gm,"~0");
c=c.replace(/~0/g,"");
return c
};
var Y=function(c){c=c.replace(/\t(?=\t)/g,"    ");
c=c.replace(/\t/g,"~A~B");
c=c.replace(/~B(.+?)~A/g,function(f,i,d){var g=i;
var e=4-g.length%4;
for(var h=0;
h<e;
h++){g+=" "
}return g
});
c=c.replace(/~A/g,"    ");
c=c.replace(/~B/g,"");
return c
};
var J=function(g,e,d){var f="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";
if(d){f="\\\\"+f
}var c=new RegExp(f,"g");
g=g.replace(c,ad);
return g
};
var ad=function(e,c){var d=c.charCodeAt(0);
return"~E"+d+"E"
}
};
YUI.add("squarespace-markdown",function(a){a.namespace("Squarespace");
a.Squarespace.Lang.markdownToHTML=function(h){if(!h){return""
}var f=new b.converter();
var g=f.makeHtml(h);
return g
}
},"1.0",{requires:["squarespace-util"]})
})();/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-dialog-field-legacy-interface",function(b){var a=b.namespace("Squarespace").DialogFieldLegacyInterface=function(c){this.inActiveFrame=true;
if(b.Lang.isFunction(this.hideError)){b.Do.after(function(){var d=c.dialog;
if(d){d.clearError(this)
}},this,"hideError",this)
}b.Do.after(function(){this.after(this.get("id")+"|dataChange",function(f){var d=c.dialog;
if(d){d.fire("datachange",this)
}var g=this.get("name");
if(g){this.fire("value-changed",{name:g,value:f.newVal,oldValue:f.prevVal,field:this})
}},this)
},this,"bindUI",this);
b.Do.after(function(){if(c&&c.defaultHidden){this.hide(true)
}},this,"syncUI",this)
};
a.NAME="dialogFieldLegacyInterface";
a.prototype={temporaryHide:function(){this.hide()
},temporaryShow:function(){this.show()
},getName:function(){return this.get("name")
},getType:function(){return this.name
},getValue:function(){return this.get("data")
},getErrors:function(){return this.get("errors")
},getNode:function(){return this.get("boundingBox")
},setValue:function(c){this.set("data",c)
},clearError:function(){this.hideError()
}}
},"1.0");/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-flyout-error-message-template",function(c){var b=c.Handlebars;
(function(){var e=b.template,d=b.templates=b.templates||{};
d["flyout-error-message.html"]=e(function(l,m,i,g,j){this.compilerInfo=[2,">= 1.0.0-rc.3"];
i=i||l.helpers;
j=j||{};
var f="",h,k="function";
f+='<div class="sqs-flyout-error-message">';
if(h=i.message){h=h.call(m,{hash:{},data:j})
}else{h=m.message;
h=typeof h===k?h.apply(m):h
}if(h||h===0){f+=h
}f+="</div>";
return f
})
})();
var a="flyout-error-message.html";
c.Handlebars.registerPartial(a.replace("/","."),b.templates[a])
},"1.0",{requires:["handlebars-base"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-attr-validators",function(a){var b=a.namespace("Squarespace").AttrValidators={isBoolean:function(c){if(!a.Lang.isBoolean(c)){console.error('"'+c+'" is not a boolean');
return false
}else{return true
}},isNumber:function(c){if(!a.Lang.isNumber(c)){console.error('"'+c+'" is not a number');
return false
}else{return true
}},isString:function(c){if(!a.Lang.isString(c)){console.error('"'+c+'" is not a string');
return false
}else{return true
}},isNonArrayObject:function(c){if(a.Lang.isArray(c)){console.error('"'+c+'" is an array, not a hash.');
return false
}else{if(!a.Lang.isObject(c)){console.error('"'+c+'" is not an object');
return false
}else{return true
}}},isObject:function(c){if(!a.Lang.isObject(c)){console.error('"'+c+'" is not an object');
return false
}else{return true
}},isArray:function(c){if(!a.Lang.isArray(c)){console.error('"'+c+'" is not an an Array');
return false
}else{return true
}},isFunction:function(c){if(!a.Lang.isFunction(c)){console.error('"'+c+'" is not a function.');
return false
}else{return true
}},isNullOr:function(c){if(!a.Lang.isFunction(c)){console.error("The validator function argument is required.");
return false
}return function(d){if(a.Lang.isNull(d)){return true
}else{return c(d)
}}
},isInstanceOf:function(c){if(!c){console.error(c);
console.error("Constructor object to check against was falsy.");
return false
}return function(d){if(d instanceof c){return true
}else{console.error('"'+d+'" is not an intance of "'+c+'".');
return false
}}
},isTypeOf:function(c){if(!c){console.error("Type string to check against was falsy. Type was:",c);
return false
}return function(d){if((typeof d)===c){return true
}else{console.error('"'+d+'" is not of type "'+c+'".');
return false
}}
},isValueIn:function(c){if(!c){console.error(c);
console.error("Constants object to check against was falsy.");
return false
}return function(d){if(a.Object.values(c).indexOf(d)!==-1){return true
}else{console.error('"'+d+'" is not a valid constant of that type.');
return false
}}
}};
b.isNullOrInstanceOf=function(c){return b.isNullOr(b.isInstanceOf(c))
};
b.isNullOrOfType=function(c){return b.isNullOr(b.isTypeOf(c))
};
b.isDate=b.isInstanceOf(Date);
b.isNullOrString=b.isNullOr(b.isString);
b.isNullOrDate=b.isNullOr(b.isDate);
b.isNullOrBoolean=b.isNullOr(b.isBoolean);
b.isNullOrNumber=b.isNullOr(b.isNumber);
b.isNullOrObject=b.isNullOr(b.isObject);
b.isNullOrNonArrayObject=b.isNullOr(b.isNonArrayObject);
b.isNullOrArray=b.isNullOr(b.isArray);
b.isNullOrFunction=b.isNullOr(b.isFunction)
},"1.0",{requires:["base-base"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-dialog-field-2",function(b){var a="error";
b.Squarespace.Widgets.DialogField2=b.Squarespace.DialogField2=b.Base.create("dialogField",b.Squarespace.Widgets.DataWidget,[b.Squarespace.DialogFieldLegacyInterface,b.WidgetParent,b.WidgetChild],{initializer:function(c){this._saveInitialData(c?c.data:null)
},destructor:function(){this._destroyError();
this.unplug(b.Plugin.WidgetAnim)
},_destroyError:function(){if(this._errorNode){this._errorNode.remove(true);
this._errorNode=null
}},_saveInitialData:function(c){c=b.Lang.isUndefined(c)?this.get("data"):c;
if(b.Lang.isArray(c)&&this.get("cloneInitialData")){this._initialData=c.slice()
}else{if(b.Lang.isObject(c)&&this.get("cloneInitialData")){this._initialData=b.clone(c,true)
}else{this._initialData=c
}}},setCurrentDataAsInitial:function(){this._saveInitialData()
},renderUI:function(){b.Squarespace.DialogField2.superclass.renderUI.call(this);
var c=this.get("name");
if(c){this.get("boundingBox").addClass("name-"+c)
}},scrollIntoView:function(){this.get("contentBox").scrollIntoView()
},showError:function(g){if(!g||!this.get("rendered")){return
}var e=this.get("boundingBox"),d=this.get("contentBox"),f=this.get("errorFlyoutAnchor")||d;
if(!f.hasPlugin("flyoutPlugin")){f.plug(b.Squarespace.Animations.Flyout,{duration:0.3})
}var c=f.flyoutPlugin;
var h=b.bind(function(){e.addClass(a);
this._destroyError();
this._errorNode=b.Squarespace.UITemplates.renderAsNodeOrDocFrag("flyout-error-message.html",{message:g});
var m=this.get("dialog");
if(m){this._errorNode.setStyle("zIndex",m.zIndex+10)
}this._errorNode.on(this.get("id")+"|click",function(o){o.halt();
this.hideError()
},this);
var l=b.one(window).get("region").right,k=b.Squarespace.Utils.measureNode(this._errorNode).width,j=f.get("region").right+k,i=j>l;
if(i){this._errorNode.addClass("out-from-left")
}c.setAttrs({node:this._errorNode,alignment:i?"lt":"rt"});
this._clearErrorSub=b.on(this.get("id")+"|click",this.hideError,this);
var n=this.get("id");
c.once(n+"|shown",function(o){this.fire("error-shown")
},this);
f.once("shown",function(o){this._errorNode.setStyle("width","100%")
},this);
c.show()
},this);
if(c.get("visible")){if(this._showErrorSub){this._showErrorSub.detach()
}this._showErrorSub=c.once(this.get("id")+"|hidden",function(){this._showErrorSub=null;
h()
},this);
c.hide()
}else{h()
}},hideError:function(){if(!this.get("rendered")){return
}var e=this.get("boundingBox");
var d=this.get("contentBox");
var f=this.get("errorFlyoutAnchor")||d;
if(!f.hasPlugin("flyoutPlugin")||!f.flyoutPlugin.get("visible")){return
}if(this._clearErrorSub){this._clearErrorSub.detach()
}var c=f.flyoutPlugin;
c.once(this.get("id")+"|hidden",function(g){e.removeClass(a);
this.fire("error-hidden");
this._destroyError()
},this);
c.hide()
},didDataChange:function(){var c=this.get("data");
if(b.Lang.isArray(this._initialData)){return b.JSON.stringify(this._initialData)!==b.JSON.stringify(c)
}if(b.Lang.isObject(this._initialData)){throw"DialogField base class will not compare objects. Define didDataChange for this field."
}return this._initialData!==c
},isEmpty:function(){var c=this.get("data");
return c===""||c===0
},revert:function(){this.set("data",this._initialData,{revert:true})
},_getErrors:function(){return[]
},isValid:function(){return this.get("errors").length>0
}},{CSS_PREFIX:"sqs-dialog-field",ATTRS:{cloneInitialData:{value:true},strings:{},name:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},dialog:{value:null,validator:function(c){if(b.Lang.isNull(c)){return true
}if(!(c instanceof b.Squarespace.EditingDialog||c.constructor instanceof b.Squarespace.EditingDialog.constructor)){console.warn(this.name+": Not an EditingDialog");
return false
}else{return true
}}},required:{value:false,validator:b.Squarespace.AttrValidators.isBoolean},errors:{value:[],readOnly:true,getter:"_getErrors",validator:b.Squarespace.AttrValidators.isArray},errorFlyoutAnchor:{value:null,readOnly:true,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Node)}}})
},"1.0",{requires:["base-build","widget-child","widget-parent","widget-anim","json-stringify","squarespace-util","squarespace-ss-widget","squarespace-dialog-field-legacy-interface","squarespace-animations","squarespace-flyout-error-message-template","squarespace-attr-validators"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-dialog-hidden",function(b){var a=function(){};
b.namespace("Squarespace.DialogFields").Hidden=b.Base.create("hidden",b.Squarespace.DialogField2,[],{initializer:function(){this.unplug(b.Plugin.WidgetAnim)
},focus:null,enable:null,disable:null,blur:null,renderUI:a,bindUI:a,syncUI:a},{CSS_PREFIX:"sqs-hidden",ATTRS:{visible:{value:false}}});
b.Squarespace.DialogFields.HiddenField=b.Squarespace.DialogFields.Hidden
},"1.0",{requires:["base","base-build","squarespace-dialog-field-2"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-login",function(a){if(!window.SQUARESPACE_LOGIN){window.SQUARESPACE_LOGIN=Singleton.create({ready:function(){if(Static.SQUARESPACE_CONTEXT){this.account=Static.SQUARESPACE_CONTEXT.authenticatedAccount
}this.defaultParams={redirectAfterCancel:true,redirectAfterLogin:true,minimal:false,cancelable:true,overlayOpacity:0.8,disableOverlayCancel:false,forgotPassword:true,disableCreateAccount:true,globalLogin:true,allowSocialLogins:true};
this.params=this.defaultParams;
this.dialogParameters=null
},configure:function(b){this.params=this.defaultParams;
this.params=a.merge(this.params,b)
},reset:function(){this.params=this.defaultParams
},isLoggedIn:function(){return !!this.account
},getAccount:function(){return this.account
},toggle:function(){if(this.loginDialog&&this.loginDialog.isVisible()){this.loginDialog.cancel()
}else{this.show()
}},buildDialog:function(){this.dialogParameters={style:"flyout",discardChangesConfirmation:false,overlay:this.params.overlayOpacity,width:400,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,tabs:[{title:"Squarespace Login",icon:"/universal/images-v6/dialog/login-icon.png?4",fields:[{type:"multi-frame",name:"login-method-frame",initialFrame:"squarespace",frames:{squarespace:{fields:[{type:"text",required:true,name:"email",title:"Login or Email",titleStyle:"inline",submitOnEnter:true,mailcheck:true,style:"major"},{type:"text",required:true,name:"password",password:true,title:"Password",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"splitter",fields:[{type:"check",width:0.65,required:true,name:"remember",title:"Stay Signed In",padding:[5,0],description:"Keep you signed in for 2 weeks."},{type:"link",width:0.35,name:"passwordReset",className:"forgotpassword",title:"Forgot Password?",align:"right",padding:[0,0]}]}]},facebook:{fields:[{type:"description",name:"facebook-login",text:'<div class="facebook-login-button"></div><div class="big-login-caption">Click above to be redirected to Facebook.</div>'}]},twitter:{fields:[{type:"description",name:"twitter-login",text:'<div class="twitter-login-button"></div><div class="big-login-caption">Click above to be redirected to Twitter.</div>'}]},google:{fields:[{type:"description",name:"google-login",text:'<div class="google-login-button"></div><div class="big-login-caption">Click above to be redirected to Google.</div>'}]}}},{type:"hidden",name:"inviteCode"},{type:"hidden",name:"srcUrl"}]}]};
if(this.params.allowSocialLogins){this.dialogParameters.tabs[0].fields.splice(0,0,{type:"multi-option",name:"login-method",linkFrame:"login-method-frame",defaultValue:"squarespace",titleStyle:"top",padding:[0,20],optionPadding:"45px 0 15px 0",iconDropPx:8,options:[{icon:"/universal/images-v6/dialog/login-squarespace.png",title:"Squarespace",value:"squarespace"},{icon:"/universal/images-v6/dialog/login-twitter.png",title:"Twitter",value:"twitter"},{icon:"/universal/images-v6/dialog/login-facebook.png",title:"Facebook",value:"facebook"},{icon:"/universal/images-v6/dialog/login-google.png",title:"Google",value:"google"}]});
this.dialogParameters.width=460
}else{this.dialogParameters.width=400
}if(this.params.minimal){this.dialogParameters.style="transparent";
this.dialogParameters.top=300;
this.dialogParameters.buttons=[(this.params.cancelable?{type:"cancel",title:"Cancel"}:null),(!this.params.disableCreateAccount?{type:"createAccount",title:"Create Squarespace Account"}:null),{type:"saveAndClose",title:"Login"}]
}else{this.dialogParameters.buttons=[(!this.params.disableOverlayCancel?{type:"cancel",title:"Cancel"}:null),(!this.params.disableCreateAccount?{type:"createAccount",title:"Create Squarespace Account"}:null),{type:"saveAndClose",title:"Login"}]
}},buildCommentDialog:function(b,c,d){this.dialogParameters={name:"comment",style:"flyout",discardChangesConfirmation:false,overlay:this.params.overlayOpacity,width:460,height:275,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,tabs:[{title:b,icon:"/universal/images-v6/standard/icon_comments_24_light.png",fields:[{type:"hidden",name:"inviteCode"},{type:"hidden",name:"srcUrl"},{type:"multi-option",name:"login-method",linkFrame:"login-method-frame",defaultValue:"squarespace",titleStyle:"top",padding:[0,20],optionPadding:"45px 0 15px 0",iconDropPx:8,options:[{icon:"/universal/images-v6/dialog/login-squarespace.png",title:"Squarespace",value:"squarespace"},{icon:"/universal/images-v6/dialog/login-twitter.png",title:"Twitter",value:"twitter"},{icon:"/universal/images-v6/dialog/login-facebook.png",title:"Facebook",value:"facebook"},{icon:"/universal/images-v6/dialog/login-google.png",title:"Google",value:"google"}]},{type:"multi-frame",name:"login-method-frame",initialFrame:"squarespace",frames:{squarespace:{fields:[{type:"text",required:true,name:"email",title:"Email Address",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"text",required:true,name:"password",password:true,title:"Password",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"splitter",fields:[{type:"check",width:0.7,required:true,name:"remember",title:"Stay Signed In",padding:[5,0],description:"Keep you signed in for 2 weeks."},{type:"link",width:0.3,name:"passwordReset",className:"forgotpassword",title:"Forgot Password?",align:"right"}]}]},facebook:{fields:[{type:"description",name:"facebook-login",text:'<div class="facebook-login-button"></div><div class="big-login-caption">Click above to be redirected to Facebook.</div>'}]},twitter:{fields:[{type:"description",name:"twitter-login",text:'<div class="twitter-login-button"></div><div class="big-login-caption">Click above to be redirected to Twitter.</div>'}]},google:{fields:[{type:"description",name:"google-login",text:'<div class="google-login-button"></div><div class="big-login-caption">Click above to be redirected to Google.</div>'}]}}}]}]};
if(this.params.minimal){this.dialogParameters.style="transparent";
this.dialogParameters.width=460;
this.dialogParameters.height=275;
this.dialogParameters.top=300;
this.dialogParameters.buttons=[{type:"createAccount",title:"Create Squarespace Account"},{type:"saveAndClose",title:"Login"}]
}else{this.dialogParameters.buttons=[(!this.params.disableOverlayCancel?{type:"cancel",title:"Cancel"}:null),{type:"createAccount",title:"Create Squarespace Account"},{type:"saveAndClose",title:(c||"Login")}]
}if(d){this.dialogParameters.tabs[0].fields.forEach(function(e){if(e.name==="login-method"){e.defaultValue="guest";
e.options.unshift({icon:"/universal/images-v6/dialog/login-guest.png",title:"Guest",value:"guest"})
}if(e.name==="login-method-frame"){e.initialFrame="guest";
e.frames.guest={fields:[{type:"text",name:"displayName",required:true,title:"Your Name",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"text",name:"anonEmail",title:"Email (Optional)",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,mailcheck:true,style:"major"},{type:"text",required:false,name:"authorUrl",title:"Website URL (Optional)",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"}]}
}},this)
}},showCommentLogin:function(b,d,c){this.params.redirectAfterLogin=false;
this.params.redirectAfterCancel=false;
if(this.loginDialog){this.loginDialog=null;
this.dialogParameters=null
}this.buildCommentDialog(b,d,c);
this.show()
},show:function(){a.use("squarespace-dialog","squarespace-external-authentication","squarespace-dialog-hidden",a.bind(function(b){if(this.loginDialog&&this.loginDialog.isVisible()){return
}if(this.loginDialog){this.loginDialog.destroy();
this.loginDialog=null;
this.dialogParameters=null
}if(this.dialogParameters===null){this.buildDialog()
}this.loginDialog=new b.Squarespace.EditingDialog(this.dialogParameters);
this.loginDialog.on(["cancel","overlay-click"],function(){window.SQUARESPACE_LOGIN.fire("cancel");
this.reset()
},this);
this.loginDialog.on("loading",function(){var c=b.Cookie.get("email");
if(window.SQUARESPACE_LOGIN.params.inviteCode){window.SQUARESPACE_LOGIN.showBigText("login");
c=this.params.invitation.email;
this.params.redirectAfterLogin=true
}if(c){this.loginDialog.setInitialData({email:c,inviteCode:window.SQUARESPACE_LOGIN.params.inviteCode,remember:true})
}else{this.loginDialog.setInitialData({inviteCode:window.SQUARESPACE_LOGIN.params.inviteCode,remember:true})
}},this);
this.loginDialog.on("click",function(c){if(!this.externalAuth){this.externalAuth=new b.Squarespace.ExternalAuthentication({loginFlag:true});
this.externalAuth.on("completed",function(){b.Data.post({url:"/api/auth/CheckAuthentication",secure:true,data:{srcUrl:document.location.href},success:function(d){Static.SQUARESPACE_CONTEXT.permissions=d.permissions;
if(d.member){this.close();
Static.SQUARESPACE_CONTEXT.authenticatedAccount=d.member;
window.SQUARESPACE_LOGIN.onLoginComplete(d.member,d.redirectUrl)
}}},this)
},this)
}if(c.target.ancestor(".twitter-login-button",true)){this.externalAuth.openPopupWindow("","",b.Squarespace.ExternalServiceProviders.TWITTER)
}else{if(c.target.ancestor(".facebook-login-button",true)){this.externalAuth.openPopupWindow("","",b.Squarespace.ExternalServiceProviders.FACEBOOK)
}else{if(c.target.ancestor(".google-login-button",true)){this.externalAuth.openPopupWindow("","",b.Squarespace.ExternalServiceProviders.GOOGLEAUTH2)
}}}});
this.loginDialog.on("button-createAccount",function(){this.loginDialog.temporaryHide();
this.createSquarespaceAccount()
},this);
this.loginDialog.on("link-passwordReset",function(){this.loginDialog.temporaryHide();
var c=this.loginDialog.getData();
this.passwordReset(c.email)
},this);
this.loginDialog.on("datachange",function(){if(!this.getData().remember){b.Cookie.remove("email")
}this.hideErrors()
});
this.loginDialog.on("cancel",function(){if(this.params.redirectAfterCancel&&!SQUARESPACE_LOGIN.params.externalSwitcher){document.location.href="http://"+document.location.host+"/"
}});
this.loginDialog.on("send-requested",function(){var e=this.loginDialog.getData();
if(e["login-method"]==="guest"){var c=new Date();
c.setSeconds(c.getSeconds()+30);
b.Cookie.set("email",e.anonEmail,{path:"/",expires:c});
b.Cookie.set("displayName",e.displayName,{path:"/",expires:c});
b.Cookie.set("websiteUrl",e.authorUrl,{path:"/",expires:c});
this.loginDialog.close();
this.fire("guestLogin")
}else{if(e.email.indexOf("@")===-1){b.use("thirdparty-sha1",b.bind(function(g){var f=b64_sha1(e.password);
if(g.UA.ie>=10){this.loginRPCProvider.v5login(e.email,f)
}else{this._v5login(e.email,f)
}},this))
}else{var d=this.loginDialog.getField("srcUrl");
if(d&&this.loginDialog.getName()!=="comment"){d.setValue(document.location.href)
}b.Data.sendForm(this.loginDialog,{url:"/api/auth/Login",secure:true,success:function(f){if(e.remember){b.Cookie.set("email",e.email,{path:"/",expires:new Date("January 1, 2030")})
}b.Cookie.remove("displayName");
Static.SQUARESPACE_CONTEXT.permissions=f.permissions;
Static.SQUARESPACE_CONTEXT.managedWebsites=f.managedWebsites;
Static.SQUARESPACE_CONTEXT.authenticatedAccount=f.account;
this.loginDialog.close();
this.onLoginComplete(f.account,f.redirectUrl)
}},this)
}}},this);
this.loginDialog.setInitialData({"login-method":"squarespace",login:Static.SQUARESPACE_CONTEXT.website.identifier,password:"",remember:false,inviteCode:Static.SQUARESPACE_CONTEXT.inviteCode});
if(!this.loginDialog.isVisible()){this.loginDialog.show();
this.loginDialog.once("shown",function(){this.loginDialog.getField("email").focus()
},this)
}},this))
},createSquarespaceAccount:function(){if(!this.createAccountDialog){var d={loadingText:"Loading...",savingText:"Submitting...",closingText:"",style:"flyout",overlay:this.params.overlayOpacity,width:460,top:200,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,title:"Create Squarespace Account",buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Create Login"}],tabs:[{title:"",fields:[{type:"description",text:"<strong>Below you can sign up for a Squarespace account.</strong>  Squarespace accounts let you keep a profile for editing and commenting on Squarespace websites.",padding:[0,15]},{type:"splitter",fields:[{type:"text",width:0.5,required:true,name:"firstName",title:"First Name",style:"title",titleStyle:"inline",submitOnEnter:true},{type:"text",width:0.5,required:true,name:"lastName",title:"Last Name",style:"title",titleStyle:"inline",submitOnEnter:true}]},{type:"text",required:true,name:"email",title:"your@email.com",style:"title",titleStyle:"inline",submitOnEnter:true},{type:"text",required:true,name:"password",password:true,title:"Password",style:"title",titleStyle:"inline",submitOnEnter:true}]}]};
if(this.params.minimal){d.style="transparent";
d.tabs[0].fields[0]=null;
d.top=260
}else{d.style=null;
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png"
}this.createAccountDialog=new a.Squarespace.EditingDialog(d);
this.createAccountDialog.on("loading",function(){this.showBigText("create")
},this);
this.createAccountDialog.on("cancel",function(){this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.createAccountDialog.on("send-requested",function(){var c=this.createAccountDialog.getData();
a.Data.sendForm(this.createAccountDialog,{url:"/api/auth/CreateSquarespaceAccount",secure:true,success:function(e){this.createAccountDialog.close();
this.loginDialog.temporaryShow();
this.loginDialog.getField("email").setValue(c.email);
this.loginDialog.getField("password").setValue(c.password);
this.loginDialog.save()
}},this)
},this)
}if(this.params.invitation){var b={email:this.params.invitation.email};
this.createAccountDialog.setInitialData(b)
}this.createAccountDialog.show()
},passwordReset:function(b){if(!this.passwordResetDialog){var d={subtext:"Squarespace",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Send Email"}],tabs:[{title:"",fields:[{type:"description",text:"Please enter the email address that you used when creating your account.  An email will be sent to that address with further instructions on how to reset your password."},{type:"text",required:true,name:"email",password:false,title:"your@email.com",style:"title",titleStyle:"inline",submitOnEnter:true}]}]};
d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
this.passwordResetDialog=new a.Squarespace.EditingDialog(d);
this.passwordResetDialog.on("loading",function(){},this);
this.passwordResetDialog.on("cancel",function(){this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.passwordResetDialog.on("send-requested",function(){var c=this.passwordResetDialog.getData();
a.Data.sendForm(this.passwordResetDialog,{url:"/api/auth/PasswordReset",secure:true,success:function(e){this.passwordResetDialog.close();
this.passwordResetDone(e)
},failure:function(e){}},this)
},this)
}this.passwordResetDialog.setInitialData({email:(b?b:"")});
this.passwordResetDialog.show()
},passwordResetDone:function(b){var d={subtext:"Squarespace",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[{type:"done",title:"Back to Login"}],tabs:[{title:"",fields:[{type:"description",text:"You have been sent an email with further instructions on resetting your password."}]}]};
d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
this.passwordResetDialogDone=new a.Squarespace.EditingDialog(d);
this.passwordResetDialogDone.on("button-done",function(){this.passwordResetDialogDone.close();
this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.passwordResetDialogDone.show()
},getPasswordResetDialogParams:function(b){var d={loadingText:"Loading...",savingText:"",closingText:"",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[(b.invalidRecoveryId?{type:"login",title:"Back To Login"}:{type:"saveAndClose",title:"Update"})],tabs:[{title:"",fields:[]}]};
if(b.invalidRecoveryId){d.tabs[0].fields=[{type:"description",text:"This URL is no longer valid, please go back to login and start over."}]
}else{d.tabs[0].fields=[{type:"description",text:"Hi, <strong>"+b.displayName+"</strong>"},{type:"description",text:"Please enter your new account password for the account with email: <strong>"+b.email+"</strong>."},{type:"text",required:true,name:"password",password:true,title:"New Password",style:"title",titleStyle:"inline",submitOnEnter:true}]
}d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
return d
},bindPasswordResetDialog:function(b,c){b.on("button-login",function(){document.location.replace(document.location.pathname)
});
b.on("send-requested",function(){var d=this.dialog.getData();
d.email=this.params.email;
d.recoveryId=this.params.recoveryId;
a.Data.sendForm(this.dialog,{data:d,url:"/api/auth/PasswordReset",secure:true,success:function(e){this.dialog.close();
document.location.replace(document.location.pathname)
},failure:function(e){}},{that:this.that,dialog:b})
},{dialog:b,params:c})
},passwordResetConfirmation:function(d){var e=this.getPasswordResetDialogParams(d);
var b=new a.Squarespace.EditingDialog(e);
this.bindPasswordResetDialog(b,d);
b.show()
},accountActivationConfirmation:function(d){d.recoveryId=d.activationId;
var e=this.getPasswordResetDialogParams(d);
if(!d.invalidRecoveryId){e.tabs[0].fields=[{type:"description",text:"Welcome, <strong>"+d.displayName+"</strong>"},{type:"description",text:"To Activate your account you need to first set your account password associated with the email: <strong>"+d.email+"</strong>."},{type:"text",required:true,name:"password",password:true,title:"New Password",style:"title",titleStyle:"inline",submitOnEnter:true}];
e.tabs[0].title="Activate Account"
}var b=new a.Squarespace.EditingDialog(e);
this.bindPasswordResetDialog(b,d);
b.show()
},showBigText:function(b){if(b==="login"){if(a.one(".bigtext")){a.one(".bigtext").one(".title").set("innerHTML","Accept Invitation");
a.one(".bigtext").one(".description").set("innerHTML","You have been invited to manage this account by <strong>"+this.params.invitingMember.displayName+"</strong>.  <br/>Sign in or create an account below to get started.")
}}else{if(b==="create"){if(a.one(".bigtext")){a.one(".bigtext").one(".title").set("innerHTML","Create Account");
a.one(".bigtext").one(".description").set("innerHTML","Use this form to create a new Squarespace account for use across our system.")
}}}},onLoginComplete:function(d,c){window.SQUARESPACE_LOGIN.account=d;
var b=a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG);
if(SQUARESPACE_LOGIN.loginRPCProvider&&c){window.SQUARESPACE_LOGIN.fire("iframeLogin",c)
}else{if(this.params.redirectAfterLogin||this.params.reloadAfterLogin){if(c){if(c===window.location.href){window.location.reload()
}else{window.location.replace(c)
}return
}else{new a.Squarespace.Alert().show("No Administrative Privileges","Your Squarespace account is not listed as an administrator on any sites.")
}}else{window.SQUARESPACE_LOGIN.fire("login");
if(this.params.globalLogin){a.Global.fire("squarespace:login")
}this.reset()
}}},logout:function(b){if(b){b.halt()
}if(this.loggingOut||!Static.SQUARESPACE_CONTEXT.authenticatedAccount){return
}this.loggingOut=true;
a.Data.post({url:"/api/auth/Logout",secure:true,success:function(c){this.account=null;
delete window.SQUARESPACE_LOGIN.account;
delete Static.SQUARESPACE_CONTEXT.authenticatedAccount;
delete Static.SQUARESPACE_CONTEXT.permissions;
window.SQUARESPACE_LOGIN.fire("logout");
a.Global.fire("squarespace:logout");
if(this.memberAccount&&this.memberAccount.editor){this.memberAccount.editor.close()
}a.all(".sqs-layout[data-type=block-field]").each(function(e){var d=e.getData("layoutengine");
if(d){d.destroy()
}e.removeClass("editing")
});
document.location.href="http://"+document.location.host+"/?logout=true";
this.loggingOut=false
}},this)
},_v5login:function(e,d){var c="squarespace.com";
var b=this.loginDialog||this.loginRPCConsumer;
a.Data.post({xdr:{credentials:true},url:"http://squarespace5."+c+"/process/service/CredentialCheck",data:{A:e,B:d,from6:true},success:function(f){a.Data.post({xdr:{credentials:true},url:"http://"+e+"."+c+"/process/Login",data:{username:e,encryptedPassword:d,from6:true},success:function(g){if(g.result==="success"){top.location.replace("http://"+e+"."+c);
return
}},failure:function(g){b.showErrors(g.errors)
}},this)
},failure:function(g){if(g.errors){b.showErrors(g.errors)
}else{var f={password:"There was an unexpected error. Please try again later."};
b.showErrors(f)
}}},this)
},_showErrors:function(b){this.loginDialog.showErrors(b)
},_buildIFrameLoginDialog:function(){this.buildDialog();
this.dialogParameters.overlay=0.8
},_showLoginInIframe:function(b,d,c){SQUARESPACE_LOGIN.params.disableCreateAccount=true;
SQUARESPACE_LOGIN.params.externalSwitcher=true;
SQUARESPACE_LOGIN.params.allowSocialLogins=false;
if(this.loginDialog){this.loginDialog=null;
this.dialogParameters=null
}this._buildIFrameLoginDialog(b,d,c);
this.show();
SQUARESPACE_LOGIN.on("cancel",function(){SQUARESPACE_LOGIN.loginRPCProvider.hide()
});
SQUARESPACE_LOGIN.on("iframeLogin",function(f){f=f+"&redirectUrl=/config/iframelogin";
var e=a.Node.create('<iframe style="position:fixed; top:-2000px;" src="'+f+'"></div>');
e.on("load",function(){var g=f.substring(0,f.indexOf("/",10));
SQUARESPACE_LOGIN.loginRPCProvider.redirect(g+"/config")
});
a.one("body").append(e)
})
},loadRPCProvider:function(){try{this.loginRPCProvider=new easyXDM.Rpc({},{local:{show:function(){SQUARESPACE_LOGIN._showLoginInIframe()
},showErrors:a.bind(this._showErrors,this)},remote:{redirect:{},hide:{},remove:{},v5login:{}}})
}catch(b){console.log("failed to load RPC",b)
}},_loadRPCConsumer:function(b){this.loginRPCConsumer=new easyXDM.Rpc({remote:"https://oauth."+Static.SQUARESPACE_CONTEXT.appDomain+"/config/iframeLogin",container:b,props:{style:{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:30040}}},{local:{redirect:function(c){window.location.replace(c)
},hide:function(){SQUARESPACE_LOGIN.iFrameLoginHide()
},remove:function(){SQUARESPACE_LOGIN.iFrameLoginRemove()
},v5login:a.bind(this._v5login,this)},remote:{show:{},showErrors:{}}})
},iFrameLoginLoad:function(){var b=a.Node.create('<div class="login-wrapper hidden" ></div>');
a.one("body").append(b);
this._loadRPCConsumer(b.getDOMNode())
},iFrameLoginShow:function(b){if(b){b.preventDefault()
}if(!this.loginRPCConsumer){SQUARESPACE_LOGIN.iFrameLoginLoad()
}this.loginRPCConsumer.show();
a.one(".login-wrapper").removeClass("hidden")
},iFrameLoginHide:function(){a.one(".login-wrapper").addClass("hidden")
},iFrameLoginRemove:function(){this.loginRPCConsumer.destroy();
delete this.loginRPCConsumer;
a.one(".login-wrapper").remove()
}});
a.augment(window.SQUARESPACE_LOGIN,a.EventTarget)
}},"1.0",{requires:["squarespace-util","squarespace-dialog-hidden","squarespace-enum","thirdparty-easyxdm","ui-base-css"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-json-template",function(V){V.namespace("JSONTemplate");
var K="apply ";
function X(a){return a.replace(/([\{\}\(\)\[\]\|\^\$\-\+\?])/g,"\\$1")
}var Z={};
function C(e,c){var a=e+c;
var d=Z[a];
if(d===undefined){var b="("+X(e)+"\\S.*?"+X(c)+"\n?)";
d=new RegExp(b,"g")
}return d
}V.JSONTemplate.DEFAULT_FORMATTERS=V.Squarespace.TEMPLATE_FORMATTERS;
V.JSONTemplate.DEFAULT_PREFIX_FORMATTERS=[].concat(V.Squarespace.TEMPLATE_PREFIX_FORMATTERS,[{name:"pluralize",func:function(c,e,a){var d,b;
switch(a.length){case 0:d="";
b="s";
break;
case 1:d="";
b=a[0];
break;
case 2:d=a[0];
b=a[1];
break;
default:throw {name:"EvaluationError",message:"pluralize got too many args"}
}return(c==1)?d:b
}},{name:"encode-space",func:function(b,c,a){return b.replace(/\s/g,"&nbsp;")
}},{name:"truncate",func:function(c,d,e){var a=e[0]||100;
var b=e[1]||"...";
if(c&&c.length>a){c=c.substring(0,a);
c=c.replace(/\w+$/,"");
c+=b
}return c
}},{name:"date",func:function(f,d,h){var a=0;
var e=new Date(f).getTimezoneOffset();
if(!V.Lang.isNumber(f)){return"Invalid date."
}if(typeof TimezoneJS!=="undefined"){var i;
try{i=new TimezoneJS.Date(f,d.get("website.timeZone"))
}catch(j){return"Invalid Timezone"
}a=(isNaN(i.getTimezoneOffset())?0:i.getTimezoneOffset())-e
}else{var k=-parseInt(d.get("website.timeZoneOffset"),10)/60000;
var b=new Date().getTimezoneOffset();
a=k-b
}var c=new Date(f-(a*60000));
var g=h.join(" ");
return V.DataType.Date.format(c,{format:g})
}},{name:"image",func:function(b,c,d){var a;
if(b.mediaFocalPoint){a=b.mediaFocalPoint.x+","+b.mediaFocalPoint.y
}return'<img class="'+(d[0]?d[0]:"thumb-image")+'" '+(b.title?'alt="'+V.Squarespace.Escaping.escapeForHtmlTag(b.title)+'" ':"")+' data-image="'+b.assetUrl+'" data-image-dimensions="'+b.originalSize+'" data-image-focal-point="'+a+'"/>'
}},{name:"timesince",func:function(c,d,a){if(!V.Lang.isNumber(c)){return"Invalid date."
}var b=a.join(" ");
return'<span class="timesince" data-date="'+c+'">'+V.Squarespace.Utils.humanizeDate(c)+"</span>"
}},{name:"resizedHeightForWidth",func:function(f,h,g){var c=f.split("x");
if(c.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var b=parseInt(c[0],10);
var e=parseInt(c[1],10);
var a=parseInt(g[0],10);
var i=a/b;
var d=parseInt(e*i,10);
return d
}},{name:"resizedWidthForHeight",func:function(f,i,g){var d=f.split("x");
if(d.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var c=parseInt(d[0],10);
var e=parseInt(d[1],10);
var a=parseInt(g[0],10);
var b=a/e;
var h=parseInt(c*b,10);
return h
}},{name:"squarespaceThumbnailForWidth",func:function(b,c,a){return V.Squarespace.Rendering.getSquarespaceSizeForWidth(parseInt(a[0],10))
}},{name:"squarespaceThumbnailForHeight",func:function(f,i,g){var d=f.split("x");
if(d.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var c=parseInt(d[0],10);
var e=parseInt(d[1],10);
var a=parseInt(g[0],10);
var b=a/e;
var h=parseInt(c*b,10);
return V.Squarespace.Rendering.getSquarespaceSizeForWidth(h)
}},{name:"cycle",func:function(b,c,a){return a[(b-1)%a.length]
}}]);
var H=function(a){return{lookup:function(b){var c=a[b]||null;
return[c,null]
}}
};
var A=function(a){return{lookup:function(b){for(var d=0;
d<a.length;
d++){var e=a[d].name,c=a[d].func;
if(b.slice(0,e.length)==e){var f;
var g=b.charAt(e.length);
if(g===""){f=[]
}else{f=b.split(g).slice(1)
}return[c,f]
}}return[null,null]
}}
};
var S=function(a){return{lookup:function(b){for(var c=0;
c<a.length;
c++){var d=a[c].lookup(b);
if(d[0]){return d
}}return[null,null]
}}
};
function E(b,c){var a=[{context:b,index:-1}];
return{PushSection:function(e){if(e===undefined||e===null){return null
}var d;
if(e=="@"){d=a[a.length-1].context
}else{d=a[a.length-1].context[e]||null
}a.push({context:d,index:-1});
return d
},Pop:function(){a.pop()
},next:function(){var e=a[a.length-1];
if(e.index==-1){e={context:null,index:0};
a.push(e)
}var d=a[a.length-2].context;
if(e.index==d.length){a.pop();
return undefined
}e.context=d[e.index++];
return true
},_Undefined:function(d){if(c===undefined){return null
}else{return c
}},_LookUpStack:function(h){var f=a.length-1;
while(true){var d=a[f];
if(h=="@index"){if(d.index!=-1){return d.index
}}else{var g=d.context;
if(typeof g==="object"){var e=g[h];
if(e!==undefined){return e
}}}f--;
if(f<=-1){return this._Undefined(h)
}}},get:function(g){if(g=="@"){return a[a.length-1].context
}var d=g.split(".");
var e=this._LookUpStack(d[0]);
if(d.length>1){for(var f=1;
f<d.length;
f++){if(e===null){return"[JSONT: Can't resolve '"+g+"'.]"
}e=e[d[f]];
if(e===undefined){return this._Undefined(d[f])
}}}return e
}}
}var T=function(a){var b={};
b.current_clause=[];
b.Append=function(c){b.current_clause.push(c)
};
b.AlternatesWith=function(){throw {name:"TemplateSyntaxError",message:"{.alternates with} can only appear with in {.repeated section ...}"}
};
b.NewOrClause=function(c){throw {name:"NotImplemented"}
};
return b
};
var Q=function(a){var b=T(a);
b.statements={"default":b.current_clause};
b.section_name=a.section_name;
b.Statements=function(c){c=c||"default";
return b.statements[c]||[]
};
b.NewOrClause=function(c){if(c){throw {name:"TemplateSyntaxError",message:"{.or} clause only takes a predicate inside predicate blocks"}
}b.current_clause=[];
b.statements.or=b.current_clause
};
return b
};
var D=function(a){var b=Q(a);
b.AlternatesWith=function(){b.current_clause=[];
b.statements.alternate=b.current_clause
};
return b
};
var R=function(a){var b=T(a);
b.clauses=[];
b.NewOrClause=function(c){c=c||[function(d){return true
},null];
b.current_clause=[];
b.clauses.push([c,b.current_clause])
};
return b
};
function O(a,e,b){for(var f=0;
f<a.length;
f++){var c=a[f];
if(typeof(c)=="string"){b(c)
}else{var d=c[0];
var g=c[1];
d(g,e,b)
}}}function U(e,f,b){var d;
d=f.get(e.name);
for(var g=0;
g<e.formatters.length;
g++){var c=e.formatters[g];
var h=c[0];
var a=c[1];
d=h(d,f,a)
}b(d)
}function L(f,e,b){var c=f;
var d=e.PushSection(c.section_name);
var a=false;
if(d){a=true
}if(d&&d.length===0){a=false
}if(a){O(c.Statements(),e,b);
e.Pop()
}else{e.Pop();
O(c.Statements("or"),e,b)
}}function I(j,d,e){var c=j;
var h=d.get("@");
for(var b=0;
b<c.clauses.length;
b++){var i=c.clauses[b];
var f=i[0][0];
var g=i[0][1];
var k=i[1];
var a=f(h,d,g);
if(a){O(k,d,e);
break
}}}function W(g,d,e){var a=g;
var f=d.PushSection(a.section_name);
var b=true;
if(f&&f.length>0){var i=f.length-1;
var h=a.Statements();
var c=a.Statements("alternate");
for(var j=0;
d.next()!==undefined;
j++){O(h,d,e);
if(j!=i){O(c,d,e)
}}}else{O(a.Statements("or"),d,e)
}d.Pop()
}var F=/(repeated)?\s*(section)\s+(\S+)?/;
var J=/^or(?:[\s\-]+(.+))?/;
var Y=/^if(?:[\s\-]+(.+))?/;
function P(i,k){var e=new S([H(V.JSONTemplate.DEFAULT_FORMATTERS),A(V.JSONTemplate.DEFAULT_PREFIX_FORMATTERS)]);
var n=S([H(V.JSONTemplate.DEFAULT_PREDICATES),A(V.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES)]);
var am="str";
function q(ab){if(ab.startsWith(K)){var ac=k.partials[ab.substr(K.length)];
if(ac){return[function(ad,ae,af){return V.JSONTemplate.evaluateJsonTemplate(ac,ad)
},null]
}else{throw {name:"BadPartialInclude",message:ab.substr(K)+" is not a valid partial. Remember, loops are not supported (a partial include cannot be included inside itself)."}
}}var aa=e.lookup(ab);
if(!aa[0]){throw {name:"BadFormatter",message:ab+" is not a valid formatter"}
}return aa
}function ap(aa){var ab=n.lookup(aa);
if(!ab[0]){throw {name:"BadPredicate",message:aa+" is not a valid predicate"}
}return ab
}var h=k.format_char||"|";
if(h!=":"&&h!="|"){throw {name:"ConfigurationError",message:"Only format characters : and | are accepted"}
}var aj=k.meta||"{}";
var w=aj.length;
if(w%2==1){throw {name:"ConfigurationError",message:aj+" has an odd number of metacharacters"}
}var y=aj.substring(0,w/2);
var ag=aj.substring(w/2,w);
var ai=C(y,ag);
var an=Q({});
var l=[an];
var ak=y.length;
var b;
var r;
var a=0;
while(true){b=ai.exec(i);
if(b===null){break
}else{r=b[0]
}if(b.index>a){var x=i.slice(a,b.index);
an.Append(x)
}a=ai.lastIndex;
var d=false;
if(r.slice(-1)=="\n"){r=r.slice(null,-1);
d=true
}r=r.slice(ak,-ak);
if(r.charAt(0)=="#"){continue
}if(r.charAt(0)=="."){r=r.substring(1,r.length);
var z={"meta-left":y,"meta-right":ag,space:" ",tab:"\t",newline:"\n"}[r];
if(z!==undefined){an.Append(z);
continue
}var p,o;
var v=r.match(F);
if(v){var aq=v[1];
var f=v[3];
if(aq){o=W;
p=D({section_name:f})
}else{o=L;
p=Q({section_name:f})
}an.Append([o,p]);
l.push(p);
an=p;
continue
}var m,ao;
var al=r.match(J);
if(al){m=al[1];
ao=m?ap(m):null;
an.NewOrClause(ao);
continue
}var ah=false;
var c=r.match(Y);
if(c){m=c[1];
ah=true;
if(m.indexOf("?")==-1){var g=(function(aa){return function(ab,ac){var ae,af,ad;
if(aa.indexOf(" || ")!==-1){ae=aa.split("||");
for(ad=0;
ad<ae.length;
ad++){af=ae[ad].trim();
if(ac.get(af)){return true
}}return false
}else{if(aa.indexOf(" && ")!==-1){ae=aa.split(" && ");
for(ad=0;
ad<ae.length;
ad++){af=ae[ad].trim();
if(!ac.get(af)){return false
}}return true
}else{return(ac.get(aa))
}}}
}(m));
ao=[g,null];
p=R();
p.NewOrClause(ao);
an.Append([I,p]);
l.push(p);
an=p;
continue
}}else{if(r.charAt(r.length-1)=="?"||r.split(" ")[0].charAt(r.split(" ")[0].length-1)=="?"){m=r;
ah=true
}}if(ah){ao=m?ap(m):null;
p=R();
p.NewOrClause(ao);
an.Append([I,p]);
l.push(p);
an=p;
continue
}if(r=="alternates with"){an.AlternatesWith();
continue
}if(r=="end"){l.pop();
if(l.length>0){an=l[l.length-1]
}else{throw {name:"TemplateSyntaxError",message:"Got too many {end} statements"}
}continue
}}var t=r.split(h);
var j;
var s;
if(t.length==1){if(am===null){throw {name:"MissingFormatter",message:"This template requires explicit formatters."}
}j=[q(am)];
s=r
}else{j=[];
for(var u=1;
u<t.length;
u++){j.push(q(t[u]))
}s=t[0]
}an.Append([U,{name:s,formatters:j}]);
if(d){an.Append("\n")
}}an.Append(i.slice(a));
if(l.length!==1){throw {name:"TemplateSyntaxError",message:"Got too few {end} statements."}
}return an
}var G=/^([a-zA-Z\-]+):\s*(.*)/;
var B=["meta","format-char","default-formatter","undefined-str"];
var M=new RegExp(B.join("|"));
function N(g,f){var i={};
var a=0,l=0;
while(true){var d=false;
l=g.indexOf("\n",a);
if(l==-1){break
}var e=g.slice(a,l);
a=l+1;
var k=e.match(G);
if(k!==null){var c=k[1].toLowerCase(),h=k[2];
if(c.match(M)){c=c.replace("-","_");
h=h.replace(/^\s+/,"").replace(/\s+$/,"");
if(c=="default_formatter"&&h.toLowerCase()=="none"){h=null
}i[c]=h;
d=true
}}if(!d){break
}}var j;
if(i!=={}){j=g.slice(a)
}else{j=g
}for(var b in f){i[b]=f[b]
}return V.JSONTemplate.Template(j,i)
}V.JSONTemplate.Template=Class.create({initialize:function(a,c,b){a=this.removeMultilineComments(a);
this._options=c||{};
this._program=P(a,this._options)
},removeMultilineComments:function(b){var c=b.search("{##");
var a;
while(c>=0){a=b.substr(c);
b=b.substr(0,c)+a.substr(a.search("##}")+3);
c=b.search("{##")
}return b
},render:function(a,b){var c=E(a,this._options.undefined_str);
O(this._program.Statements(),c,b)
},expand:function(a){var b=[];
this.render(a,function(c){b.push(c)
});
return b.join("")
}});
V.JSONTemplate.DEFAULT_PREDICATES=V.Squarespace.TEMPLATE_PREDICATES;
V.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES=V.Squarespace.TEMPLATE_PARAMETRIC_PREDICATES;
V.JSONTemplate.evaluateJsonTemplate=function(c,b,a){if(typeof(c)!="string"){return"JSON Template Error: Processing failed because no input was provided. (type: "+typeof(c)+", template: "+JSON.stringify(c)+", dictionary: "+JSON.stringify(b)+", partials: "+JSON.stringify(a)+")"
}return new V.JSONTemplate.Template(c,{partials:a}).expand(b)
}
},"1.0",{requires:["datatype-date-format","squarespace-common","squarespace-util","json","squarespace-template-helpers"]});/* Host: nyc-webster17.int.peer1.squarespace.net Request Version: 06072013231118989 Local Version: 06072013182121987 Served from: GLOBAL */ 
YUI.add("squarespace-comments",function(a){a.namespace("Squarespace");
a.Squarespace.Comments=Class.create({initialize:function(b){this.settings={likesAllowed:b.likesAllowed,flagsAllowed:b.flagsAllowed,threaded:b.threaded,approvalRequired:b.approvalRequired,allowAnon:b.allowAnon,avatarsHidden:!b.avatarsOn,readOnly:b.readOnly};
this.commentData=new a.Squarespace.CommentData({target:b.identifier,targetType:b.type,settings:this.settings,formatter:a.bind(this.formatData,this)});
this.targetId=b.identifier;
this.params=(b||{design:{}});
this.replyCompleteEvents={};
this.threadState=false;
this.lastSortTime=new Date();
this.lastHashChangeTime=new Date();
this.PaginationModes={EXTEND:1,PAGE:2};
this.containerEl=a.one(this.params.containerEl);
this.params.paginationMode=this.PaginationModes.EXTEND;
this.type=a.Squarespace.WidgetTypes.COMMENT;
this.currentPage=1;
this.maxComments=50;
this.sortOrderLookup=[null];
this.sortOrderLookup.push("Oldest First","Newest First","Most Liked","Least Liked");
this.sortOrder=this.params.sortType;
this.commentsEl=a.DB.DIV("comments-content",a.DB.DIV("comment-list"));
this.commentsEl.appendTo(this.containerEl);
this.loadMoreNode=a.DB.DIV("load-more",a.DB.DIV("view-more-btn",{html:"Load More Comments"}));
this.fullViewNode=a.DB.DIV("full-view-btn",{html:"View full comment thread"});
this.history=new a.HistoryHash();
this.commentsEl.delegate("click",this.onReplyToggleClick,".reply",this);
this.commentsEl.delegate("click",this.onLikeClick,".comment:not(.liked):not(.read-only) .like",this);
this.commentsEl.delegate("click",this.onUnlikeClick,".comment.liked:not(.read-only) .like",this);
this.commentsEl.delegate("click",this.onFlagClick,".comment:not(.flagged):not(.read-only) .flag",this);
this.commentsEl.delegate("click",this.onUnflagClick,".comment.flagged:not(.read-only) .flag",this);
this.commentsEl.delegate("click",this.onApproveClick,".comment.unmoderated:not(.read-only) .approve",this);
this.commentsEl.delegate("click",this.onDeleteClick,".comment:not(.read-only) .delete",this);
this.commentsEl.delegate("click",this.replyBtnOnClick,".reply-area-wrapper .comment-btn:not(.read-only)",this);
this.commentsEl.delegate("click",this.togglePreview,".reply-area-wrapper .preview-comment",this);
this.commentsEl.delegate("click",this.showSubscribe,".subscribe",this);
this.commentsEl.delegate("click",this.unsubscribe,".unsubscribe",this);
this.history.on("commentIdChange",this.commentIdHashOnChange,this);
this.history.on("commentIdRemove",this.commentIdHashOnRemove,this);
this.containerEl.delegate("click",(function(){var c,e,d;
return function(g){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,allowAnonymous:this.settings.allowAnon,overlayOpacity:0.5});
var f=function(){this.onLoading();
this.commentData.visibleComments=0;
this.retrieveComments({onSuccess:function(h){this.fullDataRender(h)
},page:1,order:this.sortOrder},this);
c.detach();
d.detach()
};
c=SQUARESPACE_LOGIN.once("cancel",function(){e.detach();
d.detach()
},this);
e=SQUARESPACE_LOGIN.once("login",f,this);
d=SQUARESPACE_LOGIN.once("guestLogin",f,this);
SQUARESPACE_LOGIN.show()
}
})(),".squarespace-comment-login",this);
SQUARESPACE_LOGIN.on("login",function(){this.updateLikedFlaggedState();
this.refreshCommentPostButtons();
this.moderationMode=a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)
},this);
SQUARESPACE_LOGIN.on("logout",function(){this.updateLikedFlaggedState();
this.refreshCommentPostButtons();
this.refreshSubscribeControl();
this.moderationMode=false
},this);
this.containerEl.delegate("click",function(c){SQUARESPACE_LOGIN.onLogoutClick()
},".squarespace-comment-logout",this);
this.containerEl.delegate("focus",function(){this.set("text","");
this.setAttribute("data-edited",true)
},".comment-input");
this.containerEl.delegate("blur",function(){if(this.get("value")===""){this.setAttribute("data-edited",false)
}},".comment-input");
this.containerEl.delegate("focus",function(c){c.target.setAttribute("data-edited",true)
},".new-comment-area textArea",this);
this.containerEl.delegate("click",this.extendComments,".view-more-btn",this);
this.containerEl.delegate("click",this.fullViewOnClick,".full-view-btn",this);
this.containerEl.delegate("click",this.commentBtnOnClick,".top-level-comment-area .comment-btn:not(.read-only)",this);
this.containerEl.delegate("click",this.togglePreview,".top-level-comment-area .preview-comment",this);
this.containerEl.delegate("change",function(c){this.sort(c.target.get("value"))
},".hidden-ordering",this);
a.Cookie.remove("displayName",{path:"/"});
this.subscribeDialogParams={name:"subscribe",style:"flyout",flyoutPointerDirection:"top",width:320,position:"center",closeable:true,overlay:0.5,top:200,discardChangesConfirmation:false,title:"Subscribe by Email",primaryTabs:[{title:"Subscribe by Email",icon:"/universal/images-v6/standard/icon_invites_24_light.png",fields:[{type:"text",required:true,name:"email",title:"Email",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"description",text:"Subscribe to this comment thread by email.",padding:[0,0]}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Submit"}]}
},doAfterLogin:function(c,b,f){var g,e,d;
e=c.once("login",function(){b.call(this);
d.detach();
g.detach()
},f);
d=c.once("guestLogin",function(){e.detach();
g.detach()
});
g=c.once("cancel",function(){e.detach();
d.detach()
})
},doAfterGuestLogin:function(c,b,f){var g,d,e;
d=c.once("guestLogin",function(){b.call(this);
e.detach();
g.detach()
},f);
e=c.once("login",function(){d.detach();
g.detach()
});
g=c.once("cancel",function(){d.detach();
e.detach()
})
},fullViewOnClick:function(){this.history.addValue("commentId",null)
},updateTopLevelButton:function(){var c=a.one(".top-level-comment-area .comment-btn"),d={newCommentAreaTop:{authenticatedAccount:(SQUARESPACE_LOGIN.account===null?undefined:SQUARESPACE_LOGIN.account)},comments:[{}]},b=this.renderToFragment(d),e=b.one(".top-level-comment-area .comment-btn");
if(c){c.ancestor(".comment-btn-wrapper").append(e);
c.remove(true)
}},updateReplyAreaButtons:function(){var c={comments:[{authenticatedAccount:SQUARESPACE_LOGIN.account}]},b=this.renderToFragment(c).one(".reply-area-wrapper .comment-btn");
if(b){this.commentsEl.all(".reply-area-wrapper .comment-btn").each(function(d){d.insert(b.cloneNode(true),"after");
d.remove(true)
})
}},refreshCommentPostButtons:function(){this.updateTopLevelButton();
this.updateReplyAreaButtons()
},refreshSubscribeControl:function(){if(!SQUARESPACE_LOGIN.account){Static.SQUARESPACE_CONTEXT.subscribed=false
}var c={subscribed:Static.SQUARESPACE_CONTEXT.subscribed,comments:[{}]},d,b=this.renderToFragment(this.scatterData(c)).one(".subscribe-control");
if(b){d=a.one(".subscribe-control");
d.insert(b,"after");
d.remove(true)
}},generatePreview:function(b){var g=a.Squarespace.Escaping.escapeForHtml(b.get("value")),j={comments:[{}]},c=null,k=null,f=j.comments[0],e=b.ancestor(".reply-area-wrapper"),i=!b.ancestor(".reply-area-wrapper"),d,h;
if(!i){h=a.one('.comment[data-commentId="'+b.ancestor(".reply-area-wrapper").getAttribute("data-commentId")+'"]');
d=(h.hasAttribute("data-depth")?parseInt(h.getAttribute("data-depth"),10)+1:1)
}else{d=0
}f.body=a.Squarespace.Lang.markdownToHTML(a.Squarespace.Utils.preFormatMarkdown(g));
f.memberAccount=a.clone(SQUARESPACE_LOGIN.account);
f.authorName=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In");
f.addedOn=(new Date()).getTime();
f.depth=d;
k=this.renderToFragment(this.scatterData(j));
c=k.one(".comment");
c.addClass("comment-preview");
if(i){c.addClass("top-level")
}else{c.setAttribute("data-previewId",h.getAttribute("data-commentId"));
c.setAttribute("data-replyTo",h.getAttribute("data-commentId"))
}return k
},replyBtnOnClick:function(g){var j=g.target.ancestor(".reply-area-wrapper"),b=j.getAttribute("data-commentId"),i=a.one('.comment[data-commentId="'+b+'"]'),h=j.one("textArea"),f=h.get("value"),d,c=function(){var e=this.injectReply(f,i);
this.replyTo(j.getAttribute("data-commentId"),f,e,h)
};
if(f.trim()===""){this.showEmptyText()
}else{if(SQUARESPACE_LOGIN.account){d=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Post Comment",width:214,onSuccess:c,scope:this});
d.show("Post Comment","Are you sure you want to post this comment?")
}else{c.call(this)
}}g.stopImmediatePropagation()
},subscribe:function(b){a.Data.post({url:"/api/comment/Subscribe",secure:true,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=true;
this.refreshSubscribeControl();
(new a.Squarespace.Information()).show("Subscribed","Successfully subscribed")
},failure:function(){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.subscribe(b)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Subscribe","Subscribe",false)
}},this)
},unsubscribe:function(b){a.Data.post({url:"/api/comment/Unsubscribe",secure:true,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=false;
this.refreshSubscribeControl();
(new a.Squarespace.Information()).show("Unsubscribed","Successfully unsubscribed")
},failure:function(c){if(c.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unsubscribe(b)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Unsubscribe","Unsubscribe",false)
}}},this)
},showSubscribe:function(c){var b=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Subscribe",width:344,onSuccess:this.subscribe,scope:this});
b.show("Subscribe to Thread","Are you sure you wish to subscribe to this comment thread? You will receive updates via the email on file in your profile.")
},togglePreview:function(b){var d=b.target.ancestor(".reply-area-wrapper"),c;
if(d){c=d.one("textArea")
}else{c=b.target.ancestor(".top-level-comment-area").one("textArea")
}if(c.get("value")!==""){if(b.target.getAttribute("data-state")==="open"){b.target.setAttribute("data-state","closed");
this.hidePreview(c)
}else{b.target.setAttribute("data-state","open");
this.showPreview(c)
}}},showPreview:function(c){if(c){var f=this.generatePreview(c),e=f.one(".comment"),d=c.ancestor(".reply-area-wrapper"),j=c.ancestor(".input"),h=!d,g,i,b;
e.wrap('<div class="new comment-preview-wrapper closed"></div>');
b=e.ancestor(".comment-preview-wrapper");
if(!h){d.insert(b,"after");
b.setAttribute("data-commentId",d.getAttribute("data-commentId"))
}else{b.addClass("top-level");
a.one(".comment-list").prepend(b)
}c.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML","Edit");
j.setStyle("height",j.get("offsetHeight"));
g=new a.Anim({node:j,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
g.on("start",function(){this._node.setStyle("overflow","hidden")
});
g.run();
i=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:e.get("offsetHeight")+parseInt(e.getComputedStyle("paddingBottom"),10)+parseInt(e.getComputedStyle("marginBottom"),10)}});
i.on("end",function(){this._node.addClass("open")
});
i.run()
}},hideAllPreviews:function(){a.all(".comment-preview-wrapper:not(.top-level)").each(function(c){var b=new a.Anim({node:c,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
b.on("end",function(){this._node.remove(true)
});
b.run()
},this);
a.all('.preview-comment[data-state="open"]:not(.top-level-preview-btn)').each(function(b){b.setAttribute("data-state","closed");
b.set("innerHTML","Preview")
},this)
},hidePreview:function(f){if(f){var c=f.ancestor(".reply-area-wrapper"),e,d,b,g;
if(c){b=a.one('.comment-preview[data-previewId="'+c.getAttribute("data-commentId")+'"]')
}else{b=a.one(".comment-preview.top-level")
}f.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML","Preview");
e=new a.Anim({node:f.ancestor(".input"),duration:0.3,easing:a.Easing.easeOutStrong,to:{height:f.get("offsetHeight")}});
e.on("end",function(){this._node.setStyle("overflow","visible")
});
e.run();
if(b){g=b.ancestor(".comment-preview-wrapper");
d=new a.Anim({node:g,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
d.on("start",function(){this._node.removeClass("open");
this._node.addClass("closed")
});
d.on("end",function(){this._node.remove(true)
});
d.run()
}}},getTemplateData:function(c,b){a.Data.get({url:"/api/template/GetTemplateSchema",data:{type:a.Squarespace.WidgetTypes.COMMENTS,componentType:"widget"},success:function(d){this._template=new a.JSONTemplate.Template(d.html);
c.call(this)
},failure:b},this)
},updateLikedFlaggedState:function(){if(this.settings.flagsAllowed||this.settings.likesAllowed){this.commentData.getLikesAndFlags({success:function(c){var b=a.one(".comment-list");
b.all(".comment").each(function(e){var d=e.getAttribute("data-commentId");
if(this.settings.flagsAllowed){if(c.flagMap[d]){e.addClass("flagged")
}else{e.removeClass("flagged")
}}if(this.settings.likesAllowed){if(c.likeMap[d]){e.addClass("liked")
}else{e.removeClass("liked")
}}},this)
}},this)
}},create:function(){if(a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)){this.moderationMode=true
}this.getTemplateData(function(){var b=this.history.get("commentId");
if(!a.Lang.isUndefined(b)){this.onLoading();
this.retrieveThread({onSuccess:this.threadRender,onFailure:function(c){this.onLoading();
this.retrieveComments({onSuccess:function(d){this.fullDataRender(d)
},page:1,order:this.sortOrder})
},order:this.sortOrder,commentId:b})
}else{this.onLoading();
this.retrieveComments({onSuccess:function(c){this.fullDataRender(c)
},page:1,order:this.sortOrder})
}},function(){})
},updateCommentCounts:function(){var b=this.renderToFragment({visibleComments:this.commentData.visibleComments,totalComments:this.commentData.totalComments,comments:[]});
if(this.commentData.visibleComments===0){this.containerEl.addClass("empty")
}else{this.containerEl.removeClass("empty")
}a.one(".comment-count").set("innerHTML",b.one(".comment-count").get("innerHTML"))
},buildInfoPane:function(g){var c=(a.DB.DIV("squarespace-user-info",a.DB.DIV("user-info-header",a.DB.DIV("avatar",a.DB.IMG("",{src:(g.avatarAssetUrl?g.avatarAssetUrl:"/universal/images-v6/default-avatar.png")+"?format=50w"})),a.DB.DIV("info",a.DB.DIV("name",{html:g.displayName}),a.DB.A("website",{href:(g.websiteUrl?"http://"+a.Squarespace.Escaping.escapeForHtml(g.websiteUrl):""),html:(g.websiteUrl||"")}))),a.DB.DIV("user-info-body",{html:"<p>"+a.Squarespace.Utils.truncateAt(a.Squarespace.Escaping.escapeForHtml(g.bio,60))+"</p>"}),a.DB.DIV("user-social-opts",a.DB.DIV("social-leftcol"),a.DB.DIV("social-rightcol"),a.DB.DIV("clearfix"))));
var b=c.one(".social-leftcol"),e=c.one(".social-rightcol");
var h=(function(){var i=function(k,j){return function(l){return"http://"+k+"."+("com"||j)+"/"+l
}
};
return{foursquare:function(j){if(/[a-zA-Z]/.exec(j)===null){return"http://www.foursquare.com/user/"+j
}else{return"http://www.foursquare.com/"+j
}},facebook:i("facebook"),twitter:i("twitter")}
})();
if(g.socialOptions){for(var d=0;
d<g.socialOptions.length;
d++){var f=a.DB.DIV("social-widget",a.DB.A("",{href:h[g.socialOptions[d].type](g.socialOptions[d].username)},a.DB.IMG("social-icon",{src:(g.socialOptions[d].type==="foursquare"?"/universal/images-v6/member/icon-foursquare-small.png":"/universal/images-v6/social/"+g.socialOptions[d].type+"_16.png")})),a.DB.A("social-name",{html:g.socialOptions[d].type,href:h[g.socialOptions[d].type](g.socialOptions[d].username)}));
if((d%2)===0){b.append(f)
}else{e.append(f)
}}}return c
},showClickOverlay:function(){var d=a.one(document),c=d.get("winHeight"),b=d.get("winWidth");
this.overlayEl=a.DB.DIV("user-profile-overlay");
this.overlayEl.setStyles({position:"fixed",background:"#000",height:c+"px",width:b+"px",opacity:"0",top:"0px",left:"0px",zIndex:999});
a.one("body").append(this.overlayEl);
a.on("click",this.hideUserProfileFlyout,this.overlayEl,this)
},showUserProfileFlyout:function(g){if(!g.target.hasClass("squarespace-comment-user-flyout")&&!g.target.ancestor(".squaresapce-comment-user-flyout")&&!this.flyoutOpen){var f=g.target.ancestor(".comment").getAttribute("data-commentid"),h=this.commentData.getCommentById(f);
var c=h.memberAccount;
if(!c){return
}var d=a.DB.DIV("squarespace-comment-user-flyout",this.buildInfoPane(c),a.DB.DIV("squarespace-user-activity",a.DB.DIV("squarespace-activity-header",a.DB.DIV("title",{html:"Activity"}),a.DB.DIV("description",{html:"Comments and likes across the Squarespace platform"})),a.DB.DIV("feed")),a.DB.DIV("squarespace-comment-user-clearfix"));
var b=a.one(document.body);
b.append(d);
d.setStyles({position:"fixed",left:"50%",top:"50%",opacity:0,zIndex:1000,transform:"scale(.95)"});
d.setStyles({marginTop:-(parseInt(d.get("offsetHeight"),10)/2),marginLeft:-(parseInt(d.get("offsetWidth"),10)/2)});
d.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1)"},opacity:{duration:0.3,easing:"ease-out",value:1}})
}this.flyoutOpen=true;
this.showClickOverlay();
g.stopImmediatePropagation()
},hideUserProfileFlyout:function(c){if(this.flyoutOpen){var b=a.one(".squarespace-comment-user-flyout");
if(b){b.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1.08)"},opacity:{duration:0.4,easing:"ease-out",value:0},on:{end:a.bind(function(){b.remove(true);
c.target.remove(true);
this.flyoutOpen=false
},this)}})
}}},getThreadNodes:function(b,c){var d=b.getAttribute("data-commentId");
c.push(b);
a.all('.comment[data-replyTo="'+d+'"]').each(function(e){this.getThreadNodes(e,c)
},this)
},actualDelete:function(i,l,j){var h=i.target.ancestor(".comment"),b=h.getAttribute("data-commentId"),g,c,m=this.lastSortTime,f=this.lastHashChangeTime,k=function(e){if(m===this.lastSortTime&&f===this.lastHashChangeTime){g=a.DB.DIV("delete-anim-wrapper");
h.insert(g,"after");
j.forEach(function(p){g.append(p);
var o=a.one('.reply-area-wrapper[data-commentId="'+p.getAttribute("data-commentId")+'"]');
if(o){o.remove(true)
}});
c=new a.Anim({node:g,duration:0.5,easing:a.Easing.easeOutStrong,to:{height:0}});
c.on("end",function(){g.remove(true);
if(j.length>1){this.commentData.removeCommentsByIds(j.map(function(n){return n.getAttribute("data-commentId")
}).filter(function(n){return n!==b
}))
}this.updateCommentCounts()
},this);
c.run()
}},d=function(e){if(e.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.actaulDelete(i,l,j)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Delete Comments","Delete Comments",false)
}else{if(e.authorizationFail){(new a.Squarespace.Alert("Authorization Failure","You are not allowed to perform that action.")).show()
}}};
this.commentData._delete({comments:[b],spam:l,success:k,failure:d},this)
},onDeleteClick:function(d){var k,c=d.target.ancestor(".comment"),f=function(){var e=[];
this.getThreadNodes(c,e);
return e
},h=f.call(this),b=function(){h.forEach(function(l){if(!l.hasClass("unmoderated")){var e=new a.Anim({node:l,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}});
e.on("end",function(){this._node.removeClass("pending-delete")
});
e.run()
}else{l.removeClass("pending-delete")
}})
},g=function(){b();
this.actualDelete(d,true,h)
},j=function(){b();
this.actualDelete(d,false,h)
},i=function(){b()
};
h.forEach(function(l){if(!l.hasClass("unmoderated")){var e=new a.Anim({node:l,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.5}});
e.on("end",function(){this._node.addClass("pending-delete")
});
e.run()
}else{l.addClass("pending-delete")
}});
k=new a.Squarespace.ConfirmationDialog({style:"confirmOrReject",rejectText:"Delete",showScreenOverlay:false,confirmText:"Delete & Report Spam",width:344,onCancel:i,onReject:j,onSuccess:g,scope:this});
k.show((h.length===1?"Delete Comment":"Delete "+h.length+" Comments"),(h.length>1?"Are you sure you wish to delete these comments?":"Are you sure you wish to delete this comment?"))
},onApproveClick:function(b){var c=b.target.ancestor(".comment");
this.approve(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},approve:function(e,c){var d=function(f){this.updateCommentCounts()
},b=function(f){if(f.loginRequired){c.addClass("unmoderated");
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.approve(e,c)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Approve Comments","Approve Comments",false)
}};
c.removeClass("unmoderated");
this.commentData.approve({comments:[e],success:d,failure:b},this)
},onUnlikeClick:function(b){var c=b.target.ancestor(".comment");
this.unlike(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},unlike:function(f,d){var c=d.one(".likes"),e=function(){if(c){var h={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(f).likeCount}}]},g=this.renderToFragment(this.scatterData(h)).one(".likes");
c.replace(g)
}},b=function(g){d.addClass("liked");
if(g.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unlike(f,d)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Dislike Comment","Dislike Comment",false)
}};
d.removeClass("liked");
this.commentData.unlike({id:f,success:e,failure:b},this)
},onFlagClick:function(c){var b=function(){var d=c.target.ancestor(".comment");
this.flag(d.getAttribute("data-commentId"),d)
};
(new a.Squarespace.ConfirmationDialog()).show("Flag Comment","Are you sure you wish to flag this comment as inappropriate?",b,this);
c.stopImmediatePropagation()
},flag:function(e,c){var d=function(){},b=function(g){c.removeClass("flagged");
if(g.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
var f;
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.flag(e,c);
f.detach()
},this);
f=SQUARESPACE_LOGIN.once("cancel",function(){c.removeClass("flagged")
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Flag Comment","Flag Comment",false)
}else{if(g.error){new a.Squarespace.Alert().show("Failed to Flag Comment",g.error)
}}};
c.addClass("flagged");
this.commentData.flag({id:e,success:d,failure:b},this)
},onUnflagClick:function(b){var c=b.target.ancestor(".comment");
this.unflag(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},unflag:function(e,c){var d=function(){},b=function(f){c.addClass("flagged");
if(f.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,opacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unflag(e,c)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Unflag Comment","Unflag Comment",false)
}};
c.removeClass("flagged");
this.commentData.unflag({id:e,success:d,failure:b},this)
},onLikeClick:function(b){var c=b.target.ancestor(".comment");
this.like(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},like:function(h,e){var c=e.one(".likes"),d=e.getAttribute("data-commentid"),g,f=function(){if(c&&!a.Lang.isNull(e._node)){var j={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(d).likeCount}}]},i=this.renderToFragment(this.scatterData(j)).one(".likes");
c.replace(i)
}},b=function(i){e.removeClass("liked");
if(i.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.like(h,e)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Like Comment","Like Comment",false)
}else{if(i.error){new a.Squarespace.Alert().show("Failed to Like Comment",i.error)
}}};
e.addClass("liked");
this.commentData.like({id:h,success:f,failure:b},this)
},addLoadMoreControls:function(c){var b=a.one(".load-more");
if(b){b.remove(true)
}if(!this.threadState&&this.commentData.page<this.commentData.numPages){this.containerEl.append(this.loadMoreNode.cloneNode(true))
}},addFullViewControls:function(c){var b=a.one(".full-view-btn");
if(b){b.remove(true)
}if(this.threadState){this.containerEl.one(".comment-list").insert(this.fullViewNode.cloneNode(true),"before")
}},onReplyToggleClick:function(l){var j=l.target.ancestor(".comment"),d=j.getAttribute("data-commentid"),b=a.one('.reply-area-wrapper[data-commentid="'+d+'"]'),k=a.one("body"),g,f,m=a.bind(function(n,e){if(n){n.setStyles({overflow:"hidden",height:n.get("offsetHeight")});
n.one(".input").setStyle("height","auto");
a.one('.comment[data-commentid="'+n.getAttribute("data-commentId")+'"]').fire("reply-close");
g=new a.Anim({node:n,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
g.on("end",function(){},this);
g.run()
}},this),i=a.bind(function(o){if(o){var n,e;
e=o.one(".new-comment-area").cloneNode(true);
e.setStyles({visibility:"hidden",display:"block",position:"absolute"});
j.append(e);
n=e.get("offsetHeight");
e.remove(true);
a.one('.comment[data-commentid="'+o.getAttribute("data-commentId")+'"]').fire("reply-open");
this.hideAllPreviews();
f=new a.Anim({node:o,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:Math.max(n,190)+15}});
f.on("end",function(){this._node.setStyle("height","auto");
var q=(this._node.getY()+this._node.get("offsetHeight"))-(k.get("docScrollY")+k.get("winHeight")),r=k.get("scrollTop"),p;
if(q>=0){p=new a.Anim({node:k,duration:0.3,easing:a.Easing.easeOutStrong,to:{scrollTop:r+q}});
p.run()
}});
f.run()
}},this),h=function(e){return e.hasClass("reply-open")
};
if(h(j)){j.removeClass("reply-open");
this.hideAllPreviews();
m(b)
}else{b.one(".reply-area").setAttribute("replyid",d);
a.all(".comment.reply-open").each(function(o){o.removeClass("reply-open");
var e=a.one('.reply-area-wrapper[data-commentid="'+o.getAttribute("data-commentid")+'"]');
m(e)
});
var c=b.one("textArea");
if(!this.replyCompleteEvents[j.getAttribute("data-commentId")]){this.replyCompleteEvents[j.getAttribute("data-commentId")]=this.once("reply-complete",function(e){m(b,function(){this.one(".input").setStyle("height","auto")
});
this.replyCompleteEvents[j.getAttribute("data-commentId")]=null
},this)
}c.on("focus",function(){this.setAttribute("data-edited",true)
});
c.on("blur",function(){if(this.get("value")===""){this.setAttribute("data-edited",false)
}});
j.addClass("reply-open");
i(b)
}l.stopImmediatePropagation()
},escapeComment:function(b){b.authorName=a.Squarespace.Escaping.escapeForHtml(b.authorName);
if(b.memberAccount){b.memberAccount.displayName=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.displayName);
b.memberAccount.bio=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.bio)
}},addReplyArea:function(c){var e=a.one(".reply-area-wrapper"),g,d,b,f;
if(e){e.one(".preview-comment").setAttribute("data-state","closed").set("innerHTML","Preview");
g=e.cloneNode(true);
g.setAttribute("data-commentId",c.getAttribute("data-commentId"));
g.setAttribute("data-depth",c.getAttribute("data-depth"));
f=g
}else{d={comments:[{id:c.getAttribute("data-commentId"),depth:c.getAttribute("data-depth")}]};
b=this.renderToFragment(d);
f=b.one(".reply-area-wrapper").cloneNode(true)
}f.setStyle("height",null);
c.insert(f,"after")
},prependComment:function(h){var b=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In"),c=a.one(".top-level-comment-area .comment-input"),d=a.one(".top-level.comment-preview"),e=false,g,f;
if(!d){d=this.generatePreview(c).one(".comment-preview");
e=true;
d.wrap('<div class="comment-preview-wrapper"></div>');
f=d.ancestor(".comment-preview-wrapper");
a.one(".comment-list").prepend(f)
}else{d.one(".author").set("innerHTML",b);
f=d.ancestor(".comment-preview-wrapper")
}d.removeClass("comment-preview");
d.addClass("pending");
a.one(".top-level-comment-area .preview-comment").setAttribute("data-state","closed");
this.hidePreview(c);
if(e){g=new a.Anim({node:f,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:d.get("offsetHeight")+parseInt(d.getComputedStyle("marginBottom"),10)}});
g.on("end",function(){d.unwrap()
});
g.run()
}else{d.unwrap()
}this.containerEl.removeClass("empty");
this.makeMostRecent(d);
return d
},injectReply:function(h,j){var b=j.getAttribute("data-commentId"),i=a.one('.comment-preview-wrapper[data-commentId="'+b+'"]'),e=a.one('.reply-area-wrapper[data-commentId="'+b+'"]').one("textArea"),g=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In"),f=false,d;
if(!i){d=this.generatePreview(e).one(".comment-preview");
f=true;
d.wrap('<div class="comment-preview-wrapper"></div>');
i=d.ancestor(".comment-preivew-wrapper")
}else{d=i.one(".comment-preview");
d.one(".author").set("innerHTML",g)
}if(j.hasAttribute("data-depth")){d.setAttribute("data-depth",parseInt(j.getAttribute("data-depth"),10)+1)
}d.unwrap();
d.removeClass("comment-preview");
d.addClass("pending");
j.removeClass("reply-open");
j.fire("reply-complete");
if(f){var c=e.ancestor(".reply-area-wrapper").cloneNode(true);
e.ancestor(".reply-area-wrapper").insert(d,"after")
}this.makeMostRecent(d);
this.fire("reply-complete",{node:d});
return d
},makeMostRecent:function(b){if(b.hasClass("comment")){a.all(".comment.pending.most-recent").each(function(c){if(!c.ancestor(".most-recent-anim-wrapper")){c.removeClass("most-recent")
}});
b.addClass("most-recent")
}},fullDataRender:function(){this.render(this.commentData.formatted);
this.commentList=a.one(".comment-list")
},threadRender:function(){this.render(this.commentData.formattedThread);
this.commentList=a.one(".comment-list");
this.commentList.one('.comment[data-commentId="'+this.commentData.currentThreadRoot+'"]').addClass("target")
},showEmptyText:function(){new a.Squarespace.Alert().show("Enter Comment Text","Enter text in the field above to post a comment.")
},showModerationNotification:function(){new a.Squarespace.Notice().show("Comment Awaiting Moderation","Your comment has been successfully posted and is awaiting moderation.")
},showCommentSuccessNotification:function(){new a.Squarespace.Notice().show("Comment Posted","Your comment has been successfully posted.")
},showPostCommentNotification:function(b){if(b.status===a.Squarespace.CommentStatuses.AWAITING_MODERATION){this.showModerationNotification()
}},squarespaceAdminOnly:function(){return(Static.SQUARESPACE_CONTEXT.website.cloneable&&!a.Squarespace.Utils.isSquarespaceAdmin())
},commentBtnOnClick:function(g){var b=a.one(".top-level-comment-area .comment-input"),f=b.get("value"),d,c=function(){var e=this.prependComment(f);
this.submitTopLevel(f,e,b)
};
if(f.trim()===""){this.showEmptyText()
}else{if(SQUARESPACE_LOGIN.account){d=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Post Comment",width:214,onSuccess:c,scope:this});
d.show("Post Comment","Are you sure you want to post this comment?")
}else{c.call(this)
}}g.stopImmediatePropagation()
},updateWithMemberAccount:function(c,e){if(e&&!SQUARESPACE_LOGIN.account){var d=c.one(".author");
if(d){d.setContent(e.displayName)
}var b=c.one(".avatar img");
if(b){if(e.avatarAssetUrl){b.setAttribute("src",e.avatarAssetUrl)
}}}},submitTopLevel:function(d,e,c){this.setPosting(e,(!this.approvalRequired||!this.moderationMode));
var b=c.get("value");
c.set("value","");
this.addComment({onSuccess:function(f){this.updateCommentCounts();
if(!a.Lang.isNull(e._node)){this.setPosted(e);
e.setAttribute("data-commentId",f.comment.id);
if(f.comment.status===a.Squarespace.CommentStatuses.APPROVED){e.removeClass("pending")
}this.addReplyArea(e);
this.updateWithMemberAccount(e,f.comment.memberAccount);
this.showPostCommentNotification(f.comment)
}},onFailure:function(k){c.set("value",b);
if(k.errors){if(k.errors.anonEmail||k.errors.authorEmail||k.errors.authorName){var i=e.one(".author");
if(k.errors.anonEmail){new a.Squarespace.Notice().show("Comment Failed",k.errors.anonEmail)
}var h=function(){this.submitTopLevel(d,e,c);
if(!a.Lang.isNull(i)||a.Lang.isNull(i._node)){i.set("innerHTML",SQUARESPACE_LOGIN.account.displayName)
}if(SQUARESPACE_LOGIN.account.avatarAssetUrl){var l=e.one(".avatar");
l.one("img").setAttribute("src",SQUARESPACE_LOGIN.account.avatarAssetUrl)
}f.detach()
};
var g=function(){this.submitTopLevel(d,e,c);
var l=a.Cookie.get("displayName");
if(!(a.Lang.isNull(i)||a.Lang.isNull(i._node)||a.Lang.isNull(l))){i.set("innerHTML",l)
}f.detach()
};
var j=function(){this.removeMostRecentPending()
};
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,h,this);
this.doAfterGuestLogin(SQUARESPACE_LOGIN,g,this);
var f=SQUARESPACE_LOGIN.once("cancel",j,this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Post Comment","Post Comment",this.settings.allowAnon)
}else{this.showPostCommentNotification(k.comment)
}}},body:d},this)
},removeMostRecentPending:function(){var d=a.one(".comment.most-recent"),c,b;
if(d.ancestor(".comment-preview-wrapper")){d.unwrap()
}d.wrap('<div class="most-recent-anim-wrapper"></div>');
b=d.ancestor(".most-recent-anim-wrapper");
b.setStyles({overflow:"hidden",height:d.get("offsetHeight")});
c=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
c.on("end",function(){this._node.remove(true)
});
c.run()
},onLoading:function(){var d=a.one(".comments-content"),b=a.DB.DIV("comment-event-capture"),c;
b.setStyles({position:"absolute",top:d.getY(),left:d.getX(),width:d.get("offsetWidth"),height:d.get("offsetHeight"),zIndex:1000});
b.on("hover",function(f){f.stopImmediatePropagation()
});
b.on("click",function(f){f.stopImmediatePropagation()
});
a.one("body").append(b);
c=new a.Anim({node:d,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.3}});
c.run()
},commentIdHashOnChange:function(b){if(!(a.Lang.isNull(b.newVal)||a.Lang.isUndefined(b.newVal))){this.threadState=true;
this.lastHashChangeTime=new Date();
this.onLoading();
this.retrieveThread({commentId:b.newVal,order:this.sortOrder,onSuccess:function(){this.threadRender()
}})
}},commentIdHashOnRemove:function(){this.threadState=false;
this.lastHashChangeTime=new Date();
this.onLoading();
this.retrieveComments({onSuccess:function(b){this.fullDataRender(b)
},page:1,order:this.sortOrder},this)
},retrieveThread:function(b,c){this.threadState=true;
var d=function(e){this.threadState=false;
b.onFailure.call((c||this),e)
};
this.commentData.getThread({order:b.order,commentId:b.commentId,success:b.onSuccess,failure:d},(c||this))
},retrieveComments:function(d,e){var c=this.params.identifier,f=this.params.type;
var g={targetId:c,targetType:f,since:(d.since||""),page:d.page,sortBy:d.order};
var b=a.bind(function(h){this.lastPollTime=new Date();
d.onSuccess.call((e||this),h);
this.updateLikedFlaggedState()
},this);
this.commentData.get({order:d.order,page:d.page,since:(d.since||""),success:b,failure:d.onFailure},this)
},addComment:function(c,d){var b=a.bind(function(e){if(a.Lang.isFunction(c.onSuccess)){(c||noop).onSuccess.call((d||this),e)
}a.Cookie.remove("displayName",{path:"/"})
},this);
this.commentData.post({body:c.body,replyTo:c.replyTo,name:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName")),email:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.email:a.Cookie.get("email")),authorUrl:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.websiteUrl:a.Cookie.get("websiteUrl")),success:b,failure:c.onFailure},(d||this))
},setPosting:function(d,c){d.all(".posting-text").each(function(e){e.removeClass("visible")
});
var b=d.one(".posting-text"+(c?".moderated":""));
if(b){b.addClass("visible")
}},setPosted:function(c){var b=c.all(".posting-text");
if(b){b.each(function(d){d.removeClass("visible")
})
}},replyTo:function(f,d,e,b){this.setPosting(e,(!this.approvalRequired||!this.moderationMode));
var c=b.get("value");
b.set("value","");
this.addComment({body:d,replyTo:f,onSuccess:function(g){this.updateCommentCounts();
if(!a.Lang.isNull(b._node)){this.setPosted(e);
e.setAttribute("data-commentId",g.comment.id);
if(g.comment.status===a.Squarespace.CommentStatuses.APPROVED){e.removeClass("pending")
}this.addReplyArea(e);
this.updateWithMemberAccount(e,g.comment.memberAccount);
this.showPostCommentNotification(g.comment)
}},onFailure:function(k){b.set("value",c);
if(k.errors){if(k.errors.anonEmail||k.errors.authorEmail||k.errors.authorName){var j,i,h;
if(k.errors.anonEmail){new a.Squarespace.Notice().show("Comment Failed",k.errors.anonEmail)
}j=function(){this.removeMostRecentPending()
};
i=function(){this.replyTo(f,d,e,b);
a.one('.comment[data-replyTo="'+f+'"] .author').set("innerHTML",SQUARESPACE_LOGIN.account.displayName);
e.one(".author").set("innerHTML",SQUARESPACE_LOGIN.account.displayName);
if(SQUARESPACE_LOGIN.account.avatarAssetUrl){var l=e.one(".avatar");
l.one("img").setAttribute("src",SQUARESPACE_LOGIN.account.avatarAssetUrl)
}g.detach()
};
h=function(){this.replyTo(f,d,e,b);
var l=a.Cookie.get("displayName");
if(!a.Lang.isNull(l)){a.one('.comment[data-replyTo="'+f+'"] .author').set("innerHTML",l)
}g.detach()
};
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,i,this);
this.doAfterGuestLogin(SQUARESPACE_LOGIN,h,this);
var g=SQUARESPACE_LOGIN.once("cancel",j,this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Post Reply","Post Reply",this.settings.allowAnon)
}}}},this)
},extendComments:function(){this.currentPage=this.currentPage+1;
var b=this.lastSortTime,c=this.lastHashChangeTime;
this.retrieveComments({order:this.sortOrder,onSuccess:function(){if(b===this.lastSortTime&&c===this.lastHashChangeTime){this.attachComments.call(this)
}},page:this.currentPage},this)
},attachComments:function(){var d=this.commentData.formatted;
d.comments=this.commentData.getFormattedPage(this.currentPage);
var b=this.renderToFragment(d);
this.updateCommentCounts();
var c=a.one(".comment-list");
b.all(".comment, .reply-area-wrapper").each(function(e){c.append(e)
});
this.containerEl.one(".load-more").remove(true);
this.addLoadMoreControls()
},sort:function(d){var c=this.sortOrderLookup[d];
a.Cookie.set("commentSortOrder",d);
this.sortOrder=d;
this.currentPage=1;
var b=function(e){this.lastSortTime=new Date();
this.fullDataRender(e);
var f=a.one(".comment-sort");
f.one("span").set("innerHTML",c);
f.one("select").set("value",this.sortOrder)
};
this.onLoading();
this.retrieveComments({order:this.sortOrder,onSuccess:b,page:this.currentPage})
},formatData:function(h,e,d){var c,k={comments:[]},g,b;
e=(e||{});
d=(d||{});
var j=(this.squarespaceAdminOnly()||this.settings.readOnly);
k.noAvatars=this.settings.avatarsHidden;
k.likesAllowed=this.settings.likesAllowed;
k.newCommentAreaTop={authenticatedAccount:SQUARESPACE_LOGIN.account,readOnly:j};
k.commentSortTitle=this.sortOrderLookup[this.sortOrder];
k.sortOldestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.OLDEST_FIRST;
k.sortNewestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.NEWEST_FIRST;
k.sortMostLiked=this.sortOrder===a.Squarespace.CommentSortTypes.MOST_LIKED;
k.sortLeastLiked=this.sortOrder===a.Squarespace.CommentSortTypes.LEAST_LIKED;
k.totalComments=this.commentData.totalComments;
k.visibleComments=this.commentData.visibleComments;
k.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;
for(var f=0;
f<h.length;
f++){g=h[f];
g.unmoderated=(g.status===a.Squarespace.CommentStatuses.AWAITING_MODERATION);
g.moderationMode=this.moderationMode;
g.readOnly=j;
g.flagsAllowed=this.settings.flagsAllowed;
if(g.memberAccount){g.authorName=g.memberAccount.displayName;
g.authorUrl=g.memberAccount.websiteUrl
}if(g.authorUrl){if(!(g.authorUrl.startsWith("http://")||g.authorUrl.startsWith("https://"))){g.authorUrl="http://"+g.authorUrl
}}c=g.id;
if(this.settings.likesAllowed){g.likesAllowed={likeCount:g.likeCount};
if(e[c]){g.likesAllowed.liked=true
}}if(d[c]){g.flagged=true
}g.threaded=this.settings.threaded;
k.comments.push(g)
}return k
},scatterData:function(c){var d=(this.squarespaceAdminOnly()||this.settings.readOnly);
c.noAvatars=this.settings.avatarsHidden;
c.likesAllowed=this.settings.likesAllowed;
c.newCommentAreaTop={};
c.newCommentAreaTop.readOnly=d;
c.newCommentAreaTop.authenticatedAccount=SQUARESPACE_LOGIN.account;
c.commentSortTitle=this.sortOrderLookup[this.sortOrder];
c.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;
if(this.commentData.totalComments===0){c.noComments=true
}var e={};
for(var b=0;
b<c.comments.length;
b++){e=c.comments[b];
e.flagsAllowed=this.settings.flagsAllowed;
e.moderationMode=this.moderationMode;
if(e.memberAccount){e.authorName=e.memberAccount.displayName;
e.authorUrl=e.memberAccount.websiteUrl
}if(e.authorUrl){if(!(e.authorUrl.startsWith("http://")||e.authorUrl.startsWith("https://"))){e.authorUrl="http://"+e.authorUrl
}}e.readOnly=d;
if(this.settings.likesAllowed){if(!e.likesAllowed){e.likesAllowed={likeCount:0}
}e.likesAllowed.likeCount=(e.likesAllowed.likeCount===0?undefined:e.likesAllowed.likeCount)
}e.threaded=this.settings.threaded;
if(c.likeMap&&c.likeMap[e.id]&&(e.likesAllowed!==undefined)){e.likesAllowed.liked=true
}if(c.flagMap&&c.flagMap[e.id]){e.flagged=true
}c.comments[b]=e
}return c
},render:function(d){var c=this.renderToFragment(d),f=this.commentsEl,e,b=a.one(".comment-event-capture");
if(!d.comments.length){this.containerEl.addClass("empty")
}else{this.containerEl.removeClass("empty")
}f.empty();
f.append(c);
e=new a.Anim({node:f,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}});
e.on("end",function(){b.remove(true)
});
e.run();
this.addFullViewControls();
switch(this.params.paginationMode){case this.PaginationModes.PAGE:break;
case this.PaginationModes.EXTEND:this.addLoadMoreControls();
break;
default:break
}this.fire("render")
},renderToFragment:function(e){for(var d=0;
d<e.comments.length;
d++){this.escapeComment(e.comments[d]);
var b=e.comments[d].body;
b=a.Squarespace.Utils.preFormatMarkdown(b);
e.comments[d].body=b
}var c=a.Node.create(this._template.expand(e)),f=c.all(".comment");
f.each(function(h,g){h.setAttribute("data-commentId",e.comments[g].id)
});
return c
}});
a.augment(a.Squarespace.Comments,a.EventTarget);
a.on("domready",function(){var f=a.one(".squarespace-comments"),g,c,d=Static.SQUARESPACE_CONTEXT.websiteSettings;
if(f&&!d.disqusShortname){g=(Static.SQUARESPACE_CONTEXT.itemId||Static.SQUARESPACE_CONTEXT.collectionId);
if(g){c=(Static.SQUARESPACE_CONTEXT.itemId?a.Squarespace.CommentTargetTypes.ITEM:a.Squarespace.CommentTargetTypes.COLLECTION);
var e=false,i=false;
if(c===a.Squarespace.CommentTargetTypes.ITEM){var j=Static.SQUARESPACE_CONTEXT.item;
if(j){if(j.commentState===a.Squarespace.CommentStates.DISABLED){if(j.publicCommentCount===0){e=true
}else{i=true
}}}}else{}if(!e){var h=function(){a.use("squarespace-comments","cookie",function(k){if(Static.SQUARESPACE_CONTEXT.authenticatedAccount&&!Static.SQUARESPACE_CONTEXT.website.cloneable){k.use("squarespace-management",function(l){l.Squarespace.Management.showChrome()
})
}(new k.Squarespace.Comments({containerEl:f,identifier:g,type:c,likesAllowed:d.commentLikesAllowed,flagsAllowed:d.commentFlagsAllowed,threaded:d.commentThreaded,approvalRequired:d.commentApprovalRequired,allowAnon:d.commentAnonAllowed,avatarsOn:d.commentAvatarsOn,readOnly:i,sortType:(k.Cookie.get("commentSortOrder")||d.commentSortType)})).create()
})
};
var b=function(){a.use("squarespace-comments","cookie",function(l){var k=function(){l.Data.get({url:"/api/auth/CheckAuthentication",secure:true,success:function(m){if(m.member!==null){l.use("squarespace-management",function(n){Static.SQUARESPACE_CONTEXT.authenticatedAccount=m.member;
SQUARESPACE_LOGIN.params=n.merge(SQUARESPACE_LOGIN.params,{redirectAfterCancel:false,redirectAfterLogin:false});
SQUARESPACE_LOGIN.onLoginComplete(m.member)
})
}h()
},failure:h})
};
if(l.Data.TRANSPORT_READY){k()
}else{console.warn("Flash cross-domain transport not initialized yet. Delaying comment initialization until flash is ready.");
l.once("io:xdrReady",k)
}})
};
if(Static.SQUARESPACE_CONTEXT.authenticatedAccount||Static.SQUARESPACE_CONTEXT.website.cloneable){h()
}else{b()
}}}}})
},"1.0",{requires:["history","squarespace-comment-data","squarespace-util","squarespace-markdown","squarespace-login","squarespace-ui-base","node","event","selector-css3","squarespace-json-template","anim","transition"]});